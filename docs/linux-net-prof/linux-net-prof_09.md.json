["```\n$ sudo apt-get install \u2013y bind9\n```", "```\ninclude \"/etc/bind/named.conf.options\";\ninclude \"/etc/bind/named.conf.local\";\ninclude \"/etc/bind/named.conf.default-zones\";\n```", "```\noptions {\n\u00a0\u00a0directory \"/var/cache/bind\";\n\u00a0\u00a0listen-on port 53 { localhost; };\n\u00a0\u00a0allow-query { localhost; 192.168.0.0/16; 10.0.0.0/8; 172.16.0.0/12; };\n\u00a0\u00a0forwarders { 8.8.8.8; 8.8.4.4; 1.1.1.1; };\n\u00a0\u00a0recursion yes;\n}\n```", "```\nzone \"coherentsecurity.com\" IN {\n\u00a0\u00a0type master;\n\u00a0\u00a0file \"coherentsecurity.com.zone\";\n\u00a0\u00a0allow-update { 192.168.0.0/16; 10.0.0.0/8;172.16.0.0/12 };\n};\n```", "```\nacl dhcp-clients { 192.168.122.128/25; };\nacl static-clients { 192.168.122.64/26; };\nzone \"coherentsecurity.com\" {\n\u00a0\u00a0\u00a0\u00a0allow-update { dhcp-clients; static-clients; };\n};\n```", "```\n$ named-checkconf\n$ named-checkzone coherentsecurity.com /var/cache/bind/coherentsecurity.com.zone\nzone coherentsecurity.com/IN: loaded serial 2021022401\nOK\n```", "```\nsudo systemctl enable bind9\nsudo systemctl start bind9\n```", "```\n$ dig @127.0.0.1 +short ns01.coherentsecurity.com A\n192.168.122.157\n$ dig @127.0.0.1 +short esx01.coherentsecurity.com A\n192.168.122.51\n```", "```\n$ dig @127.0.0.1 +short isc.sans.edu\n45.60.31.34\n45.60.103.34\n```", "```\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0rate-limit {\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0responses-per-second 10\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0log-only yes;\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0}\n    ```", "```\n    \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0recursion no;\n    ```", "```\n    allow-query { localhost; 0.0.0.0/0 }\n    ```", "```\nDig <request value you are making> <the request type you are making>\u00a0\u00a0+<additional request types>\n```", "```\n$ dig sans.org ns\n; <<>> DiG 9.16.1-Ubuntu <<>> sans.org ns\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 27639\n;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 65494\n;; QUESTION SECTION:\n;sans.org.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0NS\n;; ANSWER SECTION:\nsans.org.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a086400\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0NS\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ns-1270.awsdns-30.org.\nsans.org.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a086400\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0NS\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ns-1746.awsdns-26.co.uk.\nsans.org.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a086400\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0NS\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ns-282.awsdns-35.com.\nsans.org.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a086400\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0NS\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ns-749.awsdns-29.net.\n;; Query time: 360 msec\n;; SERVER: 127.0.0.53#53(127.0.0.53)\n;; WHEN: Fri Feb 12 12:02:26 PST 2021\n;; MSG SIZE\u00a0\u00a0rcvd: 174\n```", "```\n$ dig sans.org ns +short\nns-749.awsdns-29.net.\nns-282.awsdns-35.com.\nns-1746.awsdns-26.co.uk.\nns-1270.awsdns-30.org.\n```", "```\n$ dig sans.org mx +short\n0 sans-org.mail.protection.outlook.com.\n```", "```\n$ curl -s -H 'accept: application/dns-json' 'https://1.1.1.1/dns-query?name=www.coherentsecurity.com&type=A'\n{\"Status\":0,\"TC\":false,\"RD\":true,\"RA\":true,\"AD\":false,\"CD\":false,\"Question\":[{\"name\":\"www.coherentsecurity.com\",\"type\":1}],\"Answer\":[{\"name\":\"www.coherentsecurity.com\",\"type\":5,\"TTL\":1693,\"data\":\"robvandenbrink.github.io.\"},{\"name\":\"robvandenbrink.github.io\",\"type\":1,\"TTL\":3493,\"data\":\"185.199.108.153\"},{\"name\":\"robvandenbrink.github.io\",\"type\":1,\"TTL\":3493,\"data\":\"185.199.109.153\"},\n{\"name\":\"robvandenbrink.github.io\",\"type\":1,\"TTL\":3493,\"data\":\"185.199.110.153\"},{\"name\":\"robvandenbrink.github.io\",\"type\":1,\"TTL\":3493,\"data\":\"185.199.111.153\"}]}\n```", "```\nhttps://<the dns server ip>/dns-query?name=<the dns query target>&type=<the dns request type>\u00a0\u00a0\n```", "```\ncurl -s -H 'accept: application/dns-json' 'https://1.1.1.1/dns-query?name=www.coherentsecurity.com&type=A' | jq\n{\n\u00a0\u00a0\"Status\": 0,\n\u00a0\u00a0\"TC\": false,\n\u00a0\u00a0\"RD\": true,\n\u00a0\u00a0\"RA\": true,\n\u00a0\u00a0\"AD\": false,\n\u00a0\u00a0\"CD\": false,\n\u00a0\u00a0\"Question\": [\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"name\": \"www.coherentsecurity.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"type\": 1\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0],\n\u00a0\u00a0\"Answer\": [\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"name\": \"www.coherentsecurity.com\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"type\": 5,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"TTL\": 1792,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"data\": \"robvandenbrink.github.io.\"\n\u00a0\u00a0\u00a0\u00a0},\n\u00a0\u00a0\u00a0\u00a0\u2026.\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0{\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"name\": \"robvandenbrink.github.io\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"type\": 1,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"TTL\": 3592,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"data\": \"185.199.111.153\"\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0]\n}\n```", "```\nnmap -p443 1.1.1.1 --script ssl-cert.nse\nStarting Nmap 7.80 ( https://nmap.org ) at 2021-02-25 11:28 Eastern Standard Time\nNmap scan report for one.one.one.one (1.1.1.1)\nHost is up (0.029s latency).\nPORT\u00a0\u00a0\u00a0\u00a0STATE SERVICE\n443/tcp open\u00a0\u00a0https\n| ssl-cert: Subject: commonName=cloudflare-dns.com/organizationName=Cloudflare, Inc./stateOrProvinceName=California/countryName=US\n| Subject Alternative Name: DNS:cloudflare-dns.com, DNS:*.cloudflare-dns.com, DNS:one.one.one.one, IP Address:1.1.1.1, IP Address:1.0.0.1, IP Address:162.159.36.1, IP Address:162.159.46.1, IP Address:2606:4700:4700:0:0:0:0:1111, IP Address:2606:4700:4700:0:0:0:0:1001, IP Address:2606:4700:4700:0:0:0:0:64, IP Address:2606:4700:4700:0:0:0:0:6400\n| Issuer: commonName=DigiCert TLS Hybrid ECC SHA384 2020 CA1/organizationName=DigiCert Inc/countryName=US\n| Public Key type: unknown\n| Public Key bits: 256\n| Signature Algorithm: ecdsa-with-SHA384\n| Not valid before: 2021-01-11T00:00:00\n| Not valid after:\u00a0\u00a02022-01-18T23:59:59\n| MD5:\u00a0\u00a0\u00a0fef6 c18c 02d0 1a14 ab75 1275 dd6a bc29\n|_SHA-1: f1b3 8143 b992 6454 97cf 452f 8c1a c842 4979 4282\nNmap done: 1 IP address (1 host up) scanned in 7.41 seconds\n```", "```\n$ nmap -p 853 8.8.8.8\nStarting Nmap 7.80 ( https://nmap.org ) at 2021-02-21 13:33 PST\nNmap scan report for dns.google (8.8.8.8)\nHost is up (0.023s latency).\nPORT\u00a0\u00a0\u00a0\u00a0STATE SERVICE\n853/tcp open\u00a0\u00a0domain-s\nDoing a version scan gives us more good information, but the fingerprint (at the time of this book being published) is not in nmape:\n$ nmap -p 853 -sV\u00a0\u00a08.8.8.8\nStarting Nmap 7.80 ( https://nmap.org ) at 2021-02-21 13:33 PST\nNmap scan report for dns.google (8.8.8.8)\nHost is up (0.020s latency).\nPORT\u00a0\u00a0\u00a0\u00a0STATE SERVICE\u00a0\u00a0\u00a0\u00a0VERSION\n853/tcp open\u00a0\u00a0ssl/domain (generic dns response: NOTIMP)\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\nSF-Port853-TCP:V=7.80%T=SSL%I=7%D=2/21%Time=6032D1B5%P=x86_64-pc-linux-gnu\nSF:%r(DNSVersionBindReqTCP,20,\"\\0\\x1e\\0\\x06\\x81\\x82\\0\\x01\\0\\0\\0\\0\\0\\0\\x07v\nSF:ersion\\x04bind\\0\\0\\x10\\0\\x03\")%r(DNSStatusRequestTCP,E,\"\\0\\x0c\\0\\0\\x90\\\nSF:x04\\0\\0\\0\\0\\0\\0\\0\\0\");\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 22.66 seconds\n```", "```\nnmap -p853 --script ssl-cert 8.8.8.8\nStarting Nmap 7.80 ( https://nmap.org ) at 2021-02-21 16:35 Eastern Standard Time\nNmap scan report for dns.google (8.8.8.8)\nHost is up (0.017s latency).\nPORT\u00a0\u00a0\u00a0\u00a0STATE SERVICE\n853/tcp open\u00a0\u00a0domain-s\n| ssl-cert: Subject: commonName=dns.google/organizationName=Google LLC/stateOrProvinceName=California/countryName=US\n| Subject Alternative Name: DNS:dns.google, DNS:*.dns.google.\ncom, DNS:8888.google, DNS:dns.google.com, DNS:dns64.dns.google, IP Address:2001:4860:4860:0:0:0:0:64, IP Address:2001:4860:4860:0:0:0:0:6464, IP Address:2001:4860:4860:0:0:0:0:8844, IP Address:2001:4860:4860:0:0:0:0:8888, IP Address:8.8.4.4, IP Address:8.8.8.8\n| Issuer: commonName=GTS CA 1O1/organizationName=Google Trust Services/countryName=US\n| Public Key type: rsa\n| Public Key bits: 2048\n| Signature Algorithm: sha256WithRSAEncryption\n| Not valid before: 2021-01-26T08:54:07\n| Not valid after:\u00a0\u00a02021-04-20T08:54:06\n| MD5:\u00a0\u00a0\u00a09edd 82e5 5661 89c0 13a5 cced e040 c76d\n|_SHA-1: 2e80 c54b 0c55 f8ad 3d61 f9ae af43 e70c 1e67 fafd\nNmap done: 1 IP address (1 host up) scanned in 7.68 seconds\n```", "```\nsudo apt-get install\u00a0\u00a0knot-dnsutils\n```", "```\nkdig -d +short @8.8.8.8 www.cisco.com A\u00a0\u00a0+tls-ca +tls-hostname=dns.google # +tls-sni=dns.google\n;; DEBUG: Querying for owner(www.cisco.com.), class(1), type(1), server(8.8.8.8), port(853), protocol(TCP)\n;; DEBUG: TLS, imported 129 system certificates\n;; DEBUG: TLS, received certificate hierarchy:\n;; DEBUG:\u00a0\u00a0#1, C=US,ST=California,L=Mountain View,O=Google LLC,CN=dns.google\n;; DEBUG:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0SHA-256 PIN: 0r0ZP20iM96B8DOUpVSlh5sYx9GT1NBVp181TmVKQ1Q=\n;; DEBUG:\u00a0\u00a0#2, C=US,O=Google Trust Services,CN=GTS CA 1O1\n;; DEBUG:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0SHA-256 PIN: YZPgTZ+woNCCCIW3LH2CxQeLzB/1m42QcCTBSdgayjs=\n;; DEBUG: TLS, skipping certificate PIN check\n;; DEBUG: TLS, The certificate is trusted.\nwww.cisco.com.akadns.net.\nwwwds.cisco.com.edgekey.net.\nwwwds.cisco.com.edgekey.net.globalredir.akadns.net.\ne2867.dsca.akamaiedge.net.\n23.66.161.25\n```", "```\nkdig\u00a0\u00a0+short @8.8.8.8 www.cisco.com A\u00a0\u00a0+tls-ca +tls-hostname=dns.google +tls-sni=dns.google\nwww.cisco.com.akadns.net.\nwwwds.cisco.com.edgekey.net.\nwwwds.cisco.com.edgekey.net.globalredir.akadns.net.\ne2867.dsca.akamaiedge.net.\n23.66.161.25\n```", "```\nkdig @8.8.8.8 www.cisco.com A\u00a0\u00a0+tls-ca +tls-hostname=dns.google +tls-sni=dns.google\n;; TLS session (TLS1.3)-(ECDHE-X25519)-(RSA-PSS-RSAE-SHA256)-(AES-256-GCM)\n;; ->>HEADER<<- opcode: QUERY; status: NOERROR; id: 57771\n;; Flags: qr rd ra; QUERY: 1; ANSWER: 5; AUTHORITY: 0; ADDITIONAL: 1\n;; EDNS PSEUDOSECTION:\n;; Version: 0; flags: ; UDP size: 512 B; ext-rcode: NOERROR\n;; PADDING: 240 B\n;; QUESTION SECTION:\n;; www.cisco.com.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0A\n;; ANSWER SECTION:\nwww.cisco.com.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a03571\u00a0\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0CNAME\u00a0\u00a0\u00a0www.cisco.com.akadns.net.\nwww.cisco.com.akadns.net.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0120\u00a0\u00a0\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0CNAME\u00a0\u00a0\u00a0wwwds.cisco.com.edgekey.net.\nwwwds.cisco.com.edgekey.net.\u00a0\u00a0\u00a0\u00a013980\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0CNAME\u00a0\u00a0\u00a0wwwds.cisco.com.edgekey.net.globalredir.akadns.net.\nwwwds.cisco.com.edgekey.net.globalredir.akadns.net. 2490\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0CNAME\u00a0\u00a0e2867.dsca.akamaiedge.net.\ne2867.dsca.akamaiedge.net.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a019\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0IN\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0A\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a023.66.161.25\n;; Received 468 B\n;; Time 2021-02-21 13:50:33 PST\n;; From 8.8.8.8@853(TCP) in 121.4 ms\n```", "```\n$ kdig +short @8.8.8.8 www.cisco.com A\nwww.cisco.com.akadns.net.\nwwwds.cisco.com.edgekey.net.\nwwwds.cisco.com.edgekey.net.globalredir.akadns.net.\ne2867.dsca.akamaiedge.net.\n23.4.0.216\n```", "```\n$ dig DNSKEY @dns.google example.com +short\n256 3 8 AwEAAa79LdJaZfIxVzyjq4H7yB4VqT/rIreB+N0jija+4bWHzNrwhSiu D/SOtgvX+gXEgwAR6tHGn9q9t65o85RfdHJrueORb0usa3x6LHM7qy6A r22P78UUn/rxa9jbi6yS4cVOzLnJ+OKO0w1Scly5XLDmmWPbIM2LvayR 2U4UAqZZ\n257 3 8 AwEAAZ0aqu1rJ6orJynrRfNpPmayJZoAx9Ic2/Rl9VQWLMHyjxxem3VU SoNUIFXERQbj0A9Ogp0zDM9YIccKLRd6LmWiDCt7UJQxVdD+heb5Ec4q lqGmyX9MDabkvX2NvMwsUecbYBq8oXeTT9LRmCUt9KUt/WOi6DKECxoG /bWTykrXyBR8elD+SQY43OAVjlWrVltHxgp4/rhBCvRbmdflunaPIgu2 7eE2U4myDSLT8a4A0rB5uHG4PkOa9dIRs9y00M2mWf4lyPee7vi5few2 dbayHXmieGcaAHrx76NGAABeY393xjlmDNcUkF1gpNWUla4fWZbbaYQz A93mLdrng+M=\n257 3 8 AwEAAbOFAxl+Lkt0UMglZizKEC1AxUu8zlj65KYatR5wBWMrh18TYzK/ ig6Y1t5YTWCO68bynorpNu9fqNFALX7bVl9/gybA0v0EhF+dgXmoUfRX 7ksMGgBvtfa2/Y9a3klXNLqkTszIQ4PEMVCjtryl19Be9/PkFeC9ITjg MRQsQhmB39eyMYnal+f3bUxKk4fq7cuEU0dbRpue4H/N6jPucXWOwiMA kTJhghqgy+o9FfIp+tR/emKao94/wpVXDcPf5B18j7xz2SvTTxiuqCzC MtsxnikZHcoh1j4g+Y1B8zIMIvrEM+pZGhh/Yuf4RwCBgaYCi9hpiMWV vS4WBzx0/lU=\n```", "```\n$ dig +short DS @dns.google example.com\n31589 8 1 3490A6806D47F17A34C29E2CE80E8A999FFBE4BE\n31589 8 2 CDE0D742D6998AA554A92D890F8184C698CFAC8A26FA59875A990C03 \nE576343C\n43547 8 1 B6225AB2CC613E0DCA7962BDC2342EA4F1B56083\n43547 8 2 615A64233543F66F44D68933625B17497C89A70E858ED76A2145997E DF96A918\n31406 8 1 189968811E6EBA862DD6C209F75623D8D9ED9142\n31406 8 2 F78CF3344F72137235098ECBBD08947C2C9001C7F6A085A17F518B5D 8F6B916D\n```", "```\ndig -d DNSKEY @dns.google example.com\u00a0\u00a0| grep DEBUG\n;; DEBUG: Querying for owner(example.com.), class(1), type(48), server(dns.google), port(53), protocol(UDP)\n```", "```\n$ dig +dnssec +short @dns.google www.example.com A\n93.184.216.34\nA 8 3 86400 20210316085034 20210223165712 45150 example.com. UyyNiGG0WDAsberOUza21vYos8vDc6aLq8FV9lvJT4YRBn6V8CTd3cdo ljXV5uETcD54tuv1kLZWg7YZxSQDGFeNC3luZFkbrWAqPbHXy4D7Tdey LBK0R3xywGxgZIEfp9HMjpZpikFQuKC/iFvd14uJhoquMqFPFvTfJB/s XJ8=\n```"]