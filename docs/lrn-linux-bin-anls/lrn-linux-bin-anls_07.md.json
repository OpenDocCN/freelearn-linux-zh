["```\n$ cat /proc/`pidof hello_world`/maps\n00400000-00401000 r-xp 00000000 00:1b 8126525    /home/ryan/hello_world\n00600000-00601000 r--p 00000000 00:1b 8126525    /home/ryan/hello_world\n00601000-00602000 rw-p 00001000 00:1b 8126525    /home/ryan/hello_world\n0174e000-0176f000 rw-p 00000000 00:00 0          [heap]\n7fed9c5a7000-7fed9c762000 r-xp 00000000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c762000-7fed9c961000 ---p 001bb000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c961000-7fed9c965000 r--p 001ba000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c965000-7fed9c967000 rw-p 001be000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c967000-7fed9c96c000 rw-p 00000000 00:00 0\n7fed9c96c000-7fed9c98f000 r-xp 00000000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fed9cb62000-7fed9cb65000 rw-p 00000000 00:00 0\n7fed9cb8c000-7fed9cb8e000 rw-p 00000000 00:00 0\n7fed9cb8e000-7fed9cb8f000 r--p 00022000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fed9cb8f000-7fed9cb90000 rw-p 00023000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fed9cb90000-7fed9cb91000 rw-p 00000000 00:00 0\n7fff0975f000-7fff09780000 rw-p 00000000 00:00 0          [stack]\n7fff097b2000-7fff097b4000 r-xp 00000000 00:00 0          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0  [vsyscall]\n```", "```\n00400000-00401000 r-xp 00000000 00:1b 8126525  /home/ryan/hello_world\n00600000-00601000 r--p 00000000 00:1b 8126525  /home/ryan/hello_world\n00601000-00602000 rw-p 00001000 00:1b 8126525  /home/ryan/hello_world\n```", "```\n0174e000-0176f000 rw-p 00000000 00:00 0          [heap]\n```", "```\n7fed9c5a7000-7fed9c762000 r-xp 00000000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c762000-7fed9c961000 ---p 001bb000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c961000-7fed9c965000 r--p 001ba000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n7fed9c965000-7fed9c967000 rw-p 001be000 08:01 11406096   /lib/x86_64-linux-gnu/libc-2.19.so\n```", "```\n7fed9c96c000-7fed9c98f000 r-xp 00000000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fed9cb62000-7fed9cb65000 rw-p 00000000 00:00 0\n7fed9cb8c000-7fed9cb8e000 rw-p 00000000 00:00 0\n7fed9cb8e000-7fed9cb8f000 r--p 00022000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fed9cb8f000-7fed9cb90000 rw-p 00023000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fed9cb90000-7fed9cb91000 rw-p 00000000 00:00 0\n```", "```\n7fff0975f000-7fff09780000 rw-p 00000000 00:00 0          [stack]\n7fff097b2000-7fff097b4000 r-xp 00000000 00:00 0          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0  [vsyscall]\n```", "```\n$ cat /proc/`pidof host`/maps\n00400000-00401000 r-xp 00000000 00:24 5553671       /home/user/git/azazel/host\n00600000-00601000 r--p 00000000 00:24 5553671       /home/user/git/azazel/host\n00601000-00602000 rw-p 00001000 00:24 5553671       /home/user/git/azazel/host\n0066c000-0068d000 rw-p 00000000 00:00 0              [heap]\n3001000000-3001019000 r-xp 00000000 08:01 11406078  /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n3001019000-3001218000 ---p 00019000 08:01 11406078  /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n3001218000-3001219000 r--p 00018000 08:01 11406078  /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n3001219000-300121a000 rw-p 00019000 08:01 11406078  /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n300121a000-3001224000 rw-p 00000000 00:00 0\n3003400000-300340d000 r-xp 00000000 08:01 11406085    /lib/x86_64-linux-gnu/libpam.so.0.83.1\n300340d000-300360c000 ---p 0000d000 08:01 11406085    /lib/x86_64-linux-gnu/libpam.so.0.83.1\n300360c000-300360d000 r--p 0000c000 08:01 11406085    /lib/x86_64-linux-gnu/libpam.so.0.83.1\n300360d000-300360e000 rw-p 0000d000 08:01 11406085    /lib/x86_64-linux-gnu/libpam.so.0.83.1\n7fc30ac7f000-7fc30ac81000 r-xp 00000000 08:01 11406070 /lib/x86_64-linux-gnu/libutil-2.19.so\n7fc30ac81000-7fc30ae80000 ---p 00002000 08:01 11406070 /lib/x86_64-linux-gnu/libutil-2.19.so\n7fc30ae80000-7fc30ae81000 r--p 00001000 08:01 11406070 /lib/x86_64-linux-gnu/libutil-2.19.so\n7fc30ae81000-7fc30ae82000 rw-p 00002000 08:01 11406070 /lib/x86_64-linux-gnu/libutil-2.19.so\n7fc30ae82000-7fc30ae85000 r-xp 00000000 08:01 11406068 /lib/x86_64-linux-gnu/libdl-2.19.so\n7fc30ae85000-7fc30b084000 ---p 00003000 08:01 11406068 /lib/x86_64-linux-gnu/libdl-2.19.so\n7fc30b084000-7fc30b085000 r--p 00002000 08:01 11406068 /lib/x86_64-linux-gnu/libdl-2.19.so\n7fc30b085000-7fc30b086000 rw-p 00003000 08:01 11406068 /lib/x86_64-linux-gnu/libdl-2.19.so\n7fc30b086000-7fc30b241000 r-xp 00000000 08:01 11406096 /lib/x86_64-linux-gnu/libc-2.19.so\n7fc30b241000-7fc30b440000 ---p 001bb000 08:01 11406096 /lib/x86_64-linux-gnu/libc-2.19.so\n7fc30b440000-7fc30b444000 r--p 001ba000 08:01 11406096 /lib/x86_64-linux-gnu/libc-2.19.so\n7fc30b444000-7fc30b446000 rw-p 001be000 08:01 11406096 /lib/x86_64-linux-gnu/libc-2.19.so\n7fc30b446000-7fc30b44b000 rw-p 00000000 00:00 0\n7fc30b44b000-7fc30b453000 r-xp 00000000 00:24 5553672   /home/user/git/azazel/libselinux.so\n7fc30b453000-7fc30b652000 ---p 00008000 00:24 5553672   /home/user/git/azazel/libselinux.so\n7fc30b652000-7fc30b653000 r--p 00007000 00:24 5553672   /home/user/git/azazel/libselinux.so\n7fc30b653000-7fc30b654000 rw-p 00008000 00:24 5553672   /home/user/git/azazel/libselinux.so\n7fc30b654000-7fc30b677000 r-xp 00000000 08:01 11406093    /lib/x86_64-linux-gnu/ld-2.19.so\n7fc30b847000-7fc30b84c000 rw-p 00000000 00:00 0\n7fc30b873000-7fc30b876000 rw-p 00000000 00:00 0\n7fc30b876000-7fc30b877000 r--p 00022000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fc30b877000-7fc30b878000 rw-p 00023000 08:01 11406093   /lib/x86_64-linux-gnu/ld-2.19.so\n7fc30b878000-7fc30b879000 rw-p 00000000 00:00 0\n7fff82fae000-7fff82fcf000 rw-p 00000000 00:00 0          [stack]\n7fff82ffb000-7fff82ffd000 r-xp 00000000 00:00 0          [vdso]\nffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0  [vsyscall]\n```", "```\nSTACK_TOP           STACK_BOTTOM\n7fff82fae000   -    7fff82fcf000\n```", "```\n$ gdb -q attach `pidof host`\n$ x/4096s (0x7fff82fcf000 \u2013 4096)\n\n\u2026 scroll down a few pages \u2026\n\n0x7fff82fce359:  \"./host\"\n0x7fff82fce360:  \"LD_PRELOAD=./libselinux.so\"\n0x7fff82fce37b:  \"XDG_VTNR=7\"\n---Type <return> to continue, or q <return> to quit---\n0x7fff82fce386:  \"XDG_SESSION_ID=c2\"\n0x7fff82fce398:  \"CLUTTER_IM_MODULE=xim\"\n0x7fff82fce3ae:  \"SELINUX_INIT=YES\"\n0x7fff82fce3bf:  \"SESSION=ubuntu\"\n0x7fff82fce3ce:  \"GPG_AGENT_INFO=/run/user/1000/keyring-jIVrX2/gpg:0:1\"\n0x7fff82fce403:  \"TERM=xterm\"\n0x7fff82fce40e:  \"SHELL=/bin/bash\"\n\n\u2026 truncated \u2026\n```", "```\n$ readelf -r host\nRelocation section '.rela.plt' at offset 0x418 contains 7 entries:\n000000601018  000100000007 R_X86_64_JUMP_SLO 0000000000000000 unlink + 0\n000000601020  000200000007 R_X86_64_JUMP_SLO 0000000000000000 puts + 0\n000000601028  000300000007 R_X86_64_JUMP_SLO 0000000000000000 opendir + 0\n000000601030  000400000007 R_X86_64_JUMP_SLO 0000000000000000 __libc_start_main+0\n000000601038  000500000007 R_X86_64_JUMP_SLO 0000000000000000 __gmon_start__+0\n000000601040  000600000007 R_X86_64_JUMP_SLO 0000000000000000 pause + 0\n000000601048  000700000007 R_X86_64_JUMP_SLO 0000000000000000 fopen + 0\n```", "```\n(gdb) x/gx 0x601048\n0x601048 <fopen@got.plt>:  0x00007fc30b44e609\n(gdb) x/gx 0x601018\n0x601018 <unlink@got.plt>:  0x00007fc30b44ec81\n(gdb) x/gx 0x601028\n0x601028 <opendir@got.plt>:  0x00007fc30b44ed77\n```", "```\n7fc30b44b000-7fc30b453000 r-xp  /home/user/git/azazel/libselinux.so\n\n```", "```\n$ readelf -s /lib/x86_64-linux-gnu/libc.so.6 | grep dlopen\n  2128: 0000000000136160   146 FUNC    GLOBAL DEFAULT   12 __libc_dlopen_mode@@GLIBC_PRIVATE\n```", "```\n#define __RTLD_DLOPEN 0x80000000 //glibc internal dlopen flag emulates dlopen behaviour\n__PAYLOAD_KEYWORDS__ void * dlopen_load_exec(const char *path, void *dlopen_addr)\n{\n        void * (*libc_dlopen_mode)(const char *, int) = dlopen_addr;\n        void *handle = (void *)0xfff; //initialized for debugging\n        handle = libc_dlopen_mode(path, __RTLD_DLOPEN|RTLD_NOW|RTLD_GLOBAL);\n        __RETURN_VALUE__(handle);\n        __BREAKPOINT__;\n}\n```", "```\nElf64_Addr get_sym_from_libc(handle_t *h, const char *name)\n{\n        int fd, i;\n        struct stat st;\n        Elf64_Addr libc_base_addr = get_libc_addr(h->tasks.pid);\n        Elf64_Addr symaddr;\n\n        if ((fd = open(globals.libc_path, O_RDONLY)) < 0) {\n                perror(\"open libc\");\n                exit(-1);\n        }\n\n        if (fstat(fd, &st) < 0) {\n                perror(\"fstat libc\");\n                exit(-1);\n        }\n\n        uint8_t *libcp = mmap(NULL, st.st_size, PROT_READ, MAP_PRIVATE, fd, 0);\n        if (libcp == MAP_FAILED) {\n                perror(\"mmap libc\");\n                exit(-1);\n        }\n\n        symaddr = resolve_symbol((char *)name, libcp);\n        if (symaddr == 0) {\n                printf(\"[!] resolve_symbol failed for symbol '%s'\\n\", name);\n                printf(\"Try using --manual-elf-loading option\\n\");\n                exit(-1);\n        }\n        symaddr = symaddr + globals.libc_addr;\n\n        DBG_MSG(\"[DEBUG]-> get_sym_from_libc() addr of __libc_dl_*: %lx\\n\", symaddr);\n        return symaddr;\n\n}\n```", "```\n_start:\n        jmp B\nA:\n\n        # fd = open(\"libtest.so.1.0\", O_RDONLY);\n\n        xorl %ecx, %ecx\n        movb $5, %al\n        popl %ebx\n        xorl %ecx, %ecx\n        int $0x80\n\n        subl $24, %esp\n\n        # mmap(0, 8192, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_SHARED, fd, 0);\n\n        xorl %edx, %edx\n        movl %edx, (%esp)\n        movl $8192,4(%esp)\n        movl $7, 8(%esp)\n        movl $2, 12(%esp)\n        movl %eax,16(%esp)\n        movl %edx, 20(%esp)\n        movl $90, %eax\n        movl %esp, %ebx\n        int $0x80\n\n        # the int3 will pass control back the tracer\n        int3\nB:\n        call A\n        .string \"/lib/libtest.so.1.0\"\n```", "```\nfffe420 <__kernel_vsyscall>:\nffffe420:       51                      push   %ecx\nffffe421:       52                      push   %edx\nffffe422:       55                      push   %ebp\nffffe423:       89 e5                   mov    %esp,%ebp\nffffe425:       0f 34                   sysenter\n```", "```\nffffffffff700db8:       b0 60                   mov    $0x60,%al\nffffffffff700dba:       0f 05                   syscall\n```", "```\n    void *handle = dlopen(\"somelib.so\", RTLD_NOW);\n    ```", "```\n$ LD_PRELOAD=./libselinux.so ./host &\n[1] 9325\n$ kill -ABRT `pidof host`\n[1]+  Segmentation fault      (core dumped) LD_PRELOAD=./libselinux.so ./host\n```", "```\n$ eu-readelf -n core\n\nNote segment of 4200 bytes at offset 0x900:\n  Owner          Data size  Type\n  CORE                 336  PRSTATUS\n    info.si_signo: 11, info.si_code: 0, info.si_errno: 0, cursig: 11\n    sigpend: <>\n    sighold: <>\n    pid: 9875, ppid: 7669, pgrp: 9875, sid: 5781\n    utime: 5.292000, stime: 0.004000, cutime: 0.000000, cstime: 0.000000\n    orig_rax: -1, fpvalid: 1\n    r15:                       0  r14:                       0\n    r13:         140736185205120  r12:                 4195616\n    rbp:      0x00007fffb25380a0  rbx:                       0\n    r11:                     582  r10:         140736185204304\n    r9:                 15699984  r8:               1886848000\n    rax:                      -1  rcx:                    -160\n    rdx:         140674792738928  rsi:              4294967295\n    rdi:                 4196093  rip:      0x000000000040064f\n    rflags:   0x0000000000000286  rsp:      0x00007fffb2538090\n    fs.base:   0x00007ff1677a1740  gs.base:   0x0000000000000000\n    cs: 0x0033  ss: 0x002b  ds: 0x0000  es: 0x0000  fs: 0x0000  gs: 0x0000\n  CORE                 136  PRPSINFO\n    state: 0, sname: R, zomb: 0, nice: 0, flag: 0x0000000000406600\n    uid: 0, gid: 0, pid: 9875, ppid: 7669, pgrp: 9875, sid: 5781\n    fname: host, psargs: ./host\n  CORE                 128  SIGINFO\n    si_signo: 11, si_errno: 0, si_code: 0\n    sender PID: 7669, sender UID: 0\n  CORE                 304  AUXV\n    SYSINFO_EHDR: 0x7fffb254a000\n    HWCAP: 0xbfebfbff  <fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe>\n    PAGESZ: 4096\n    CLKTCK: 100\n    PHDR: 0x400040\n    PHENT: 56\n    PHNUM: 9\n    BASE: 0x7ff1675ae000\n    FLAGS: 0\n    ENTRY: 0x400520\n    UID: 0\n    EUID: 0\n    GID: 0\n    EGID: 0\n    SECURE: 0\n    RANDOM: 0x7fffb2538399\n    EXECFN: 0x7fffb2538ff1\n    PLATFORM: 0x7fffb25383a9\n    NULL\n  CORE                1812  FILE\n    30 files:\n   00400000-00401000 00000000 4096        /home/user/git/azazel/host\n   00600000-00601000 00000000 4096        /home/user/git/azazel/host\n   00601000-00602000 00001000 4096        /home/user/git/azazel/host\n   3001000000-3001019000 00000000 102400  /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n   3001019000-3001218000 00019000 2093056 /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n   3001218000-3001219000 00018000 4096    /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n   3001219000-300121a000 00019000 4096    /lib/x86_64-linux-gnu/libaudit.so.1.0.0\n   3003400000-300340d000 00000000 53248   /lib/x86_64-linux-gnu/libpam.so.0.83.1\n   300340d000-300360c000 0000d000 2093056 /lib/x86_64-linux-gnu/libpam.so.0.83.1\n   300360c000-300360d000 0000c000 4096    /lib/x86_64-linux-gnu/libpam.so.0.83.1\n   300360d000-300360e000 0000d000 4096    /lib/x86_64-linux-gnu/libpam.so.0.83.1\n  7ff166bd9000-7ff166bdb000 00000000 8192    /lib/x86_64-linux-gnu/libutil-2.19.so\n  7ff166bdb000-7ff166dda000 00002000 2093056 /lib/x86_64-linux-gnu/libutil-2.19.so\n  7ff166dda000-7ff166ddb000 00001000 4096    /lib/x86_64-linux-gnu/libutil-2.19.so\n  7ff166ddb000-7ff166ddc000 00002000 4096    /lib/x86_64-linux-gnu/libutil-2.19.so\n  7ff166ddc000-7ff166ddf000 00000000 12288   /lib/x86_64-linux-gnu/libdl-2.19.so\n  7ff166ddf000-7ff166fde000 00003000 2093056 /lib/x86_64-linux-gnu/libdl-2.19.so\n  7ff166fde000-7ff166fdf000 00002000 4096    /lib/x86_64-linux-gnu/libdl-2.19.so\n  7ff166fdf000-7ff166fe0000 00003000 4096    /lib/x86_64-linux-gnu/libdl-2.19.so\n  7ff166fe0000-7ff16719b000 00000000 1814528 /lib/x86_64-linux-gnu/libc-2.19.so\n  7ff16719b000-7ff16739a000 001bb000 2093056 /lib/x86_64-linux-gnu/libc-2.19.so\n  7ff16739a000-7ff16739e000 001ba000 16384   /lib/x86_64-linux-gnu/libc-2.19.so\n  7ff16739e000-7ff1673a0000 001be000 8192    /lib/x86_64-linux-gnu/libc-2.19.so\n  7ff1673a5000-7ff1673ad000 00000000 32768   /home/user/git/azazel/libselinux.so\n  7ff1673ad000-7ff1675ac000 00008000 2093056 /home/user/git/azazel/libselinux.so\n  7ff1675ac000-7ff1675ad000 00007000 4096    /home/user/git/azazel/libselinux.so\n  7ff1675ad000-7ff1675ae000 00008000 4096    /home/user/git/azazel/libselinux.so\n  7ff1675ae000-7ff1675d1000 00000000 143360 /lib/x86_64-linux-gnu/ld-2.19.so\n  7ff1677d0000-7ff1677d1000 00022000 4096   /lib/x86_64-linux-gnu/ld-2.19.so\n  7ff1677d1000-7ff1677d2000 00023000 4096   /lib/x86_64-linux-gnu/ld-2.19.so\n```", "```\n$ readelf -S host | grep got.plt\n  [23] .got.plt          PROGBITS         0000000000601000  00001000\n$ readelf -r host\nRelocation section '.rela.plt' at offset 0x3f8 contains 6 entries:\n  Offset          Info           Type           Sym. Value    Sym. Name + Addend\n000000601018  000100000007 R_X86_64_JUMP_SLO 0000000000000000 unlink + 0\n000000601020  000200000007 R_X86_64_JUMP_SLO 0000000000000000 puts + 0\n000000601028  000300000007 R_X86_64_JUMP_SLO 0000000000000000 opendir + 0\n000000601030  000400000007 R_X86_64_JUMP_SLO 0000000000000000 __libc_start_main+0\n000000601038  000500000007 R_X86_64_JUMP_SLO 0000000000000000 __gmon_start__ + 0\n000000601040  000600000007 R_X86_64_JUMP_SLO 0000000000000000 fopen + 0\n\n```", "```\n$ gdb -q ./host core\nReading symbols from ./host...(no debugging symbols found)...done.\n[New LWP 9875]\nCore was generated by `./host'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x000000000040064f in main ()\n(gdb) x/gx 0x601040\n0x601040 <fopen@got.plt>:  0x00007ff1673a8609\n(gdb)\n```", "```\n$ readelf -n core\n<snippet>\n 0x00007ff166fe0000  0x00007ff16719b000  0x0000000000000000\n        /lib/x86_64-linux-gnu/libc-2.19.so\n</snippet>\n```", "```\n(gdb) x/4096s $rsp\n\n\u2026 scroll down a few pages \u2026\n\n0x7fffb25388db:  \"./host\"\n0x7fffb25388e2:  \"LD_PRELOAD=./libselinux.so\"\n0x7fffb25388fd:  \"SHELL=/bin/bash\"\n0x7fffb253890d:  \"TERM=xterm\"\n0x7fffb2538918:  \"OLDPWD=/home/ryan\"\n0x7fffb253892a:  \"USER=root\"\n```"]