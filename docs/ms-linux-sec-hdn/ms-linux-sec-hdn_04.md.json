["```\ngpg --gen-key\n```", "```\ngpg: directory `/home/donnie/.gnupg' created\ngpg: new configuration file `/home/donnie/.gnupg/gpg.conf' created\ngpg: WARNING: options in `/home/donnie/.gnupg/gpg.conf' are not yet active during this run\ngpg: keyring `/home/donnie/.gnupg/secring.gpg' created\ngpg: keyring `/home/donnie/.gnupg/pubring.gpg' created\n```", "```\nPlease select what kind of key you want:\n   (1) RSA and RSA (default)\n   (2) DSA and Elgamal\n   (3) DSA (sign only)\n   (4) RSA (sign only)\nYour selection?  \n```", "```\nRSA keys may be between 1024 and 4096 bits long.\nWhat keysize do you want? (2048)\n```", "```\nPlease specify how long the key should be valid.\n         0 = key does not expire\n      <n>  = key expires in n days\n      <n>w = key expires in n weeks\n      <n>m = key expires in n months\n      <n>y = key expires in n years\nKey is valid for? (0)\n```", "```\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: Donald A. Tevault\nEmail address: donniet@something.net\nComment: No comment\nYou selected this USER-ID:\n    \"Donald A. Tevault (No comment) <donniet@something.net>\"\n\nChange (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit?\n```", "```\nYou need a Passphrase to protect your secret key.\n\nWe need to generate a lot of random bytes. It is a good idea to perform\nsome other action (type on the keyboard, move the mouse, utilize the\ndisks) during the prime generation; this gives the random number\ngenerator a better chance to gain enough entropy.\n```", "```\ngpg: /home/donnie/.gnupg/trustdb.gpg: trustdb created\ngpg: key 19CAEC5B marked as ultimately trusted\npublic and secret key created and signed.\n\ngpg: checking the trustdb\ngpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model\ngpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u\npub   2048R/19CAEC5B 2017-10-26\n      Key fingerprint = 8DE5 8894 2E37 08C4 5B26  9164 C77C 6944 19CA EC5B\nuid                  Donald A. Tevault (No comment) <donniet@something.net>\nsub   2048R/37582F29 2017-10-26\n```", "```\n[donnie@localhost ~]$ gpg --list-keys\n/home/donnie/.gnupg/pubring.gpg\n-------------------------------\npub   2048R/19CAEC5B 2017-10-26\nuid                  Donald A. Tevault (No comment) <donniet@something.net>\nsub   2048R/37582F29 2017-10-26\n\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ ls -l .gnupg\ntotal 28\n-rw-------. 1 donnie donnie 7680 Oct 26 13:22 gpg.conf\ndrwx------. 2 donnie donnie    6 Oct 26 13:40 private-keys-v1.d\n-rw-------. 1 donnie donnie 1208 Oct 26 13:45 pubring.gpg\n-rw-------. 1 donnie donnie 1208 Oct 26 13:45 pubring.gpg~\n-rw-------. 1 donnie donnie  600 Oct 26 13:45 random_seed\n-rw-------. 1 donnie donnie 2586 Oct 26 13:45 secring.gpg\nsrwxrwxr-x. 1 donnie donnie    0 Oct 26 13:40 S.gpg-agent\n-rw-------. 1 donnie donnie 1280 Oct 26 13:45 trustdb.gpg\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ gpg -c secret_squirrel_stuff.txt\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ ls -l\ntotal 1748\n-rw-rw-r--. 1 donnie donnie      37 Oct 26 14:22 secret_squirrel_stuff.txt\n-rw-rw-r--. 1 donnie donnie      94 Oct 26 14:22 secret_squirrel_stuff.txt.gpg\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ shred -u -z secret_squirrel_stuff.txt\n[donnie@localhost ~]$\n```", "```\nShhh!!!!  This file is super-secret.\nsecret_squirrel_stuff.txt.gpg (END)\n```", "```\nsudo mkdir /shared\nsudo chown donnie: /shared\nsudo chmod 755 /shared\nmv secret_squirrel_stuff.txt.gpg /shared\n```", "```\n[maggie@localhost shared]$ less secret_squirrel_stuff.txt.gpg\n\"secret_squirrel_stuff.txt.gpg\" may be a binary file.  See it anyway?\n```", "```\n<8C>^M^D^C^C^B<BD>2=<D3>\u0348u<93><CE><C9>M\u041eOy<B6>^O<A2><AD>}Rg9<94><EB><C4>^W^E<A6><8D><B9><B8><D3>(<98><C4>\u00e6F^_8Q2b<B8>C<B5><DB>^]<F1><CD>#<90>H<EB><90><C5>^S%X  [<E9><EF><C7>\n^@y+<FC><F2><BA><U+058C>H'+<D4>v<84>Y<98>G<D7>\u058a\nsecret_squirrel_stuff.txt.gpg (END)\n```", "```\n[donnie@localhost shared]$ gpg -d secret_squirrel_stuff.txt.gpg\ngpg: CAST5 encrypted data\ngpg: encrypted with 1 passphrase\nShhh!!!!  This file is super-secret.\ngpg: WARNING: message was not integrity protected\n[donnie@localhost shared]$\n```", "```\n gpg --gen-key\n```", "```\n        touch {file1.txt,file2.txt,file3.txt,file4.txt}\n```", "```\n sudo mkdir /backup\n sudo chown your_username: /backup\n sudo chmod 700 /backup\n```", "```\n cd /home\n sudo tar cJvf - your_username/ | gpg -c >\n /backup/your_username_backup.tar.xz.gpg\n```", "```\n        cd /backup\n sudo gpg -d your_username.tar.xz.gpg | tar xvJ\n ls -la your_username/\n```", "```\ncd .gnupg\ngpg --export -a -o donnie_public-key.txt\n\ndonnie@ubuntu:~/.gnupg$ ls -l\ntotal 36\n-rw-rw-r-- 1 donnie donnie 1706 Oct 27 18:14 donnie_public-key.txt\n. . .\n\nfrank@ubuntu:~/.gnupg$ ls -l\ntotal 36\n-rw-rw-r-- 1 frank frank 1714 Oct 27 18:18 frank_public-key.txt\n\n```", "```\ndonnie@ubuntu:~/.gnupg$ gpg --import frank_public-key.txt\ngpg: key 4CFC6990: public key \"Frank Siamese (I am a cat.) <frank@any.net>\" imported\ngpg: Total number processed: 1\ngpg: imported: 1 (RSA: 1)\ndonnie@ubuntu:~/.gnupg$\n\nfrank@ubuntu:~/.gnupg$ gpg --import donnie_public-key.txt\ngpg: key 9FD7014B: public key \"Donald A. Tevault <donniet@something.net>\" imported\ngpg: Total number processed: 1\ngpg:               imported: 1  (RSA: 1)\nfrank@ubuntu:~/.gnupg$\n```", "```\ndonnie@ubuntu:~$ gpg -s -e secret_stuff_for_frank.txt\n\nYou need a passphrase to unlock the secret key for\nuser: \"Donald A. Tevault <donniet@something.net>\"\n2048-bit RSA key, ID 9FD7014B, created 2017-10-27\n\ngpg: gpg-agent is not available in this session\nYou did not specify a user ID. (you may use \"-r\")\n\nCurrent recipients:\n\nEnter the user ID.  End with an empty line: frank\ngpg: CD8104F7: There is no assurance this key belongs to the named user\n\npub  2048R/CD8104F7 2017-10-27 Frank Siamese (I am a cat.) <frank@any.net>\n Primary key fingerprint: 4806 7483 5442 D62B B9BD  95C1 9564 92D4 4CFC 6990\n Subkey fingerprint: 9DAB 7C3C 871D 6711 4632  A5E0 6DDD E3E5 CD81 04F7\n\nIt is NOT certain that the key belongs to the person named\nin the user ID.  If you *really* know what you are doing,\nyou may answer the next question with yes.\n\nUse this key anyway? (y/N) y\n\nCurrent recipients:\n2048R/CD8104F7 2017-10-27 \"Frank Siamese (I am a cat.) <frank@any.net>\"\n\nEnter the user ID.  End with an empty line:\ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ ls -l\ntotal 8\n. . .\n-rw-rw-r-- 1 donnie donnie 143 Oct 27 18:37 secret_stuff_for_frank.txt\n-rw-rw-r-- 1 donnie donnie 790 Oct 27 18:39 secret_stuff_for_frank.txt.gpg\ndonnie@ubuntu:~$\n```", "```\nfrank@ubuntu:~$ gpg -d secret_stuff_for_frank.txt.gpg\n\nYou need a passphrase to unlock the secret key for\nuser: \"Frank Siamese (I am a cat.) <frank@any.net>\"\n2048-bit RSA key, ID CD8104F7, created 2017-10-27 (main key ID 4CFC6990)\n\ngpg: gpg-agent is not available in this session\ngpg: encrypted with 2048-bit RSA key, ID CD8104F7, created 2017-10-27\n \"Frank Siamese (I am a cat.) <frank@any.net>\"\nThis is TOP SECRET stuff that only Frank can see!!!!!\nIf anyone else see it, it's the end of the world as we know it.\n(With apologies to REM.)\ngpg: Signature made Fri 27 Oct 2017 06:39:15 PM EDT using RSA key ID 9FD7014B\ngpg: Good signature from \"Donald A. Tevault <donniet@something.net>\"\ngpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\nPrimary key fingerprint: DB0B 31B8 876D 9B2C 7F12  9FC3 886F 3357 9FD7 014B\nfrank@ubuntu:~$\n```", "```\nfrank@ubuntu:~$ cd .gnupg\nfrank@ubuntu:~/.gnupg$ gpg --edit-key donnie\ngpg (GnuPG) 1.4.20; Copyright (C) 2015 Free Software Foundation, Inc.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\ngpg: checking the trustdb\ngpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model\ngpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u\npub  2048R/9FD7014B  created: 2017-10-27  expires: never       usage: SC\n trust: ultimate      validity: ultimate\nsub  2048R/9625E7E9  created: 2017-10-27  expires: never       usage: E\n[ultimate] (1). Donald A. Tevault <donniet@something.net>\n\ngpg>\n\n```", "```\ngpg> trust\npub  2048R/9FD7014B  created: 2017-10-27  expires: never       usage: SC\n trust: unknown       validity: unknown\nsub  2048R/9625E7E9  created: 2017-10-27  expires: never       usage: E\n[ unknown] (1). Donald A. Tevault <donniet@something.net>\n\nPlease decide how far you trust this user to correctly verify other users' keys\n(by looking at passports, checking fingerprints from different sources, etc.)\n\n 1 = I don't know or won't say\n 2 = I do NOT trust\n 3 = I trust marginally\n 4 = I trust fully\n 5 = I trust ultimately\n m = back to the main menu\n\nYour decision? 5\nDo you really want to set this key to ultimate trust? (y/N) y\n```", "```\nfrank@ubuntu:~$ gpg -d secret_stuff_for_frank.txt.gpg\n\nYou need a passphrase to unlock the secret key for\nuser: \"Frank Siamese (I am a cat.) <frank@any.net>\"\n2048-bit RSA key, ID CD8104F7, created 2017-10-27 (main key ID 4CFC6990)\n\ngpg: gpg-agent is not available in this session\ngpg: encrypted with 2048-bit RSA key, ID CD8104F7, created 2017-10-27\n \"Frank Siamese (I am a cat.) <frank@any.net>\"\nThis is TOP SECRET stuff that only Frank can see!!!!!\nIf anyone else see it, it's the end of the world as we know it.\n(With apologies to REM.)\ngpg: Signature made Fri 27 Oct 2017 06:39:15 PM EDT using RSA key ID 9FD7014B\ngpg: Good signature from \"Donald A. Tevault <donniet@something.net>\"\nfrank@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ gpg -s not_secret_for_frank.txt\n\nYou need a passphrase to unlock the secret key for\nuser: \"Donald A. Tevault <donniet@something.net>\"\n2048-bit RSA key, ID 9FD7014B, created 2017-10-27\n\ngpg: gpg-agent is not available in this session\ndonnie@ubuntu:~$ ls -l\n. . .\n-rw-rw-r-- 1 donnie donnie  40 Oct 27 19:30 not_secret_for_frank.txt\n-rw-rw-r-- 1 donnie donnie 381 Oct 27 19:31 not_secret_for_frank.txt.gpg\n```", "```\nfrank@ubuntu:~$ less not_secret_for_frank.txt.gpg\n\"not_secret_for_frank.txt.gpg\" may be a binary file.  See it anyway?\n\n<A3>^A^Av^A<89><FE><90>^M^C^@^B^A<88>o3W<9F><D7>^AK^A<AC>Fb^Xnot_secret_for_frank.txtY<F3><C1><C0>This isn't secret, so I just signed it.\n<89>^A^\\^D^@^A^B^@^F^E^BY<F3><C1><C0>^@\n ^P<88>o3W<9F><D7>^AK6<AF>^G<FF>Bs<9A>^Lc^@<E9><ED><C2>-2<AE><A7><DF>\u037aaB\n<EC>/[:<D1>{<B2><FD>o8<C6><C9>x<FE>*4^D<CD>^G^O^F<F3>@v<87>_1<D0>^Bp<FE>q^N3<B0><BE><85><D2>9]{<D6><EF><9A><D8>  `<C2><E4>^NC<9B>        \"\u0541^?M<89>s<9F>z^B\"<DF>\ns}`<A4>:<B4>&<F7><F4>\\Ej\u0230!^Q <9C>6^E|H<E2>ESC<D9>9<DC>p_\u04deESCB<DE>^P<FF>i<CA>)^O\n<A0>     <CB><C4>+<81><F5><A7>`5<90><BF>Y<DE><FF><<A0>z<BC><BD>5<C5><E8><FE>>\n<B7><A2>^L^_^D<DD>Kk<E0><9A>8<C6>S^E<D0>fjz<B2>&G<A4><A8>^Lg$8Q>{<FF><FA>^M_A\n<A1><93><C3>4<DC><C4>x<86><D9>^]- <8A> F0<87><8A><94>%A<96><DF><CD>C><80><C3>l\n<D3>K<E5>^G<8E><90>d<8C><DA>A\u0271b<86><89><DA>S<B6><91><D8><D2><E0><B3>K<FC><9E>\n<ED>^@*<EF>x<E7>j\u00f8<FD><D3><FA><9A>^]\nnot_secret_for_frank.txt.gpg (END)\n```", "```\nfrank@ubuntu:~$ gpg --verify not_secret_for_frank.txt.gpg\ngpg: Signature made Fri 27 Oct 2017 07:31:12 PM EDT using RSA key ID 9FD7014B\ngpg: Good signature from \"Donald A. Tevault <donniet@something.net>\"\nfrank@ubuntu:~$\n```", "```\n[donnie@localhost etc]$ sudo lvdisplay\n --- Logical volume ---\n LV Path /dev/centos/swap\n LV Name swap\n VG Name centos\n LV UUID tsme2v-uy87-uech-vpNp-W4E7-fHLf-3bf817\n LV Write Access read/write\n LV Creation host, time localhost, 2017-10-28 13:00:11 -0400\n LV Status available\n # open 2\n LV Size 2.00 GiB\n Current LE 512\n Segments 1\n Allocation inherit\n Read ahead sectors auto\n - currently set to 8192\n Block device 253:2\n\n --- Logical volume ---\n LV Path /dev/centos/root\n LV Name root\n VG Name centos\n LV UUID MKXVO9-X8fo-w2FC-LnGO-GLnq-k2Xs-xI1gn0\n LV Write Access read/write\n LV Creation host, time localhost, 2017-10-28 13:00:12 -0400\n LV Status available\n # open 1\n LV Size 17.06 GiB\n Current LE 4368\n Segments 1\n Allocation inherit\n Read ahead sectors auto\n - currently set to 8192\n Block device 253:1\n\n[donnie@localhost etc]$\n```", "```\n[donnie@localhost etc]$ sudo pvdisplay\n --- Physical volume ---\n PV Name               /dev/mapper/luks-2d7f02c7-864f-42ce-b362-50dd830d9772\n VG Name               centos\n PV Size               <19.07 GiB / not usable 0\n Allocatable           yes\n PE Size               4.00 MiB\n Total PE              4881\n Free PE               1\n Allocated PE          4880\n PV UUID               V50E4d-jOCU-kVRn-67w9-5zwR-nbwg-4P725S\n\n[donnie@localhost etc]$\n```", "```\nsudo yum install gdisk\nsudo gdisk /dev/sdb\n```", "```\n[donnie@localhost ~]$ sudo gdisk -l /dev/sdb\n[sudo] password for donnie:\nGPT fdisk (gdisk) version 0.8.6\n\nPartition table scan:\n MBR: protective\n BSD: not present\n APM: not present\n GPT: present\n\nFound valid GPT with protective MBR; using GPT.\nDisk /dev/sdb: 43978112 sectors, 21.0 GiB\nLogical sector size: 512 bytes\nDisk identifier (GUID): DC057EC6-3BA8-4269-ABE9-2A28B4FDC84F\nPartition table holds up to 128 entries\nFirst usable sector is 34, last usable sector is 43978078\nPartitions will be aligned on 2048-sector boundaries\nTotal free space is 2014 sectors (1007.0 KiB)\n\nNumber Start (sector) End (sector) Size Code Name\n 1 2048 43978078 21.0 GiB 8300 Linux filesystem\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo cryptsetup -v -y luksFormat /dev/sdb1\n\nWARNING!\n========\nThis will overwrite data on /dev/sdb1 irrevocably.\n\nAre you sure? (Type uppercase yes): YES\nEnter passphrase:\nVerify passphrase:\nCommand successful.\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo cryptsetup luksDump /dev/sdb1\nLUKS header information for /dev/sdb1\n\nVersion:           1\nCipher name:       aes\nCipher mode:       xts-plain64\nHash spec:         sha256\n. . .\n. . .\n```", "```\n[donnie@localhost ~]$ sudo cryptsetup luksOpen /dev/sdb1 secrets\nEnter passphrase for /dev/sdb1:\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost mapper]$ pwd\n/dev/mapper\n[donnie@localhost mapper]$ ls -l se*\nlrwxrwxrwx. 1 root root 7 Oct 28 17:39 secrets -> ../dm-3\n[donnie@localhost mapper]$\n```", "```\n[donnie@localhost mapper]$ sudo dmsetup info secrets\n[sudo] password for donnie:\nName:              secrets\nState:             ACTIVE\nRead Ahead:        8192\nTables present:    LIVE\nOpen count:        0\nEvent number:      0\nMajor, minor:      253, 3\nNumber of targets: 1\nUUID: CRYPT-LUKS1-6cbdce1748d441a18f8e793c0fa7c389-secrets\n\n[donnie@localhost mapper]$\n```", "```\n[donnie@localhost ~]$ sudo mkfs.xfs /dev/mapper/secrets\nmeta-data=/dev/mapper/secrets    isize=512    agcount=4, agsize=1374123 blks\n =                       sectsz=512   attr=2, projid32bit=1\n =                       crc=1        finobt=0, sparse=0\ndata     =                       bsize=4096   blocks=5496491, imaxpct=25\n =                       sunit=0      swidth=0 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal log           bsize=4096   blocks=2683, version=2\n =                       sectsz=512   sunit=0 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo mkdir /secrets\n[sudo] password for donnie:\n[donnie@localhost ~]$ sudo mount /dev/mapper/secrets /secrets\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ mount | grep 'secrets'\n/dev/mapper/secrets on /secrets type xfs (rw,relatime,seclabel,attr2,inode64,noquota)\n[donnie@localhost ~]$\n```", "```\nluks-2d7f02c7-864f-42ce-b362-50dd830d9772 UUID=2d7f02c7-864f-42ce-b362-50dd830d9772 none\n```", "```\n/dev/mapper/centos-root /                 xfs     defaults,x-systemd.device-timeout=0 0 0\nUUID=9f9fbf9c-d046-44fc-a73e-ca854d0ca718 /boot                   xfs     defaults        0 0\n/dev/mapper/centos-swap swap              swap    defaults,x-systemd.device-timeout=0 0 0\n```", "```\n[donnie@localhost etc]$ sudo cryptsetup luksUUID /dev/sdb1\n[sudo] password for donnie:\n6cbdce17-48d4-41a1-8f8e-793c0fa7c389\n[donnie@localhost etc]$\n```", "```\nluks-2d7f02c7-864f-42ce-b362-50dd830d9772 UUID=2d7f02c7-864f-42ce-b362-50dd830d9772 none\nluks-6cbdce17-48d4-41a1-8f8e-793c0fa7c389 UUID=6cbdce17-48d4-41a1-8f8e-793c0fa7c389 none\n```", "```\n/dev/mapper/centos-root / xfs defaults,x-systemd.device-timeout=0 0 0\nUUID=9f9fbf9c-d046-44fc-a73e-ca854d0ca718 /boot xfs defaults 0 0\n/dev/mapper/centos-swap swap swap defaults,x-systemd.device-timeout=0 0 0\n/dev/mapper/luks-6cbdce17-48d4-41a1-8f8e-793c0fa7c389 /secrets xfs defaults 0 0\n```", "```\n[donnie@localhost ~]$ mount | grep 'secrets'\n/dev/mapper/luks-6cbdce17-48d4-41a1-8f8e-793c0fa7c389 on /secrets type xfs (rw,relatime,seclabel,attr2,inode64,noquota)\n[donnie@localhost ~]$\n```", "```\ndonnie@ubuntu3:~$ cd /etc\ndonnie@ubuntu3:/etc$ cat crypttab\nsda5_crypt UUID=56190c2b-e46b-40a9-af3c-4cb26c4fe998 none luks,discard\ncryptswap1 UUID=60661042-0dbd-4c2a-9cf9-7f02a73864ae /dev/urandom swap,offset=1024,cipher=aes-xts-plain64\ndonnie@ubuntu3:/etc$\n```", "```\ndonnie@ubuntu3:/home$ ls -la\ntotal 16\ndrwxr-xr-x 4 root root 4096 Oct 29 15:06 .\ndrwxr-xr-x 23 root root 4096 Oct 29 15:23 ..\ndrwx------ 3 donnie donnie 4096 Oct 29 15:29 donnie\ndrwxr-xr-x 3 root root 4096 Oct 29 15:06 .ecryptfs\ndonnie@ubuntu3:/home$\n```", "```\nsudo adduser --encrypt-home goldie\n```", "```\necryptfs-unwrap-passphrase .ecryptfs/wrapped-passphrase\n```", "```\nsudo apt install ecryptfs-utils\n```", "```\ncharlie@ubuntu2:~$ ecryptfs-setup-private\nEnter your login passphrase [charlie]:\nEnter your mount passphrase [leave blank to generate one]:\nEnter your mount passphrase (again):\n\n************************************************************************\nYOU SHOULD RECORD YOUR MOUNT PASSPHRASE AND STORE IT IN A SAFE LOCATION.\n ecryptfs-unwrap-passphrase ~/.ecryptfs/wrapped-passphrase\nTHIS WILL BE REQUIRED IF YOU NEED TO RECOVER YOUR DATA AT A LATER TIME.\n************************************************************************\n\nDone configuring.\n\nTesting mount/write/umount/read...\nInserted auth tok with sig [e339e1ebf3d58c36] into the user session keyring\nInserted auth tok with sig [7a40a176ac647bf0] into the user session keyring\nInserted auth tok with sig [e339e1ebf3d58c36] into the user session keyring\nInserted auth tok with sig [7a40a176ac647bf0] into the user session keyring\nTesting succeeded.\n\nLogout, and log back in to begin using your encrypted directory.\n\ncharlie@ubuntu2:~$\n```", "```\ncharlie@ubuntu2:~$ ecryptfs-unwrap-passphrase .ecryptfs/wrapped-passphrase\nPassphrase:\nTurkeyLips\ncharlie@ubuntu2:~$\n```", "```\ncharlie@ubuntu2:~$ ls -la\ntotal 40\ndrwxr-xr-x 6 charlie charlie 4096 Oct 30 17:00 .\ndrwxr-xr-x 4 root root 4096 Oct 30 16:38 ..\n-rw------- 1 charlie charlie 270 Oct 30 17:00 .bash_history\n-rw-r--r-- 1 charlie charlie 220 Aug 31 2015 .bash_logout\n-rw-r--r-- 1 charlie charlie 3771 Aug 31 2015 .bashrc\ndrwx------ 2 charlie charlie 4096 Oct 30 16:39 .cache\ndrwx------ 2 charlie charlie 4096 Oct 30 16:57 .ecryptfs\ndrwx------ 2 charlie charlie 4096 Oct 30 16:57 Private\ndrwx------ 2 charlie charlie 4096 Oct 30 16:57 .Private\n-rw-r--r-- 1 charlie charlie 655 May 16 08:49 .profile\ncharlie@ubuntu2:~$\n```", "```\ndonnie@ubuntu2:/etc/pam.d$ grep 'ecryptfs' *\ncommon-auth:auth    optional    pam_ecryptfs.so unwrap\ncommon-password:password    optional    pam_ecryptfs.so\ncommon-session:session    optional    pam_ecryptfs.so unwrap\ncommon-session-noninteractive:session    optional    pam_ecryptfs.so unwrap\ndonnie@ubuntu2:/etc/pam.d$\n```", "```\nsudo mkdir /secrets\nsudo mount -t ecryptfs /secrets /secrets\n```", "```\ndonnie@ubuntu2:~$ sudo mount -t ecryptfs /secrets /secrets\n[sudo] password for donnie:\nPassphrase:\nSelect cipher:\n 1) aes: blocksize = 16; min keysize = 16; max keysize = 32\n 2) blowfish: blocksize = 8; min keysize = 16; max keysize = 56\n 3) des3_ede: blocksize = 8; min keysize = 24; max keysize = 24\n 4) twofish: blocksize = 16; min keysize = 16; max keysize = 32\n 5) cast6: blocksize = 16; min keysize = 16; max keysize = 32\n 6) cast5: blocksize = 8; min keysize = 5; max keysize = 16\nSelection [aes]:\nSelect key bytes:\n 1) 16\n 2) 32\n 3) 24\nSelection [16]:\n```", "```\nEnable plaintext passthrough (y/n) [n]:\nEnable filename encryption (y/n) [n]: y\n```", "```\nFilename Encryption Key (FNEK) Signature [e339e1ebf3d58c36]:\nAttempting to mount with the following options:\n  ecryptfs_unlink_sigs\n  ecryptfs_fnek_sig=e339e1ebf3d58c36\n  ecryptfs_key_bytes=16\n  ecryptfs_cipher=aes\n  ecryptfs_sig=e339e1ebf3d58c36\n```", "```\nWARNING: Based on the contents of [/root/.ecryptfs/sig-cache.txt],\nit looks like you have never mounted with this key\nbefore. This could mean that you have typed your\npassphrase wrong.\n\nWould you like to proceed with the mount (yes/no)? : yes\nWould you like to append sig [e339e1ebf3d58c36] to\n[/root/.ecryptfs/sig-cache.txt]\nin order to avoid this warning in the future (yes/no)? : yes\nSuccessfully appended new sig to user sig cache file\nMounted eCryptfs\ndonnie@ubuntu2:~$\n```", "```\ncd /secrets\nsudo vim secret_stuff.txt\ncd\nsudo umount /secrets\nls -l /secrets\n\ndonnie@ubuntu2:/secrets$ ls -l\ntotal 12\n-rw-r--r-- 1 root root 12288 Oct 31 18:24 ECRYPTFS_FNEK_ENCRYPTED.FXbXCS5fwxKABUQtEPlumGPaN-RGvqd13yybkpTr1eCVWVHdr-lrmi1X9Vu-mLM-A-VeqIdN6KNZGcs-\ndonnie@ubuntu2:/secrets$\n```", "```\ndonnie@ubuntu:~$ sudo ecryptfs-setup-swap\n[sudo] password for donnie:\n\nWARNING:\nAn encrypted swap is required to help ensure that encrypted files are not leaked to disk in an unencrypted format.\n\nHOWEVER, THE SWAP ENCRYPTION CONFIGURATION PRODUCED BY THIS PROGRAM WILL BREAK HIBERNATE/RESUME ON THIS SYSTEM!\n\nNOTE: Your suspend/resume capabilities will not be affected.\n\nDo you want to proceed with encrypting your swap? [y/N]: y\n\nINFO: Setting up swap: [/dev/sda5]\nWARNING: Commented out your unencrypted swap from /etc/fstab\nswapon: stat of /dev/mapper/cryptswap1 failed: No such file or directory\ndonnie@ubuntu:~$\n```", "```\ndonnie@linux-0ro8:~/Downloads> ls -l vera*\n-r-xr-xr-x 1 donnie users  2976573 Jul  9 05:10 veracrypt-1.21-setup-console-x64\n-r-xr-xr-x 1 donnie users  2967950 Jul  9 05:14 veracrypt-1.21-setup-console-x86\n-r-xr-xr-x 1 donnie users  4383555 Jul  9 05:08 veracrypt-1.21-setup-gui-x64\n-r-xr-xr-x 1 donnie users  4243305 Jul  9 05:13 veracrypt-1.21-setup-gui-x86\n-rw-r--r-- 1 donnie users 14614830 Oct 31 23:49 veracrypt-1.21-setup.tar.bz2\ndonnie@linux-0ro8:~/Downloads>\n```", "```\ndonnie@ubuntu:~$ ./veracrypt-1.21-setup-console-x64\n```", "```\nveracrypt -c\n```", "```\ndonnie@ubuntu:~$ veracrypt -c\nVolume type:\n 1) Normal\n 2) Hidden\nSelect [1]:\n\nEnter volume path: /home/donnie/good_stuff\n\nEnter volume size (sizeK/size[M]/sizeG): 2G\n\nEncryption Algorithm:\n 1) AES\n 2) Serpent\n 3) Twofish\n 4) Camellia\n 5) Kuznyechik\n 6) AES(Twofish)\n 7) AES(Twofish(Serpent))\n 8) Serpent(AES)\n 9) Serpent(Twofish(AES))\n 10) Twofish(Serpent)\nSelect [1]:\n\nHash algorithm:\n 1) SHA-512\n 2) Whirlpool\n 3) SHA-256\n 4) Streebog\nSelect [1]:\n. . .\n. . .\n```", "```\nFilesystem:\n 1) None\n 2) FAT\n 3) Linux Ext2\n 4) Linux Ext3\n 5) Linux Ext4\n 6) NTFS\n 7) exFAT\nSelect [2]:\n```", "```\nEnter password:\nRe-enter password:\n\nEnter PIM: 8891\n\nEnter keyfile path [none]:\n\nPlease type at least 320 randomly chosen characters and then press Enter:\n```", "```\ndonnie@ubuntu:~$ ls -l good_stuff\n-rw------- 1 donnie donnie 2147483648 Nov  1 17:02 good_stuff\ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ mkdir good_stuff_dir\ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ veracrypt good_stuff good_stuff_dir\nEnter password for /home/donnie/good_stuff:\nEnter PIM for /home/donnie/good_stuff: 8891\nEnter keyfile [none]:\nProtect hidden volume (if any)? (y=Yes/n=No) [No]:\nEnter your user password or administrator password:\ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ veracrypt -l\n1: /home/donnie/secret_stuff /dev/mapper/veracrypt1 /home/donnie/secret_stuff_dir\n2: /home/donnie/good_stuff /dev/mapper/veracrypt2 /home/donnie/good_stuff_dir\ndonnie@ubuntu:~$\n```", "```\nProtocol 1\n```", "```\nProtocol 1, 2\n```", "```\ndonnie@linux-0ro8:~> ssh donnie@192.168.0.8\ndonnie@192.168.0.8's password:\n```", "```\ndonnie@linux-0ro8:~> ssh-keygen\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/donnie/.ssh/id_rsa):\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in /home/donnie/.ssh/id_rsa.\nYour public key has been saved in /home/donnie/.ssh/id_rsa.pub.\nThe key fingerprint is:\nSHA256:oqDpCvAptbE8srN6Z4FNXxgkhPhjh1sEKazfMpxhVI8 donnie@linux-0ro8\nThe key's randomart image is:\n+---[RSA 2048]----+\n|...*+..          |\n|o.+ .+.          |\n|.+ oE .o         |\n|. B + . .        |\n|.=+% ...S        |\n|.*O*+...         |\n|* Bo..           |\n|++..o            |\n|B= o             |\n+----[SHA256]-----+\ndonnie@linux-0ro8:~>\n```", "```\ndonnie@linux-0ro8:~/.ssh> ls -l\ntotal 12\n-rw------- 1 donnie users 1766 Nov  2 17:52 id_rsa\n-rw-r--r-- 1 donnie users  399 Nov  2 17:52 id_rsa.pub\n-rw-r--r-- 1 donnie users 2612 Oct 31 18:40 known_hosts\ndonnie@linux-0ro8:~/.ssh>\n```", "```\ndonnie@linux-0ro8:~> exec /usr/bin/ssh-agent $SHELL\ndonnie@linux-0ro8:~> ssh-add\nEnter passphrase for /home/donnie/.ssh/id_rsa:\nIdentity added: /home/donnie/.ssh/id_rsa (/home/donnie/.ssh/id_rsa)\ndonnie@linux-0ro8:~>\n```", "```\ndonnie@linux-0ro8:~> ssh-copy-id donnie@192.168.0.101\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\ndonnie@192.168.0.101's password:\n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   \"ssh 'donnie@192.168.0.101'\"\nand check to make sure that only the key(s) you wanted were added.\n\ndonnie@linux-0ro8:~>\n```", "```\ndonnie@linux-0ro8:~> ssh donnie@192.168.0.101\nLast login: Wed Nov  1 20:11:20 2017\n[donnie@localhost ~]$\n```", "```\ndonnie@linux-0ro8:~> ssh donnie@192.168.0.101\nEnter passphrase for key '/home/donnie/.ssh/id_rsa':\n```", "```\n#PermitRootLogin yes\n```", "```\nPermitRootLogin no\n```", "```\nsudo systemctl restart sshd\n```", "```\nPermitRootLogin prohibit-password\n```", "```\n#PasswordAuthentication yes\n```", "```\nPasswordAuthentication no\n```", "```\nsudo groupadd sftpusers\n```", "```\nsudo useradd -G sftpusers max\n```", "```\nsudo useradd -m -d /home/max -s /bin/bash -G sftpusers max\n```", "```\nSubsystem sftp /usr/lib/openssh/sftp-server\n```", "```\nSubsystem sftp internal-sftp\n```", "```\nMatch Group sftpusers\n        ChrootDirectory /home\n        AllowTCPForwarding no\n        AllowAgentForwarding no\n        X11Forwarding no\n        ForceCommand internal-sftp\n```", "```\ndonnie@linux-0ro8:~> ssh max@192.168.0.8\nmax@192.168.0.8's password:\nThis service allows sftp connections only.\nConnection to 192.168.0.8 closed.\ndonnie@linux-0ro8:~>\n```", "```\ndonnie@linux-0ro8:~> sftp max@192.168.0.8\nmax@192.168.0.8's password:\nConnected to 192.168.0.8.\ndrwx------    7 1000     1000         4096 Nov  4 22:53 donnie\ndrwx------    5 1001     1001         4096 Oct 27 23:34 frank\ndrwx------    3 1003     1004         4096 Nov  4 22:43 katelyn\ndrwx------    2 1002     1003         4096 Nov  4 22:37 max\nsftp>\n```", "```\nsftp> cd /etc\nCouldn't stat remote file: No such file or directory\nsftp>\n```", "```\n sudo groupadd sftpusers\n```", "```\n        sudo useradd -G sftpusers max\n```", "```\n        sudo useradd -m -d /home/max -s /bin/bash -G sftpusers max\n```", "```\n        sudo chmod 700 /home/*\n```", "```\n        Subsystem sftp /usr/lib/openssh/sftp-server\n```", "```\n        Subsystem sftp internal-sftp\n```", "```\n        Match Group sftpusers\n                 ChrootDirectory /home\n                 AllowTCPForwarding no\n                 AllowAgentForwarding no\n                 X11Forwarding no\n                 ForceCommand internal-sftp\n```", "```\n        sudo systemctl sshd restart\n```", "```\n        sudo systemctl ssh restart\n```", "```\n        ssh max@IP_Address_of_your_vm\n```", "```\n        sftp max@IP_Address_of_your_vm\n```"]