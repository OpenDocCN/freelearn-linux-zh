- en: '*Chapter 18*: **Practice Exercises – 1**'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '*第18章*：**练习1**'
- en: In this practice exercise, we will run a set of steps to check the knowledge
    you have acquired throughout this book. As opposed to previous chapters, not all
    steps will be indicated, and it's therefore left to your discretion to perform
    the steps required to accomplish your desired goals. It is recommended to avoid
    referencing past chapters for guidance. Instead, try to use your memory, or the
    tools available in the system. This exercise, if performed correctly, will train
    you effectively for official exams.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将运行一系列步骤，检查您在整本书中所学到的知识。与之前的章节不同，不会指示所有步骤，因此您可以自行决定执行所需的步骤以完成您的目标。建议避免参考以前的章节进行指导。相反，尝试使用您的记忆或系统中可用的工具。如果正确执行此练习，将有效地为官方考试进行培训。
- en: It is strongly advised to start this exercise with a clock to keep track of
    time.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 强烈建议在进行此练习时使用时钟来跟踪时间。
- en: '**Technical requirements**'
  id: totrans-3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**技术要求**'
- en: '**All the practice exercise in this chapter requires the use of a virtual machine**
    (**VM**), running Red Hat Enterprise Linux 8 installed with the base installation.
    Additionally, new virtual drives will be required for storage operations.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '**本章中的所有练习都需要使用虚拟机**（**VM**），运行安装了基本安装的Red Hat Enterprise Linux 8。此外，存储操作将需要新的虚拟驱动器。'
- en: 'For the exercises, it is assumed you possess the following:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 对于练习，假设您拥有以下内容：
- en: Red Hat Enterprise Linux 8 installed with the base operating system **minimal
    install** software selection.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装了基本操作系统**最小安装**软件选择的Red Hat Enterprise Linux 8。
- en: Access to the Red Hat Customer Portal, with an active subscription.
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问Red Hat客户门户，具有有效的订阅。
- en: The VM must be expendable. This is because actions performed on it during the
    exercise might render it unusable and require it to be reinstalled.
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机必须是可扩展的。这是因为在练习期间对其执行的操作可能使其无法使用，并需要重新安装。
- en: Tips for the exercise
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习提示
- en: 'This is a list of general recommendations for any test, and most fall under
    the category of common sense, but it''s always important to have them in our mind
    before performing any such test:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 这是任何测试的一般建议清单，大多数属于常识范畴，但在进行任何测试之前将它们牢记在心是非常重要的：
- en: Read all the questions before starting the official exam or any test.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在开始官方考试或任何测试之前，请先阅读所有问题。
- en: Specific words have specific meanings that give hints about the requirements
    or ways to accomplish the goals. This is why reading everything first might give
    you multiple perspectives on how to complete the test.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特定的词语具有特定的含义，可以提示关于要求或完成目标的方法。这就是为什么先阅读所有内容可能会给您多个完成测试的途径。
- en: Make yourself comfortable. Install your favorite editor and run `updatedb` to
    have a fresh database of packages and installed files ready for use. Define your
    keyboard layout. Install `tmux` and learn how to use it, so that you can open
    new tabs and name them without requiring extra windows.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让自己感到舒适。安装您喜欢的编辑器，并运行`updatedb`以获得一个新的软件包和已安装文件的数据库，以备使用。定义您的键盘布局。安装`tmux`并学习如何使用它，这样您就可以打开新标签并命名它们，而无需额外的窗口。
- en: Locate dependencies between requests, as some goals depend on others for completion.
    Find those dependencies to see how you can locate the solution without later having
    to come back and redo some steps as a result of choosing the wrong path.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找请求之间的依赖关系，因为有些目标取决于其他目标的完成。找到这些依赖关系，看看如何在不必后来回来重新做一些步骤的情况下找到解决方案。
- en: Use a timer. This is important to get an idea of what exercises will take you
    more time to complete, in order to see the areas that you need to improve in.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用计时器。这对于了解哪些练习将花费更多时间来完成是很重要的，以便看到您需要改进的领域。
- en: Don't remember specific command lines. Learn how to use the documentation available
    in the system via `man`, `/usr/share/docs` or arguments like `--help` for the
    commands required.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要记住具体的命令行。学习如何使用系统中的文档，通过`man`、`/usr/share/docs`或像`--help`这样的参数来获取所需命令的帮助。
- en: Ensure that changes persist and are still active after a reboot. Some changes
    might be active while you run them, but those must be persisted. Examples may
    include firewall rules, services to start at boot, and so on.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保更改持久并在重新启动后仍然有效。有些更改可能在运行时是有效的，但必须持久。例如防火墙规则、启动时要启动的服务等。
- en: Remember to use `dnf whatprovides /COMMAND"` to find packages providing a file
    you might be missing.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 记住使用`dnf whatprovides /COMMAND"`来查找提供您可能缺少的文件的软件包。
- en: 'Check the following link: [https://www.redhat.com/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam?=Objectives](https://www.redhat.com/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam?=Objectives).
    This will provide you with the official EX200 exam objectives.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查以下链接：[https://www.redhat.com/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam?=Objectives](https://www.redhat.com/en/services/training/ex200-red-hat-certified-system-administrator-rhcsa-exam?=Objectives)。这将为您提供官方EX200考试目标。
- en: Practice exercise 1
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习1
- en: Important note
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: The following exercise has, by design, been created so that there will be no
    highlights on commands, packages, and so on. Remember what you've learned so far
    in order to detect the keywords to see what needs to be done.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 以下练习是有意设计的，因此不会突出显示命令、软件包等。记住迄今为止学到的知识，以便检测关键字，看看需要做什么。
- en: Don't jump into the walk-through too early. Try to remember what was covered.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 不要过早地进行实际操作。试着记住已经涵盖的内容。
- en: Exercises
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 练习
- en: Configure the time zone to GMT.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将时区配置为GMT。
- en: Allow password-less login for the root user using SSH.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许root用户使用SSH进行无密码登录。
- en: Create a user (named *user*) that can connect to the machine without a password.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个可以无密码连接到机器的用户（名为*user*）。
- en: The user `user` should change their password every week, with 2 days' warning
    and 1 day of usage once expired.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户`user`应该每周更改密码，提前2天警告，过期后使用1天。
- en: The root user must be able to SSH as *user* without a password so that nobody
    can connect remotely as root using a password.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: root用户必须能够以*user*的身份通过SSH进行连接，而无需密码，以便没有人可以使用密码远程连接为root。
- en: The user *user* should be able to become root user without a password, and also
    execute commands without a password.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户*user*应能够在无需密码的情况下成为root用户，并且还能够在无需密码的情况下执行命令。
- en: When a user tries to log in over SSH, display a legal message about not allowing
    unauthorized access to this system.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当用户尝试通过SSH登录时，显示有关不允许未经授权访问该系统的法律消息。
- en: SSH must listen on port *22222*, instead of the default one (*22*).
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SSH必须在端口*22222*上监听，而不是默认的端口（*22*）。
- en: Create a group named `devel`.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`devel`的组。
- en: Make `user` a member of `devel`.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`user`添加为`devel`的成员。
- en: Store user membership in a file named `userids` in the home folder for *user.*
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将用户成员身份存储在名为`userids`的文件中，位于*user*的主文件夹中。
- en: The user *user*, and *root* user, should be able to connect to localhost via
    SSH without specifying the port, and default to compression for the connection.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户*user*和*root*用户应能够通过SSH连接到本地主机，而无需指定端口，并默认使用压缩进行连接。
- en: Find all man page names in the system, and put the names into a file named *manpages.txt*.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找系统中所有的man页名称，并将名称放入名为*manpages.txt*的文件中。
- en: Print usernames for users without logins permitted to the system. For each username,
    print the user ID and groups for that user.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印未允许登录到系统的用户的用户名。对于每个用户名，打印该用户的用户ID和组。
- en: Monitor available system resources every 5 minutes. Do not use cron. Store as
    */root/resources.log*.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 每5分钟监视可用系统资源。不使用cron。存储为*/root/resources.log*。
- en: Add a per-minute job to report the available percentage of free disk space,
    and store it in */root/freespace.log* so that it shows both the filesystem and
    free space.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个每分钟的作业，报告可用磁盘空间的百分比，并将其存储在*/root/freespace.log*中，以便显示文件系统和可用空间。
- en: Configure the system to only leave 3 days of logs.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置系统仅保留3天的日志。
- en: Configure the log rotation for */root/freespace.log* and */root/resources.log*.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置*/root/freespace.log*和*/root/resources.log*的日志轮换。
- en: Configure the time synchronization against *pool.ntp.org*, using fast sync.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用快速同步配置时间同步针对*pool.ntp.org*。
- en: Provide NTP server services for the subnet *172.22.0.1/24*.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为子网*172.22.0.1/24*提供NTP服务器服务。
- en: Configure system stats for collection every minute.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置系统统计信息，每分钟收集一次。
- en: Configure the password length for users in the system to be 12 characters long.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将系统中用户的密码长度配置为12个字符。
- en: Create a bot user named *privacy,* which will keep its files only visible to
    itself by default.
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为*privacy*的机器人用户，其文件默认情况下只对自己可见。
- en: Create a folder in *shared* that can be accessed by all users, and that defaults
    new files and directories to still be accessible to users of the *devel* group.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个在*shared*中可以被所有用户访问的文件夹，并将新文件和目录默认为仍然可以被*devel*组的用户访问。
- en: 'Configure a network connection with IPv4 and IPv6 addresses named *mynic,*
    using the following data:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置一个名为*mynic*的具有IPv4和IPv6地址的网络连接，使用以下数据：
- en: '[PRE0]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Allow the host to use a *google* hostname to reach [www.google.com](https://www.google.com),
    and a *redhat* hostname to reach [www.redhat.com](https://www.redhat.com).
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许主机使用*google*主机名访问[www.google.com](https://www.google.com)，并使用*redhat*主机名访问[www.redhat.com](https://www.redhat.com)。
- en: Report the files modified from those that the vendor distributed, and store
    them in */root/altered.txt*.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 报告从供应商分发的文件中修改的文件，并将它们存储在*/root/altered.txt*中。
- en: Make our system installation media packages available via HTTP under the */mirror
    path* for other systems to use as a mirror, configuring the repository in our
    system. Remove the kernel packages from that mirror, so that other systems (even
    ours) can't find new kernels. Prevent the glibc packages from being installed
    from this repo without removing them.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使我们的系统安装媒体包通过HTTP在*/mirror*路径下可供其他系统用作镜像，配置我们系统中的存储库。从该镜像中删除内核包，以便其他系统（甚至我们自己的系统）无法找到新的内核。防止从该存储库安装glibc包而不将其删除。
- en: While being *user*, make a copy of the */root* folder in */home/user/root/*
    folder, and keep it in sync every day, synchronizing additions and deletions.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在*user*身份下，将*/root*文件夹复制到*/home/user/root/*文件夹，并使其每天保持同步，同步添加和删除。
- en: Check that our system conforms to the PCI-DSS standard.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查我们的系统是否符合PCI-DSS标准。
- en: Add a second hard drive of 30 GB to the system. However, use only 15 GB to move
    the mirror to it, making it available at boot using compression and deduplication.
    Make it available under */mirror/mirror*.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向系统添加第二个30GB的硬盘。但是，只使用15GB将镜像移动到其中，并使用压缩和去重功能使其在启动时可用。将其放置在*/mirror/mirror*下。
- en: As we plan to mirror custom sets of packages based on the same data, configure
    the filesystem to report at least 1,500 GB to be used by our mirrors.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们计划基于相同数据镜像自定义软件包集，因此配置文件系统报告至少可供我们的镜像使用的1,500GB。
- en: Create a second copy of the mirror under */mirror/mytailormirror*, removing
    all packages starting with the letter *k**.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在*/mirror/mytailormirror*下创建镜像的第二个副本，删除所有以字母*k*开头的包。
- en: Create a new volume in the remaining space of the added hard drive (15 GB),
    and use it to extend the root filesystem.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在添加的硬盘剩余空间（15GB）中创建一个新卷，并将其用于扩展根文件系统。
- en: Create a boot entry that allows you to boot into emergency mode, in order to
    change the root password.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个启动项，允许您进入紧急模式，以更改根密码。
- en: Create a custom tuning profile that defines the readahead to be *4096* for the
    first drive and *1024* for the second drive. This profile should also crash the
    system should an OOM event occur.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个自定义调整配置文件，定义第一个驱动器的预读为*4096*，第二个驱动器的预读为*1024*。此配置文件还应在发生OOM事件时使系统崩溃。
- en: Disable and remove the installed HTTP package. Then, set up the HTTP server
    using the *registry.redhat.io/rhel8/httpd-24* image.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 禁用并删除已安装的HTTP包。然后，使用*registry.redhat.io/rhel8/httpd-24*镜像设置HTTP服务器。
- en: For this section, we'll copy each item in the list of goals, and then provide
    an explanation below it, using proper syntax highlighting and explanations.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这一部分，我们将复制目标列表中的每个项目，然后在其下方提供解释，使用适当的语法突出显示和解释。
- en: Exercise 1 resolution
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习1解决方案
- en: 1\. Configuring the time zone to GMT
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1. 将时区配置为GMT
- en: We can check the current system date by executing the `date` command. At the
    very last part of the line that is subsequently printed, the time zone will be
    shown. In order to configure it, we can use the `timedatectl` command, or alter
    the `/etc/localtime` symbolic link.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过执行`date`命令来检查当前系统日期。在随后打印的行的最后部分，将显示时区。为了配置它，我们可以使用`timedatectl`命令，或者修改`/etc/localtime`符号链接。
- en: 'So, to achieve this goal, we can use one of the following:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，为了实现这个目标，我们可以使用以下之一：
- en: '`timedatectl set-timezone GMT`'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`timedatectl set-timezone GMT`'
- en: '`rm –fv /etc/localtime; ln –s /usr/share/zoneinfo/GMT /etc/localtime`'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rm –fv /etc/localtime; ln –s /usr/share/zoneinfo/GMT /etc/localtime`'
- en: Now `date` should report the proper time zone.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在`date`应该报告正确的时区。
- en: 2\. Allowing password-less login to the root user using SSH
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2. 允许无密码登录到root用户使用SSH
- en: 'Doing this will require the following:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 这将需要以下操作：
- en: SSH must be installed and available (that means installed and started).
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SSH必须已安装并可用（这意味着已安装并已启动）。
- en: The root user should have an SSH key generated and added to the list of authorized
    keys.
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: root用户应该生成一个SSH密钥并将其添加到授权密钥列表中。
- en: 'First, let''s tackle this with SSH, as seen in the following:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们通过SSH来解决这个问题，如下所示：
- en: '[PRE1]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Now, let''s generate an SSH key by pressing *Enter* to accept all defaults:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过按*Enter*来生成一个SSH密钥以接受所有默认值：
- en: '[PRE2]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Now, let''s add the generated key (`/root/.ssh/id_rsa`) to the authorized keys:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们将生成的密钥（`/root/.ssh/id_rsa`）添加到授权密钥中：
- en: '[PRE3]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: To validate this, we can execute `ssh localhost date`, after which we will be
    able to get our current system's date and time without providing a password.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 为了验证这一点，我们可以执行`ssh localhost date`，之后我们将能够在不提供密码的情况下获取当前系统的日期和时间。
- en: 3\. Creating a user named 'user' that can connect to the machine without a password
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3. 创建一个名为'user'的用户，可以在没有密码的情况下连接到该机器
- en: 'This requires creating a user and an SSH key that is added in a similar fashion
    to the root user. The next options will also be relevant to a user, but for the
    purposes of this demonstration, we will tackle them as separate tasks:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这需要创建一个用户和一个类似于root用户的SSH密钥。接下来的选项也将与用户相关，但为了演示目的，我们将它们作为单独的任务来解决：
- en: '[PRE4]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Now, let''s generate an SSH key by pressing *Enter* to accept all defaults:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过按*Enter*来生成一个SSH密钥以接受所有默认值：
- en: '[PRE5]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Now, let''s add the generated key (`/root/.ssh/id_rsa`) to the authorized keys:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们将生成的密钥（`/root/.ssh/id_rsa`）添加到授权密钥中：
- en: '[PRE6]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: To validate this, we can execute `ssh localhost date`, and we will be able to
    get the current system date and time without providing a password.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 为了验证这一点，我们可以执行`ssh localhost date`，我们将能够在不提供密码的情况下获取当前系统日期和时间。
- en: Then, use `logout` to return to our `root` user.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用“logout”返回到我们的“root”用户。
- en: 4\. The user 'user' should change their password every week, with 2 days' warning
    and 1 day of usage once expired
  id: totrans-91
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4. 用户'user'应该每周更改密码，提前2天警告，过期后使用1天
- en: 'This requires us to tune the user restrictions, as follows:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 这要求我们调整用户限制，如下所示：
- en: '[PRE7]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 5\. The root user must be able to SSH as 'user' without a password, so that
    nobody can connect remotely as the root user using a password
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5. root用户必须能够以'user'的身份通过SSH登录，而无需密码，以便没有人可以使用密码远程连接为root用户
- en: 'This requires two steps. The first is to enable `user` with the root''s authorized
    key, and then tune the `sshd` daemon, as follows:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 这需要两个步骤。第一步是使用root的授权密钥启用'user'，然后调整`sshd`守护程序，如下所示：
- en: '[PRE8]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Edit the `/etc/sshd/sshd_config` file and add or replace the `PermitRootLogin`
    line so that it looks like the following:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑`/etc/sshd/sshd_config`文件，并添加或替换`PermitRootLogin`行，使其看起来像下面这样：
- en: '[PRE9]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Save and then restart the `sshd` daemon:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 保存，然后重新启动`sshd`守护程序：
- en: '[PRE10]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 6\. The user 'user' should be able to become root and execute commands without
    a password
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6. 用户'user'应能够成为root并执行命令而无需密码
- en: 'This means configuring the `/etc/sudoers` file by adding the following line:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着通过添加以下行来配置`/etc/sudoers`文件：
- en: '[PRE11]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 7\. When a user tries to log in over SSH, display a legal message about not
    allowing unauthorized access to this system
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 7. 当用户尝试通过SSH登录时，显示有关不允许未经授权访问此系统的法律消息
- en: Create a file, for example, `/etc/ssh/banner`, with the message to display.
    For example, `"Get out of here"`.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个文件，例如`/etc/ssh/banner`，其中包含要显示的消息。例如，`"Get out of here"`。
- en: Modify `/etc/ssh/sshd_config` and set the line banner with `/etc/ssh/banner`,
    then restart the `sshd` daemon with `systemctl restart sshd`.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 修改`/etc/ssh/sshd_config`并将`banner`行设置为`/etc/ssh/banner`，然后使用`systemctl restart
    sshd`重新启动`sshd`守护程序。
- en: 8\. SSH must listen on port 22222 instead of the default one
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8. SSH必须在端口22222上监听，而不是默认端口
- en: 'This is a tricky one. The first step is to alter `/etc/ssh/sshd_config` and
    define port `22222`. Once this is done, restart `sshd` with the following command:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个棘手的问题。第一步是修改`/etc/ssh/sshd_config`并定义端口`22222`。完成后，使用以下命令重新启动`sshd`：
- en: '[PRE12]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: This, of course, will fail... why?
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这当然会失败...为什么？
- en: 'The firewall must be configured:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 必须配置防火墙：
- en: '[PRE13]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'SELinux must then be configured:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 然后必须配置SELinux：
- en: '[PRE14]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Now, the `sshd` daemon can be restarted:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，`sshd`守护程序可以重新启动：
- en: '[PRE15]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 9\. Creating a group named 'devel'
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9. 创建名为'devel'的组
- en: 'Use the following command:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令：
- en: '[PRE16]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 10\. Making 'user' a member of 'devel'
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10. 使'user'成为'devel'的成员
- en: 'Use the following command:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令：
- en: '[PRE17]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 11\. Storing user membership in a file called 'userids,' in a home folder for
    'user'
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 11. 将用户成员身份存储在名为'userids'的文件中，在'用户'的主文件夹中
- en: 'Use the following command:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令：
- en: '[PRE18]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 12\. The user 'user' and root user should be able to connect to the localhost
    via SSH, without specifying the port, and default to compression for the connection
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12. 用户'user'和root用户应能够通过SSH连接到本地主机，而无需指定端口，并默认为连接进行压缩
- en: We altered the default SSH port to be `22222`.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我们修改了默认的SSH端口为`22222`。
- en: 'Create a file named `.ssh/config` for both `user` and root, with the following
    contents:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 为'user'和root创建一个名为`.ssh/config`的文件，内容如下：
- en: '[PRE19]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 13\. Finding all man page names in the system, and putting the names into a
    file named 'manpages.txt'
  id: totrans-130
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13. 查找系统中所有man页面名称，并将名称放入名为'manpages.txt'的文件中
- en: 'Man pages are stored in `/usr/share/man`. Therefore, use the following command:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 手册页存储在 `/usr/share/man`。因此，使用以下命令：
- en: '[PRE20]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 14\. Printing usernames for users without a login, so they can be permitted
    access to the system, and printing the user ID and groups for each user
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 14\. 打印没有登录的用户的用户名，以便他们可以被允许访问系统，并打印每个用户的用户 ID 和组
- en: 'The following command first builds a list of users in the system with the `nologin`
    shell:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令首先构建了一个使用 `nologin` shell 的系统用户列表：
- en: '[PRE21]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: From that list, check the membership in the `/etc/group` file, leaving only
    the group name, and using `xargs` to concatenate them into a string to be printed.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 从列表中检查 `/etc/group` 文件中的成员资格，仅保留组名，并使用 `xargs` 将它们连接成一个要打印的字符串。
- en: The above example makes use of `for` loops and inline execution of commands,
    via `$()`.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的示例使用了 `for` 循环和命令的内联执行，通过 `$()`。
- en: 15\. Monitoring available system resources every 5 minutes without using cron,
    and storing them as /root/resources.log
  id: totrans-138
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 15\. 每 5 分钟监视可用的系统资源，而不使用 cron，并将它们存储为 /root/resources.log
- en: 'The ideal way to monitor something would be cron, but as we''re told not to
    use it, this only leaves us with systemd timers. (You can check the files tested
    via the following link: [https://github.com/PacktPublishing/Red-Hat-Enterprise-Linux-8-Administration/tree/main/chapter-18-exercise1.](https://github.com/PacktPublishing/Red-Hat-Enterprise-Linux-8-Administration/tree/main/chapter-18-exercise1'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 监视某些东西的理想方式是使用 cron，但由于我们被告知不要使用它，这只留下了我们使用 systemd 定时器。 （您可以通过以下链接检查经过测试的文件：[https://github.com/PacktPublishing/Red-Hat-Enterprise-Linux-8-Administration/tree/main/chapter-18-exercise1.](https://github.com/PacktPublishing/Red-Hat-Enterprise-Linux-8-Administration/tree/main/chapter-18-exercise1
- en: )
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: ）
- en: 'Create `/etc/systemd/system/monitorresources.service` with the following contents:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 创建 `/etc/systemd/system/monitorresources.service`，内容如下：
- en: '[PRE22]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Create `/etc/systemd/system/monitorresources.timer` with the following contents:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 创建 `/etc/systemd/system/monitorresources.timer`，内容如下：
- en: '[PRE23]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Create `/root/myresources.sh` with the following contents:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 创建 `/root/myresources.sh`，内容如下：
- en: '[PRE24]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Enable the new timer, as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 启用新的定时器，如下所示：
- en: '[PRE25]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Does it work? If not, `journalctl –f` will give some details. SELinux prevents
    us from executing a root file, so let''s convert it into a binary type and mark
    it as executable, as shown in the following:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 它有效吗？如果不行，`journalctl –f` 将提供一些细节。SELinux 阻止我们执行 root 文件，所以让我们将其转换为二进制类型并标记为可执行，如下所示：
- en: '[PRE26]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 16\. Adding a per-minute job to report the available percentage of free disk
    space and storing it in /root/freespace.log, so that it shows the filesystem and
    free space
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 16\. 添加每分钟的作业，报告可用的空闲磁盘空间百分比，并将其存储在 /root/freespace.log 中，以显示文件系统和可用空间
- en: The `df` reports used disk space and available space, so we need to do some
    math.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '`df` 报告已使用的磁盘空间和可用空间，所以我们需要进行一些数学运算。'
- en: 'This will report the mounted location, size, used space, and available space,
    with `;` as a separator. Refer to the following:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 这将报告挂载位置、大小、已用空间和可用空间，使用 `;` 作为分隔符。参考以下内容：
- en: '[PRE27]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Bash allows us to do some math operations, but these lack fractional parts.
    Luckily, we can do a trick: we will be looping over it, as follows:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: Bash 允许我们进行一些数学运算，但这些运算缺少小数部分。幸运的是，我们可以做一个小技巧：我们将循环执行它，如下所示：
- en: '[PRE28]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The `for` loop will check all the available data, grab some specific fields,
    separate them with `;`, and then run the loop for each line, stored in the `$each`
    variable.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '`for` 循环将检查所有可用的数据，抓取一些特定字段，用 `;` 分隔它们，然后对每一行在 `$each` 变量中运行循环。'
- en: We cut the output and then get the fourth field. This is the available space.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我们截取输出，然后获取第四个字段。这是可用空间。
- en: We cut the output and then we get the second field. This is the total number
    of blocks.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们截取输出，然后获取第二个字段。这是总块数。
- en: As `bash` can do integer divisions, we can multiply by 100 and then divide to
    get the percentage and add a string as part of the output.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 `bash` 可以进行整数除法，我们可以乘以 100，然后除以获取百分比，并将一个字符串添加到输出中。
- en: Alternatively (but not as illustrative), we could have discounted to 100 the
    percentage of used already given by `df` and save some steps of the calculation.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 或者（但不够说明性），我们可以通过 `df` 已经给出的使用百分比减去 100，并节省一些计算步骤。
- en: We also need to store the output in a file. To do this, we can either wrap the
    whole loop in a redirection or add it in the `echo` line so that it appends to
    a file.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要将输出存储在一个文件中。为此，我们可以将整个循环包装在重定向中，或者将其添加到 `echo` 行中，以便将其附加到一个文件中。
- en: 'And we also need to do it via cron, so the full solution will be as follows:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要通过 cron 来完成，因此完整的解决方案如下：
- en: 'Create a `/root/myfreespace.sh` script with the following contents:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个 `/root/myfreespace.sh` 脚本，内容如下：
- en: '[PRE29]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Then, use `chmod 755 /root/myfreespace.sh` to make it executable.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用 `chmod 755 /root/myfreespace.sh` 使其可执行。
- en: 'Run `crontab -e` to edit root''s crontab, and add the following line:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 运行 `crontab -e` 来编辑 root 的 crontab，并添加以下行：
- en: '[PRE30]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 17\. Configuring the system to only leave 3 days of logs
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 17\. 配置系统只保留 3 天的日志
- en: 'This can be done by editing `/etc/logrorate.conf`, with the following settings:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以通过编辑 `/etc/logrorate.conf` 来完成，设置如下：
- en: '[PRE31]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Remove other occurrences of weekly, monthly, and so on, to leave only the one
    we want.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 删除其他的每周、每月等出现，只留下我们想要的一个。
- en: 18\. Configuring log rotation for /root/freespace.log and /root/resources.log
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18\. 为 /root/freespace.log 和 /root/resources.log 配置日志轮转
- en: 'Create a `/etc/logrotate.d/rotateroot` file, with the following contents:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个 `/etc/logrotate.d/rotateroot` 文件，内容如下：
- en: '[PRE32]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 19\. Configuring time synchronization against pool.ntp.org with fast sync
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 19\. 针对 pool.ntp.org 进行快速同步的时间同步配置
- en: 'Edit `/etc/chrony.conf` and add the following line:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑 `/etc/chrony.conf`，添加以下行：
- en: '[PRE33]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Then, run the following:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 然后运行以下命令：
- en: '[PRE34]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 20\. Providing NTP server services for subnet 172.22.0.1/24
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 20\. 为子网 172.22.0.1/24 提供 NTP 服务器服务
- en: 'Edit `/etc/chrony.conf`, by adding the following line:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑 `/etc/chrony.conf`，添加以下行：
- en: '[PRE35]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Then, run the following:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 然后运行以下命令：
- en: '[PRE36]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 21\. Configuring system stats collection every minute
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 21\. 每分钟配置系统统计收集
- en: 'Run the following command:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 运行以下命令：
- en: '[PRE37]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'We now need to modify `/usr/lib/systemd/system/sysstat-collect.timer`. Let''s
    do this by creating an override, as follows:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要修改`/usr/lib/systemd/system/sysstat-collect.timer`。让我们通过创建一个覆盖来做到这一点，如下所示：
- en: '[PRE38]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Edit `/etc/systemd/system/sysstat-collect.timer` by replacing the `OnCalendar`
    value so that it looks like the following:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑`/etc/systemd/system/sysstat-collect.timer`，将`OnCalendar`值替换为以下内容：
- en: '[PRE39]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Then, reload the units with the following command:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，使用以下命令重新加载单元：
- en: '[PRE40]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 22\. Configuring the password length in the system for users to be 12 characters
  id: totrans-195
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 22\. 配置系统中用户密码长度为12个字符
- en: 'Edit `/etc/login.defs` with the following line:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下行编辑`/etc/login.defs`：
- en: '[PRE41]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 23\. Creating a bot user called 'privacy,' which keeps its files only visible
    to itself by default
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 23\. 创建一个名为'privacy'的机器人用户，它默认情况下只能自己看到它的文件
- en: 'To do this, run the following:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 要做到这一点，请运行以下命令：
- en: '[PRE42]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: This resolution uses `umask` to remove permissions from others on all newly
    created files.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 此解决方案使用`umask`从所有新创建的文件中删除其他人的权限。
- en: 24\. Creating a folder named /shared that can be accessed by all users, and
    defaults new files and directories to still be accessible to users of the 'devel'
    group
  id: totrans-202
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 24\. 创建一个名为/shared的文件夹，所有用户都可以访问，并将新文件和目录默认设置为仍然可以被‘devel’组的用户访问
- en: 'To do this, run the following:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 要做到这一点，请运行以下命令：
- en: '[PRE43]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '25\. Configuring a network connection with IPv4 and IPv6 addressing named ''mynic,''
    using the provided data Ip6, as follows: 2001:db8:0:1::c000:207/64 g gateway 2001:db8:0:1::1
    IPv4 192.0.1.3/24 gateway 192.0.1.1'
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 25\. 使用提供的数据Ip6，配置一个名为'mynic'的具有IPv4和IPv6地址的网络连接，如下所示：2001:db8:0:1::c000:207/64
    g gateway 2001:db8:0:1::1 IPv4 192.0.1.3/24 gateway 192.0.1.1
- en: 'See the following for how to accomplish this:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下内容以了解如何完成此操作：
- en: '[PRE44]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 26\. Allowing the host to use a google hostname to reach www.google.com, and
    a redhat hostname to reach www.redhat.com
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 26\. 允许主机使用google主机名访问www.google.com，使用redhat主机名访问www.redhat.com
- en: 'Run and record the IPs obtained, as shown here:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 运行并记录获取的IP，如下所示：
- en: '[PRE45]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Note down the IPs obtained above.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 记下上面获取的IP。
- en: 'Edit `/etc/hosts` by adding the following:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 通过添加以下内容编辑`/etc/hosts`：
- en: '[PRE46]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Then, save and exit.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，保存并退出。
- en: 27\. Reporting the files modified from those that the vendor distributed, and
    storing them in /root/altered.txt
  id: totrans-215
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 27\. 报告从供应商分发的文件中修改的文件，并将它们存储在`/root/altered.txt`中
- en: 'See the following for how to accomplish this:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下内容以了解如何完成此操作：
- en: '[PRE47]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 28\. Making our system installation media packages available via HTTP under
    the path /mirror for other systems to use it as the mirror, and configuring the
    repository in our system. Removing the kernel packages from that mirror so that
    other systems (even ours) can't find new kernels. Ignoring the glibc packages
    from this repo to be installed without removing them
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 28\. 通过HTTP在路径`/mirror`下使我们的系统安装媒体包对其他系统可用，并在我们的系统中配置存储库。从该镜像中删除内核软件包，以便其他系统（甚至我们自己）无法找到新的内核。忽略此存储库中的glibc软件包，以便安装而不删除它们
- en: This is a complex one, so let's examine it step by step.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个复杂的问题，所以让我们一步一步地来看看。
- en: 'Install `http` and enable it using the following:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 安装`http`并使用以下命令启用它：
- en: '[PRE48]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Create a folder under `/mirror`, then copy the source media packages and make
    them available over `http`:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在`/mirror`下创建一个文件夹，然后复制源媒体包并通过`http`使其可用：
- en: '[PRE49]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'Remove the kernel packages:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 删除内核软件包：
- en: '[PRE50]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Create repository file metadata by using the following commands:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令创建存储库文件元数据：
- en: '[PRE51]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: Create a repository file using the repository we created, and set it up on the
    system, ignoring the `glibc*` packages from it.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 使用我们创建的存储库文件，并在系统上设置它，忽略其中的`glibc*`软件包。
- en: 'Edit `/etc/yum.repos.d/mymirror.repo` by adding the following contents:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 通过添加以下内容编辑`/etc/yum.repos.d/mymirror.repo`：
- en: '[PRE52]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 29\. As 'user,' make a copy of the /root folder in the /home/user/root/ folder,
    and keep it in sync every day, synchronizing additions and deletions
  id: totrans-231
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 29\. 作为‘user’，将/root文件夹复制到/home/user/root/文件夹中，并每天保持同步，同步添加和删除
- en: 'See the following for how to accomplish this:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下内容以了解如何完成此操作：
- en: '[PRE53]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'Edit crontab and add the following line:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑crontab并添加以下行：
- en: '[PRE54]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 30\. Checking whether our system conforms to the PCI-DSS standard
  id: totrans-236
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 30\. 检查我们的系统是否符合PCI-DSS标准
- en: '[PRE55]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 31\. Adding a second hard drive of 30 GB to the system, but using only 15 GB
    to move the mirror to it, making it available at boot using compression and deduplication,
    and available under /mirror/mirror
  id: totrans-238
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 31\. 向系统添加一个30GB的第二硬盘，但只使用15GB将镜像移动到其中，并使用压缩和去重功能在启动时使其可用，并在`/mirror/mirror`下可用
- en: Compression and deduplication in this sentence mean VDO. We need to move the
    mirror we currently have to it and make the old mirror we had go there instead.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 这句话中的压缩和去重意味着VDO。我们需要将当前的镜像移动到VDO，并使我们以前的镜像移到那里。
- en: 'If we have the installation media, we can choose to copy it over and repeat
    the kernel removal or transfer. To do so, first let''s create the VDO volume in
    a partition in our new hard drive (`sdb`):'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们有安装媒体，我们可以选择复制它并重复内核删除或转移。为此，首先让我们在新的硬盘（`sdb`）的分区中创建VDO卷：
- en: '[PRE56]'
  id: totrans-241
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'This will create a partition of 15 GB from the start. Let''s create a VDO volume
    on it, by using the following command:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 这将从开始创建一个15GB的分区。让我们使用以下命令在其上创建一个VDO卷：
- en: '[PRE57]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: 'At this point, the old mirror was copied into a `mirror` folder on the VDO
    volume. This is mounted under `/mirror`, hence it has the original mirror under
    `/mirror/mirror` as requested. We might need to perform the following:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，旧的镜像已复制到VDO卷上的`mirror`文件夹中。这在`/mirror`下挂载，因此它在`/mirror/mirror`下有原始镜像，如要求的。我们可能需要执行以下操作：
- en: Bind mount `/mirror` to `/var/www/html/mirror/` to make the file available.
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将`/mirror`绑定到`/var/www/html/mirror/`以使文件可用。
- en: Restore SELinux context to allow the `httpd` daemon to access to files in `/var/www/html/mirror/`.
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 恢复SELinux上下文以允许`httpd`守护程序访问`/var/www/html/mirror/`中的文件。
- en: Adjust the repofile we created to point to the new path.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 调整我们创建的repofile以指向新路径。
- en: 32\. Configuring the filesystem to report at least 1,500 GB in size, to be used
    by our mirrors
  id: totrans-248
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 32\. 配置文件系统报告至少1,500GB的大小，供我们的镜像使用
- en: 'See the following command:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 查看以下命令：
- en: '[PRE58]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 33\. Creating a second copy of the mirror under /mirror/mytailormirror and removing
    all packages starting with k*
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 33. 在/mirror/mytailormirror下创建镜像的第二个副本，并删除所有以k*开头的软件包
- en: 'See the following for how to accomplish this:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下内容如何完成此操作：
- en: '[PRE59]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 34\. Creating a new volume in the remaining space (15 GB) of the hard drive
    and using it to extend the root filesystem
  id: totrans-254
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 34. 在硬盘的剩余空间（15 GB）中创建一个新的卷，并用它来扩展根文件系统
- en: 'See the following for how to accomplish this:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下内容如何完成此操作：
- en: '[PRE60]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 35\. Creating a boot entry that allows us to boot into emergency mode in order
    to change the root password
  id: totrans-257
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 35. 创建一个引导项，允许我们进入紧急模式以更改根密码
- en: 'See the following for how to accomplish this:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下内容如何完成此操作：
- en: '[PRE61]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: 36\. Creating a custom tuning profile that defines the readahead to be 4096
    for the first drive and 1024 for the second drive – this profile should also crash
    the system should an OOM event occur
  id: totrans-260
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 36. 创建一个自定义调整配置文件，定义第一个驱动器的预读取为4096，第二个驱动器的预读取为1024 - 此配置文件还应在发生OOM事件时使系统崩溃
- en: 'Refer to the following command:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 参考以下命令：
- en: '[PRE62]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'Edit the `/etc/tuned/myprofile/tuned.conf` file by adding the following contents:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑`/etc/tuned/myprofile/tuned.conf`文件，添加以下内容：
- en: '[PRE63]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: 37\. Disabling and removing the installed httpd package, and setting up the
    httpd server using the registry.redhat.io/rhel8/httpd-24 image
  id: totrans-265
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 37. 禁用并删除已安装的httpd软件包，并使用registry.redhat.io/rhel8/httpd-24镜像设置httpd服务器
- en: 'See the following for how to accomplish this:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下内容如何完成此操作：
- en: '[PRE64]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
