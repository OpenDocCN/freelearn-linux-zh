["```\nSep 29 20:44:33 localhost sudo: donnie : TTY=pts/0 ; PWD=/home/donnie ; USER=root ; COMMAND=/bin/su -\nSep 29 20:44:34 localhost su: pam_unix(su-l:session): session opened for user root by donnie(uid=0)\nSep 29 20:50:39 localhost su: pam_unix(su-l:session): session closed for user root\n```", "```\nSep 29 20:50:45 localhost sudo: donnie : TTY=pts/0 ; PWD=/home/donnie ; USER=root ; COMMAND=/bin/less /var/log/secure\nSep 29 20:55:30 localhost sudo: donnie : TTY=pts/0 ; PWD=/home/donnie ; USER=root ; COMMAND=/sbin/fdisk -l\nSep 29 20:55:40 localhost sudo: donnie : TTY=pts/0 ; PWD=/home/donnie ; USER=root ; COMMAND=/bin/yum upgrade\nSep 29 20:59:35 localhost sudo: donnie : TTY=tty1 ; PWD=/home/donnie ; USER=root ; COMMAND=/bin/systemctl status sshd\nSep 29 21:01:11 localhost sudo: donnie : TTY=tty1 ; PWD=/home/donnie ; USER=root ; COMMAND=/bin/less /var/log/secure\n```", "```\n[donnie@localhost ~]$ groups\ndonnie wheel\n[donnie@localhost ~]$\n```", "```\n## Allows people in group wheel to run all commands\n%wheel ALL=(ALL) ALL\n```", "```\n## Same thing without a password\n# %wheel ALL=(ALL) NOPASSWD: ALL\n```", "```\nsudo usermod -a -G wheel maggie\n```", "```\nsudo useradd -G wheel frank\n```", "```\n# User_Alias ADMINS = jsmith, mikem\n```", "```\nADMINS ALL=(ALL) ALL\n```", "```\nfrank ALL=(ALL) ALL\n```", "```\nsudo visudo\n```", "```\nUser_Alias SOFTWAREADMINS = vicky, cleopatra\n```", "```\nCmnd_Alias SOFTWARE = /bin/rpm, /usr/bin/up2date, /usr/bin/yum\n```", "```\nSOFTWAREADMINS ALL=(ALL) SOFTWARE\n```", "```\nCmnd_Alias SERVICES = /sbin/service, /sbin/chkconfig, /usr/bin/systemctl start, /usr/bin/systemctl stop, /usr/bin/systemctl reload, /usr/bin/systemctl restart, /usr/bin/systemctl status, /usr/bin/systemctl enable, /usr/bin/systemctl disable\n```", "```\nsudo yum upgrade\n```", "```\nUser_Alias SERVICESADMINS = charlie, lionel\nSERVICESADMINS ALL=(ALL) SERVICES\n```", "```\n[lionel@centos-7 ~]$ sudo systemctl status sshd\n[sudo] password for lionel:\nSorry, user lionel is not allowed to execute '/bin/systemctl status sshd' as root on centos-7.xyzwidgets.com.\n[lionel@centos-7 ~]$\n```", "```\nCmnd_Alias SERVICES = /sbin/service, /sbin/chkconfig, /usr/bin/systemctl\n```", "```\nCmnd_Alias SERVICES = /sbin/service, /sbin/chkconfig, /usr/bin/systemctl start *, /usr/bin/systemctl stop *, /usr/bin/systemctl reload *, /usr/bin/systemctl restart *, /usr/bin/systemctl status *, /usr/bin/systemctl enable *, /usr/bin/systemctl disable *\n```", "```\n[lionel@centos-7 ~]$ sudo systemctl status sshd\n[sudo] password for lionel:\n\u25cf sshd.service - OpenSSH server daemon\n Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: enabled)\n Active: active (running) since Sat 2017-09-30 18:11:22 EDT; 23min ago\n Docs: man:sshd(8)\n man:sshd_config(5)\n Main PID: 13567 (sshd)\n CGroup: /system.slice/sshd.service\n \u2514\u250013567 /usr/sbin/sshd -D\n\nSep 30 18:11:22 centos-7.xyzwidgets.com systemd[1]: Starting OpenSSH server daemon...\nSep 30 18:11:22 centos-7.xyzwidgets.com sshd[13567]: Server listening on 0.0.0.0 port 22.\nSep 30 18:11:22 centos-7.xyzwidgets.com sshd[13567]: Server listening on :: port 22.\nSep 30 18:11:22 centos-7.xyzwidgets.com systemd[1]: Started OpenSSH server daemon.\n[lionel@centos-7 ~]$\n```", "```\nkatelyn ALL=(ALL) STORAGE\ngunther ALL=(ALL) /sbin/fdisk -l\n%backup_admins ALL=(ALL) BACKUP\n```", "```\n# Host_Alias     FILESERVERS = fs1, fs2\n# Host_Alias     MAILSERVERS = smtp, smtp2\n```", "```\nHost_Alias    WEBSERVERS = webserver1, webserver2\nUser_Alias    WEBADMINS = junior, kayla\nCmnd_Alias    WEBCOMMANDS = /usr/bin/systemctl status httpd, /usr/bin/systemctl start httpd, /usr/bin/systemctl stop httpd, /usr/bin/systemctl restart httpd\n\nWEBADMINS    WEBSERVERS=(ALL) WEBCOMMANDS\n```", "```\n sudo useradd lionel\n sudo ueradd katelyn\n sudo useradd maggie\n sudo passwd lionel\n sudo passwd katelyn\n sudo passwd maggie\n```", "```\n        sudo visudo\n```", "```\n        lionel     ALL=(ALL)    ALL\n        katelyn  ALL=(ALL) /usr/bin/systemctl status sshd\n        maggie  ALL=(ALL) STORAGE\n```", "```\n su - lionel\n sudo su -\n exit\n sudo systemctl status sshd\n sudo fdisk -l\n exit\n```", "```\n su - katelyn\n sudo su -\n sudo systemctl status sshd\n sudo systemctl restart sshd\n sudo fdisk -l\n exit\n```", "```\n sudo fdisk -l\n sudo systemctl status sshd\n sudo iptables -L\n```", "```\n        sudo visudo\n```", "```\n        Defaults     timestamp_timeout = 0\n```", "```\n        Defaults:lionel     timestamp_timeout = 0\n```", "```\nmaggie     ALL=(ALL)     /bin/bash, /bin/zsh\n```", "```\n# useradd defaults file\nGROUP=100\nHOME=/home\nINACTIVE=-1\nEXPIRE=\nSHELL=/bin/bash\nSKEL=/etc/skel\nCREATE_MAIL_SPOOL=yes\n\n~\n~\n:!ls\n```", "```\n[donnie@localhost default]$ sudo vim useradd\n[sudo] password for donnie:\n\ngrub nss useradd\n\nPress ENTER or type command to continue\ngrub nss useradd\n\nPress ENTER or type command to continue\n```", "```\nfrank     ALL=(ALL)     /bin/vim /etc/ssh/sshd_config\n```", "```\nfrank     ALL=(ALL)     sudoedit /etc/ssh/sshd_config\n```", "```\nsylvester     ALL=(ALL) /usr/bin/systemctl\n```", "```\nsylvester     ALL=(ALL) /usr/bin/systemctl * sshd\n```", "```\nsylvester     ALL=(ALL) /usr/bin/systemctl status sshd, /usr/bin/systemctl restart sshd\n```", "```\nsylvester     ALL=(ALL) /usr/bin/systemctl status sshd, /usr/bin/systemctl restart sshd\n```", "```\nsylvester     ALL=(root) /usr/bin/systemctl status sshd, /usr/bin/systemctl restart sshd\n```", "```\nvicky    ALL=(database)    /usr/local/sbin/some_database_script.sh\n```", "```\nsudo -u database some_database_script.sh\n```", "```\n[donnie@localhost home]$ sudo useradd charlie\n[sudo] password for donnie:\n[donnie@localhost home]$\n\n[donnie@localhost home]$ ls -l\ntotal 0\ndrwx------. 2 charlie charlie 59 Oct 1 15:25 charlie\ndrwx------. 2 donnie donnie 79 Sep 27 00:24 donnie\ndrwx------. 2 frank frank 59 Oct 1 15:25 frank\n[donnie@localhost home]$\n```", "```\nCREATE_HOME     yes\nUMASK 077\n```", "```\nsudo useradd -m -d /home/frank -s /bin/bash frank\n```", "```\ndonnie@packt:/home$ ls -l\ntotal 8\ndrwxr-xr-x 3 donnie donnie 4096 Oct 2 00:23 donnie\ndrwxr-xr-x 2 frank frank 4096 Oct 1 23:58 frank\ndonnie@packt:/home$\n```", "```\ncd /home\nsudo chmod 700 *\n```", "```\ndonnie@packt:/home$ ls -l\ntotal 8\ndrwx------ 3 donnie donnie 4096 Oct 2 00:23 donnie\ndrwx------ 2 frank frank 4096 Oct 1 23:58 frank\ndonnie@packt:/home$\n```", "```\nUMASK     022\n```", "```\nUMASK     077\n```", "```\nsudo apt install ecryptfs-utils\n\ndonnie@ubuntu-steemnode:~$ sudo adduser --encrypt-home cleopatra\n[sudo] password for donnie:\nAdding user `cleopatra' ...\nAdding new group `cleopatra' (1004) ...\nAdding new user `cleopatra' (1004) with group `cleopatra' ...\nCreating home directory `/home/cleopatra' ...\nSetting up encryption ...\n\n************************************************************************\nYOU SHOULD RECORD YOUR MOUNT PASSPHRASE AND STORE IT IN A SAFE LOCATION.\n ecryptfs-unwrap-passphrase ~/.ecryptfs/wrapped-passphrase\nTHIS WILL BE REQUIRED IF YOU NEED TO RECOVER YOUR DATA AT A LATER TIME.\n************************************************************************\n\nDone configuring.\n\nCopying files from `/etc/skel' ...\nEnter new UNIX password:\nRetype new UNIX password:\npasswd: password updated successfully\nChanging the user information for cleopatra\nEnter the new value, or press ENTER for the default\n Full Name []: Cleopatra Tabby Cat\n Room Number []: 1\n Work Phone []: 555-5556\n Home Phone []: 555-5555\n Other []:\nIs the information correct? [Y/n] Y\ndonnie@ubuntu-steemnode:~$\n```", "```\ncleopatra@ubuntu-steemnode:~$ ecryptfs-unwrap-passphrase\nPassphrase:\nd2a6cf0c3e7e46fd856286c74ab7a412\ncleopatra@ubuntu-steemnode:~$\n```", "```\n        DIR_MODE=0755\n```", "```\n        DIR_MODE=0700\n```", "```\n        sudo apt install ecryptfs-utils\n```", "```\n sudo adduser --encrypt-home cleopatra\n ls -l /home\n```", "```\n su - cleopatra\n ecryptfs-unwrap-passphrase\n exit\n```", "```\n[donnie@localhost pam.d]$ grep 'pwquality' *\npassword-auth:password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=\npassword-auth-ac:password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=\nsystem-auth:password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=\nsystem-auth-ac:password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=\n[donnie@localhost pam.d]$\n```", "```\nsudo apt install libpam-pwquality\n```", "```\ndonnie@packt:/etc/pam.d$ grep 'pwquality' *\ncommon-password:password        requisite                       pam_pwquality.so retry=3\ndonnie@packt:/etc/pam.d$\n```", "```\n# Minimum acceptable size for the new password (plus one if\n# credits are not disabled which is the default). (See pam_cracklib manual.)\n# Cannot be set to lower value than 6.\n# minlen = 8\n```", "```\nminlen = 19\n\n[donnie@localhost ~]$ sudo passwd katelyn\nChanging password for user katelyn.\nNew password:\nBAD PASSWORD: The password is shorter than 18 characters\nRetype new password:\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo passwd katelyn\nChanging password for user katelyn.\nNew password:\nBAD PASSWORD: The password is shorter than 17 characters\nRetype new password:\n[donnie@localhost ~]$\n```", "```\n# lcredit = 1\n```", "```\nlcredit = 0\n```", "```\n[donnie@localhost ~]$ sudo passwd katelyn\nChanging password for user katelyn.\nNew password:\nBAD PASSWORD: The password is shorter than 19 characters\nRetype new password:\n[donnie@localhost ~]$\n```", "```\ndcredit = -3\n```", "```\n# minclass = 3\n```", "```\n        sudo apt install libpam-pwquality\n```", "```\n        minlen = 19\n```", "```\n        minclass = 3\n        maxclassrepeat = 5\n```", "```\ndonnie@packt:~$ chage -l donnie\n[sudo] password for donnie:\nLast password change : Oct 03, 2017\nPassword expires : never\nPassword inactive : never\nAccount expires : never\nMinimum number of days between password change : 0\nMaximum number of days between password change : 99999\nNumber of days of warning before password expires : 7\ndonnie@packt:~$\n```", "```\nPASS_MAX_DAYS 99999\nPASS_MIN_DAYS 0\nPASS_WARN_AGE 7\n```", "```\n# useradd defaults file\nGROUP=100\nHOME=/home\nINACTIVE=-1\nEXPIRE=\nSHELL=/bin/bash\nSKEL=/etc/skel\nCREATE_MAIL_SPOOL=yes\n```", "```\nsudo useradd -D -e 2019-12-31\n```", "```\n[donnie@localhost ~]$ sudo useradd -D\nGROUP=100\nHOME=/home\nINACTIVE=-1\nEXPIRE=2019-12-31\nSHELL=/bin/bash\nSKEL=/etc/skel\nCREATE_MAIL_SPOOL=yes\n[donnie@localhost ~]$\n```", "```\nsudo useradd -D -f 5\nsudo useradd -D -s /bin/zsh\n\n[donnie@localhost ~]$ sudo useradd -D\nGROUP=100\nHOME=/home\nINACTIVE=5\nEXPIRE=2019-12-31\nSHELL=/bin/zsh\nSKEL=/etc/skel\nCREATE_MAIL_SPOOL=yes\n[donnie@localhost ~]$\n```", "```\nsudo useradd -e 2020-12-31 charlie\n```", "```\nsudo useradd -m -d /home/charlie -s /bin/bash -e 2020-12-31 charlie\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo chage -l charlie\nLast password change : Oct 06, 2017\nPassword expires : never\nPassword inactive : never\nAccount expires : Dec 31, 2020\nMinimum number of days between password change : 0\nMaximum number of days between password change : 99999\nNumber of days of warning before password expires : 7\ndonnie@ubuntu-steemnode:~$\n```", "```\nsudo usermod -e 2021-01-31 charlie\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo chage -l charlie\nLast password change : Oct 06, 2017\nPassword expires : never\nPassword inactive : never\nAccount expires : Jan 31, 2021\nMinimum number of days between password change : 0\nMaximum number of days between password change : 99999\nNumber of days of warning before password expires : 7\ndonnie@ubuntu-steemnode:~$\n```", "```\nsudo usermod -f 5 charlie\n```", "```\nsudo chage -E 2021-02-28 -I 4 -m 3 -M 90 -W 4 charlie\n\ndonnie@ubuntu-steemnode:~$ sudo chage -l charlie\nLast password change : Oct 06, 2017\nPassword expires : Jan 04, 2018\nPassword inactive : Jan 08, 2018\nAccount expires : Feb 28, 2021\nMinimum number of days between password change : 3\nMaximum number of days between password change : 90\nNumber of days of warning before password expires : 4\ndonnie@ubuntu-steemnode:~$\n```", "```\n\nsudo chage -d 0 samson\n\nor\n\nsudo passwd -e samson\n\ndonnie@ubuntu-steemnode:~$ sudo chage -l samson\nLast password change                    : password must be changed\nPassword expires                        : password must be changed\nPassword inactive                       : password must be changed\nAccount expires                         : never\nMinimum number of days between password change        : 0\nMaximum number of days between password change        : 99999\nNumber of days of warning before password expires    : 7\ndonnie@ubuntu-steemnode:~$\n```", "```\n sudo useradd -e 2023-06-30 samson\n sudo chage -l samson\n```", "```\n sudo useradd -m -d /home/samson -s /bin/bash -e 2023-06-30\n sudo chage -l samson\n```", "```\n sudo usermod -e 2023-07-31\n sudo chage -l samson\n```", "```\n sudo passwd samson\n sudo passwd -e samson\n sudo chage -l samson\n su - samson\n exit\n```", "```\n        sudo chage -m 5 -M 90 -I 2 -W 5 samson\n sudo chage -l samson\n```", "```\nEXAMPLES\n       Add the following line to /etc/pam.d/login to lock the account after 4 failed logins. Root account will be locked as well. The accounts will be automatically unlocked after 20 minutes. The module does not have to be called in the account phase because the login calls pam_setcred(3) correctly.\n\n           auth required pam_securetty.so\n           auth required pam_tally2.so deny=4 even_deny_root unlock_time=1200\n           auth required pam_env.so\n           auth required pam_unix.so\n           auth required pam_nologin.so\n           account required pam_unix.so\n           password required pam_unix.so\n           session required pam_limits.so\n           session required pam_unix.so\n           session required pam_lastlog.so nowtmp\n           session optional pam_mail.so standard\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo pam_tally2\nLogin Failures Latest failure From\ncharlie 5 10/07/17 16:38:19\ndonnie@ubuntu-steemnode:~$ sudo pam_tally2 --user=charlie --reset\nLogin Failures Latest failure From\ncharlie 5 10/07/17 16:38:19\ndonnie@ubuntu-steemnode:~$ sudo pam_tally2\ndonnie@ubuntu-steemnode:~$\n```", "```\n        auth required pam_tally2.so deny=4 \n        even_deny_root unlock_time=1200\n```", "```\n        sudo pam_tally2\n```", "```\n        sudo pam_tally2 --user=samson --reset\n sudo pam_tally2\n```", "```\nsudo usermod -L katelyn\n```", "```\nkatelyn:!$6$uA5ecH1A$MZ6q5U.cyY2SRSJezV000AudP.ckXXndBNsXUdMI1vPO8aFmlLXcbGV25K5HSSaCv4RlDilwzlXq/hKvXRkpB/:17446:0:99999:7:::\n```", "```\nsudo usermod -U katelyn\n```", "```\nsudo passwd -l katelyn\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo passwd -l katelyn\n[sudo] password for donnie:\npasswd: password expiry information changed.\ndonnie@ubuntu-steemnode:~$\n```", "```\n[donnie@localhost ~]$ sudo passwd -l katelyn\nLocking password for user katelyn.\npasswd: Success\n[donnie@localhost ~]$\n```", "```\nsudo passwd -u katelyn\n```", "```\nsudo passwd -l root\n```", "```\nmaggie@192.168.0.100's password:\nLast login: Sat Oct 7 20:51:09 2017\nWarning: Authorized Users Only!\n\nAll others will be prosecuted.\n[maggie@localhost ~]$\n```", "```\nUbuntu 16.04.3 LTS \\n \\l\n```", "```\n\\S\nKernel \\r on an \\m\n```"]