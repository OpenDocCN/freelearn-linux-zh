["```\n# virsh memtune <virtual_machine> --parameter size parameter\n```", "```\n--hard-limit\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The maximum memory the guest can use.\n--soft-limit\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0The memory limit to enforce during memory contention.\n--swap-hard-limit\u00a0\u00a0The maximum memory plus swap the guest can use.\u00a0\u00a0This has to be more than hard-limit value provided. \n--min-guarantee\u00a0\u00a0\u00a0\u00a0The guaranteed minimum memory allocation for the guest.\n```", "```\n<domain>\u00a0\u00a0\u00a0\u00a0\u00a0...\n\u00a0\u00a0<memoryBacking>\n\u00a0\u00a0\u00a0\u00a0<hugepages>\n\u00a0\u00a0\u00a0\u00a0<page size=\"1\" unit=\"G\" nodeset=\"0-3,5\"/>\n\u00a0\u00a0\u00a0\u00a0<page size=\"2\" unit=\"M\" nodeset=\"4\"/>\n\u00a0\u00a0\u00a0\u00a0</hugepages>\n\u00a0\u00a0\u00a0\u00a0<nosharepages/>\n\u00a0\u00a0\u00a0\u00a0<locked/>\n</memoryBacking>\u00a0\u00a0\u00a0\u00a0\u00a0...\n\u00a0\u00a0</domain>\n```", "```\n<memoryBacking>\n\u00a0\u00a0\u00a0\u00a0<locked/>\n</memoryBacking>\n```", "```\n<memoryBacking>\n\u00a0\u00a0\u00a0\u00a0<nosharepages/>\n</memoryBacking>\n```", "```\n<memoryBacking>\n</hugepages>\n</memoryBacking>\n```", "```\n# cat/sys/kernel/mm/transparent_hugepage/enabled [always] madvise never\n```", "```\necho always >/sys/kernel/mm/transparent_hugepage/enabled\necho madvise >/sys/kernel/mm/transparent_hugepage/enabled\necho never >/sys/kernel/mm/transparent_hugepage/enabled \n```", "```\n    #\u00a0\u00a0cat /proc/sys/vm/nr_hugepages\n    0\n    ```", "```\n    # echo 2000 > /proc/sys/vm/nr_hugepages\n    ```", "```\n    <value> parameter will depend on the configuration we want to do. If we want to configure everything according to our 2048*2 MB example, <value> would be 4,194,304 (or 4096*1024).\n    ```", "```\n    # sysctl -w vm.nr_hugepages=<number of hugepages>\n    ```", "```\n     # mount -t hugetlbfs hugetlbfs /dev/hugepages\n    ```", "```\n<memoryBacking>\n</hugepages>\n</ memoryBacking> \n```", "```\n# systemctl poweroff\n```", "```\n# systemctl reboot\n```", "```\n# man 2 madvise\nMADV_MERGEABLE (since Linux 2.6.32)\nEnable Kernel Samepage Merging (KSM) for the pages in the range specified by addr and length. The kernel regularly scans those areas of user memory that have been marked as mergeable, looking for pages with identical content.\u00a0\u00a0These are replaced by a single write-protected page (that is automatically copied if a process later wants to update the content of the page).\u00a0\u00a0KSM merges only private anonymous pages (see mmap(2)).\nThe KSM feature is intended for applications that generate many instances of the same data (e.g., virtualization systems such as KVM).\u00a0\u00a0It can consume a lot of processing\u00a0\u00a0\u00a0power; use with care.\u00a0\u00a0See the Linux kernel source file Documentation/ vm/ksm.txt for more details.\nThe MADV_MERGEABLE and MADV_UNMERGEABLE operations are available only if the kernel was configured with CONFIG_KSM.\n```", "```\n# virsh node-memory-tune --shm-pages-to-scan number\n```", "```\n# systemctl start ksm\n```", "```\ncat /sys/kernel/mm/ksm/*\n```", "```\n# Configuration file for ksmtuned.\n# How long ksmtuned should sleep between tuning adjustments\n# KSM_MONITOR_INTERVAL=60\n# Millisecond sleep between ksm scans for 16Gb server.\n# Smaller servers sleep more, bigger sleep less.\n# KSM_SLEEP_MSEC=10\n# KSM_NPAGES_BOOST - is added to the `npages` value, when `free memory` is less than `thres`. \n# KSM_NPAGES_BOOST=300\n# KSM_NPAGES_DECAY - is the value given is subtracted to the `npages` value, when `free memory` is greater than `thres`. \n# KSM_NPAGES_DECAY=-50\n# KSM_NPAGES_MIN - is the lower limit for the `npages` value.\n# KSM_NPAGES_MIN=64\n# KSM_NPAGES_MAX - is the upper limit for the `npages` value.\n# KSM_NPAGES_MAX=1250\n# KSM_THRES_COEF - is the RAM percentage to be calculated in parameter `thres`.\n# KSM_THRES_COEF=20\n# KSM_THRES_CONST - If this is a low memory system, and the `thres` value is less than `KSM_THRES_CONST`, then reset `thres` value to `KSM_THRES_CONST` value.\n# KSM_THRES_CONST=2048\n```", "```\n# systemctl stop ksm\n# systemctl stop ksmtuned\n```", "```\n<domain>\u00a0\u00a0\u00a0...\n\u00a0\u00a0\u00a0\u00a0<numatune>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<memory mode=\"strict\" nodeset=\"1-4,^3\"/>\n\u00a0\u00a0\u00a0\u00a0</numatune>\u00a0\u00a0\u00a0...\n</domain>\n```", "```\n<domain>\n \u2026\n\u00a0\u00a0<numatune>\n\u00a0\u00a0\u00a0\u00a0<memory mode=\"strict\" nodeset=\"1-4,^3\"/>\n\u00a0\u00a0\u00a0\u00a0<memnode cellid=\"0\" mode=\"strict\" nodeset=\"1\"/>\n\u00a0\u00a0\u00a0\u00a0<memnode cellid=\"2\" mode=\"preferred\" nodeset=\"2\"/>\n\u00a0\u00a0</numatune>\u00a0\u00a0\u00a0...\n</domain>\n```", "```\n<domain>\u00a0\u00a0\u00a0...\n\u00a0\u00a0\u00a0\u00a0<cputune>\u00a0\u00a0\u00a0\u00a0\u00a0\u2026..\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<emulatorpin cpuset=\"1-3\"/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u2026..\n\u00a0\u00a0\u00a0\u00a0</cputune>\u00a0\u00a0\u00a0...\n</domain>\n```", "```\n\u00a0\u00a0<cpu>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0...\n\u00a0\u00a0\u00a0\u00a0<numa>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<cell id='0' cpus='0-3' memory='512000' unit='KiB'/>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<cell id='1' cpus='4-7' memory='512000' unit='KiB' />\u00a0\u00a0\u00a0\u00a0\u00a0</numa>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0...\n</cpu>\n```", "```\n<memoryBacking>\n\u00a0\u00a0\u00a0\u00a0<hugepages>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<page size=\"1\" unit=\"G\" nodeset=\"0-2,4\"/>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<page size=\"4\" unit=\"M\" nodeset=\"3\"/>\n\u00a0\u00a0\u00a0\u00a0</hugepages>\n</memoryBacking>\n```", "```\n#\u00a0\u00a0cat /sys/kernel/mm/ksm/merge_across_nodes\n1\n```", "```\n#\u00a0\u00a0cat /sys/kernel/debug/sched_features\nGENTLE_FAIR_SLEEPERS START_DEBIT NO_NEXT_BUDDY LAST_BUDDY CACHE_HOT_BUDDY \nWAKEUP_PREEMPTION ARCH_POWER NO_HRTICK NO_DOUBLE_TICK LB_BIAS NONTASK_\nPOWER TTWU_QUEUE NO_FORCE_SD_OVERLAP RT_RUNTIME_SHARE NO_LB_MIN NUMA \nNUMA_FAVOUR_HIGHER NO_NUMA_RESIST_LOWER\n```", "```\n#\u00a0\u00a0cat /proc/sys/kernel/numa_balancing\n1\n```", "```\n# echo 0 > /proc/sys/kernel/numa_balancing\n```", "```\n# cat /sys/kernel/debug/sched_features\n```", "```\n# numad\n```", "```\n# numad -i 0\n```", "```\n<disk type='file' device='disk'>\n<driver name='qemu' type='raw' cache='writeback'/> \n```", "```\n<disk type='file' device='disk'>\n<driver name='qemu' type='raw' io='threads'/> \n```", "```\n# virsh blkdeviotune SQLForNuma vdb --total-iops-sec 200 --total-bytes-sec 52428800\n```", "```\necho 1 > /proc/sys/net/ipv4/conf/all/arp_filter \n```", "```\n# qemu-kvm -netdev tap,queues=2,... -device virtio-net-pci,queues=2,...\n```", "```\n<interface type='network'>\n\u00a0\u00a0\u00a0\u00a0<source network='default'/>\n\u00a0\u00a0\u00a0\u00a0<model type='virtio'/>\n\u00a0\u00a0\u00a0\u00a0<driver name='vhost' queues='M'/>\n</interface>\n```", "```\n# ethtool -L eth0 combined 'K'\n```", "```\n[root@kvmguest ]$\u00a0\u00a0cat /sys/devices/system/clocksource/clocksource0/current_clocksource\ntsc\n```", "```\nsystemctl enable chronyd\nsystemctl start chronyd\n```", "```\nyum -y install linuxptp\nsystemctl enable ptp4l\nsystemctl start ptp4l\n```", "```\necho ptp_kvm > /etc/modules-load.d/kvm-chrony.conf\nmodprobe ptp_kvm\n```", "```\nrefclock PHC /dev/ptp0 poll 3 dpoll -2 offset 0\nsystemctl restart chronyd\n```"]