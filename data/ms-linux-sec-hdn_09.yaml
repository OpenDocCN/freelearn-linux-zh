- en: Vulnerability Scanning and Intrusion Detection
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 漏洞扫描和入侵检测
- en: There are lots of threats out there, and some of them might even penetrate into
    your network. You'll want to know when that happens, so you'll want to have a
    good **Network Intrusion Detection System** (**NIDS**) in place. We'll look at
    Snort, which is probably the most famous one. I'll then show you a way to cheat
    so that you can have a Snort system up and running in no time at all.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 有很多威胁存在，其中一些甚至可能渗入您的网络。您会想知道发生了什么，因此您需要一个良好的**网络入侵检测系统**（**NIDS**）。我们将看看Snort，这可能是最著名的一个。然后我会向您展示一种快速设置Snort系统的方法。
- en: We've already seen how to scan a machine for viruses and rootkits by installing
    scanning tools onto the machines that we want to scan. However, there are a lot
    more vulnerabilities for which we can scan, and I'll show you some cool tools
    that you can use for that.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到了如何通过在要扫描的机器上安装扫描工具来扫描病毒和rootkit。但是，还有很多漏洞可以进行扫描，我会向您展示一些很酷的工具可以用于此。
- en: 'The following topics are covered in this chapter:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖以下主题：
- en: An introduction to Snort and Security Onion
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍Snort和Security Onion
- en: Scanning and hardening with Lynis
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Lynis进行扫描和加固
- en: Finding vulnerabilities with OpenVAS
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用OpenVAS查找漏洞
- en: Web server scanning with Nikto
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Nikto进行Web服务器扫描
- en: Looking at Snort and Security Onion
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看Snort和Security Onion
- en: Snort is a NIDS, which is offered as a free open source software product. The
    program itself is free of charge, but you'll need to pay if you want to have a
    complete, up-to-date set of threat detection rules. Snort started out as a one-man
    project, but it's now owned by Cisco.  Understand though, this isn't something
    that you install on the machine that you want to protect. Rather, you'll have
    at least one dedicated Snort machine someplace on the network, just monitoring
    all network traffic, watching for anomalies. When it sees traffic that shouldn't
    be there—something that indicates the presence of a bot, for example—it can either
    just send an alert message to an administrator or it can even block the anomalous
    traffic, depending on how the rules are configured. For a small network, you can
    have just one Snort machine that acts as both a control console and a sensor.
    For large networks, you could have one Snort machine set up as a control console
    and have it receive reports from other Snort machines that are set up as sensors.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: Snort是一个NIDS，是作为免费开源软件产品提供的。程序本身是免费的，但如果您想拥有完整的、最新的威胁检测规则集，就需要付费。Snort最初是一个单人项目，但现在由思科公司拥有。但要明白，这不是您要保护的机器上安装的东西。相反，您至少需要一个专用的Snort机器在网络的某个地方，只是监视所有网络流量，观察异常情况。当它看到不应该出现的流量时——例如表明存在机器人的流量——它可以向管理员发送警报消息，甚至可以根据规则的配置阻止异常流量。对于小型网络，您可以只有一个Snort机器，既作为控制台又作为传感器。对于大型网络，您可以设置一个Snort机器作为控制台，并让它接收其他作为传感器设置的Snort机器的报告。
- en: Snort isn't too hard to deal with, but setting up a complete Snort solution
    from scratch can be a bit tedious. After we look at the basics of Snort usage,
    I'll show you how to vastly simplify things by setting up a prebuilt Snort appliance.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Snort并不难处理，但是从头开始设置完整的Snort解决方案可能有点繁琐。在我们了解了Snort的基本用法之后，我将向您展示如何通过设置预构建的Snort设备大大简化事情。
- en: Space doesn't permit me to present a comprehensive tutorial about Snort. Instead,
    I'll present a high-level overview and then present you with other resources for
    learning Snort in detail.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 空间不允许我提供有关Snort的全面教程。相反，我将提供一个高层次的概述，然后向您提供其他学习Snort的资源。
- en: Obtaining and installing Snort
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取和安装Snort
- en: Snort isn't in the official repository of any Linux distro, so you'll need to
    get it from the Snort website. On their downloads page, you'll see installer files
    in the `.rpm` format for Fedora and CentOS and a `.exe` installer file for Windows.
    However, you won't see any `.deb` installer files for Ubuntu. That's okay because
    they also provide source code files that you can compile on a variety of different
    Linux distros. To make things simple, let's just talk about installing Snort on
    CentOS 7 with the prebuilt `.rpm` packages.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Snort不在任何Linux发行版的官方软件库中，因此您需要从Snort网站获取。在他们的下载页面上，您将看到Fedora和CentOS的`.rpm`格式的安装程序文件，以及Windows的`.exe`安装程序文件。但是，您在Ubuntu上看不到任何`.deb`安装程序文件。没关系，因为他们还提供源代码文件，您可以在各种不同的Linux发行版上编译。为了简化事情，让我们只谈谈在CentOS
    7上安装Snort与预构建的`.rpm`软件包。
- en: You can get Snort and Snort training from the official Snort website: [https://www.snort.org](https://www.snort.org).
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从官方Snort网站获取Snort和Snort培训：[https://www.snort.org](https://www.snort.org)。
- en: 'On the Snort home page, just scroll down a bit, and you''ll see the guide on
    how to download and install Snort. Click on the Centos tab and follow the steps.
    The commands in Step 1 will download and install Snort all in one smooth operation,
    as shown in the following screenshot:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在Snort主页上，只需向下滚动一点，你就会看到如何下载和安装Snort的指南。点击Centos选项卡并按照步骤操作。第1步中的命令将下载并安装Snort，如下面的屏幕截图所示：
- en: '![](img/825be8a6-1bc3-417e-a31d-defb1636a75b.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/825be8a6-1bc3-417e-a31d-defb1636a75b.png)'
- en: 'Step 2 and Step 3 involve signing up for your Oinkcode so that you can download
    the official Snort detection rules and then installing PulledPork so that you
    can keep the rules updated automatically, as shown in the following screenshot:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 第2步和第3步涉及注册Oinkcode，以便您可以下载官方的Snort检测规则，然后安装PulledPork，以便您可以自动更新规则，如下面的屏幕截图所示：
- en: '![](img/9fcc95e1-cce7-43fc-b61f-b394926a815a.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9fcc95e1-cce7-43fc-b61f-b394926a815a.png)'
- en: Bear in mind though that the free-of-charge detection rules that the Snort folk
    provide are about a month behind the ones that paid subscribers get. For learning
    purposes though, they're all that you need. Also, if you choose to not get the
    Oinkcode, you can just use the Community rules, which are a subset of the official
    Snort rules.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，Snort提供的免费检测规则大约比付费订阅者获得的规则晚一个月。但是，就学习目的而言，它们就是您所需要的一切。此外，如果您选择不获取Oinkcode，您可以使用社区规则，这是官方Snort规则的一个子集。
- en: 'Step 4 is just to read the documentation:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 第4步只是阅读文档：
- en: '![](img/34f8d630-e4e3-48ad-aa40-e1ce33afa131.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/34f8d630-e4e3-48ad-aa40-e1ce33afa131.png)'
- en: And, that's it. You now have a working copy of Snort. The only catch is all
    you have so far is just the command-line interface, which might not be what you
    want.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样。您现在拥有一个可用的Snort副本。唯一的问题是，到目前为止，您只有命令行界面，这可能不是您想要的。
- en: Graphical interfaces for Snort
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Snort的图形界面
- en: Plain, unadorned Snort will do what you need it to do, and it will save its
    findings to its own set of log files. However, reading through log files to discern
    network traffic trends can get a bit tedious, so you'll want some tools to help
    you out. The best tools are the graphical ones, which can give you a good visualization
    of what's going on with your network.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 普通的、未装饰的Snort将做您需要它做的事情，并将其发现保存到其自己的一组日志文件中。但是，阅读日志文件以辨别网络流量趋势可能会有点乏味，因此您需要一些工具来帮助您。最好的工具是图形工具，它们可以为您提供对网络情况的良好可视化。
- en: 'One example is the **Basic Analysis and Security Engine** (**BASE**), as shown
    in the following screenshot:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 一个例子是**基本分析和安全引擎**（**BASE**），如下截图所示：
- en: '![](img/a1273047-f170-4c8e-9822-259d9a0dcc7e.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a1273047-f170-4c8e-9822-259d9a0dcc7e.png)'
- en: There are several more, but I'll show them to you when we get to the *Security
    Onion* section.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 还有几个，但我会在我们到达* Security Onion *部分时向您展示它们。
- en: You can find out more about BASE from the author's *Professionally Evil* website: [https://professionallyevil.com/](https://professionallyevil.com/)
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从作者的* Professionally Evil *网站了解有关BASE的更多信息：[https://professionallyevil.com/](https://professionallyevil.com/)
- en: Getting Snort in prebuilt appliances
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取预构建的Snort设备
- en: Snort itself isn't too terribly difficult to set up. However, if you're doing
    everything manually, it can be a bit tedious by the time you've set up the control
    console, the sensors, and your choice of graphical frontends. So—and, imagine
    me peering at you over my dark glasses as I say this—what if I told you that you
    can get your Snort setup as part of a ready-to-go appliance? What if I told you
    that setting up such an appliance is an absolute breeze? I imagine that you'd
    probably say, *So, show me already!*
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 设置Snort本身并不是太难。但是，如果您一切都是手动操作，那么在设置控制台、传感器和您选择的图形前端之后，可能会有点乏味。因此——想象一下，当我戴着墨镜凝视着您说这些话时——如果我告诉您，您可以将Snort设置为即插即用设备的一部分呢？如果我告诉您，设置这样的设备绝对是轻而易举的呢？我想您可能会说，“那就给我看看吧！”
- en: If you feel bad about cheating by making Snort deployment so easy, there's really
    no need to. An official Snort representative once told me that most people deploy
    Snort in this manner.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您因使Snort部署变得如此简单而感到内疚，那么实际上没有必要。一位Snort官方代表曾经告诉我，大多数人都以这种方式部署Snort。
- en: Since Snort is a **Free Open Source Software** (**FOSS**) project, it's perfectly
    legal for people to build it into their own FOSS applications. Also, if you think
    back to our discussion of firewalls in [Chapter 3](2ce81cc7-33d8-4d16-ae1a-c446995dd50a.xhtml),
    *Securing Your Server with a Firewall*, I completely glossed over any discussion
    of creating the **Network Address Translation** (**NAT**) rules that you would
    need for setting up an edge or gateway type of firewall. That's because there
    are several Linux distros that have been created specifically for this purpose.
    What if I told you, that some of them also include a full implementation of Snort?
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 由于Snort是一个**自由开源软件**（**FOSS**）项目，因此人们将其构建到自己的FOSS应用程序中是完全合法的。此外，如果您回想一下我们在[第3章](2ce81cc7-33d8-4d16-ae1a-c446995dd50a.xhtml)中对防火墙的讨论，*使用防火墙保护服务器*，我完全忽略了创建**网络地址转换**（**NAT**）规则的讨论，这是您设置边缘或网关类型防火墙所需的。这是因为有几个Linux发行版专门为此目的而创建。如果我告诉您，其中一些还包括Snort的完整实现呢？
- en: '![](img/470e2fe5-231d-49e4-81b3-1982a6cbc381.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](img/470e2fe5-231d-49e4-81b3-1982a6cbc381.png)'
- en: 'IPFire is completely free of charge, and it only takes a few minutes to set
    up. You install it on a machine with at least two network interface adapters and
    configure it to match your network configuration. It''s a proxy-type of a firewall,
    which means that in addition to doing normal firewall-type packet inspection,
    it also includes caching, content-filtering, and NAT capabilities. You can set
    up IPFire in a number of different configurations:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: IPFire完全免费，只需几分钟即可设置。您可以将其安装在至少具有两个网络接口适配器的计算机上，并将其配置为与您的网络配置相匹配。这是一种代理类型的防火墙，这意味着除了进行正常的防火墙类型的数据包检查外，它还包括缓存、内容过滤和NAT功能。您可以以多种不同的配置设置IPFire：
- en: On a computer with two network interface adapters, you can have one connected
    to the internet, and the other connected to the internal LAN.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在具有两个网络接口适配器的计算机上，您可以将一个连接到互联网，另一个连接到内部局域网。
- en: With three network adapters, you can have one connection to the internet, one
    to the internal LAN, and one to the **Demilitarized Zone** (**DMZ**), where you
    have your internet-facing servers.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用三个网络适配器，您可以将一个连接到互联网，一个连接到内部局域网，一个连接到**非军事区**（**DMZ**），在那里您有面向互联网的服务器。
- en: With a fourth network adapter, you can have all the above, plus protection for
    a wireless network.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过第四个网络适配器，您可以拥有上述所有内容，以及对无线网络的保护。
- en: 'After you install IPFire, you''ll need to use the web browser of your normal
    workstation to navigate to the IPFire dashboard. Under the Services menu, you''ll
    see an entry for Intrusion Detection. Click on that to get to this screen, where
    you can download and enable the Snort detection rules:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 安装IPFire后，您需要使用普通工作站的Web浏览器导航到IPFire仪表板。在Services菜单下，您会看到入侵检测的条目。单击该条目即可进入此屏幕，您可以在此屏幕上下载并启用Snort检测规则：
- en: '![](img/deb79b23-a4a1-43b1-83b1-b622c99c61be.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/deb79b23-a4a1-43b1-83b1-b622c99c61be.png)'
- en: 'There''s really only one slight bit of manual tweaking that you might need
    to do from the command line. That is, you might want to go into the rules directory
    and make sure that the rules that you want to enable are enabled. On my demo machine,
    I installed the community rules and the emerging threat rules:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，您可能只需要从命令行进行一点微调。也就是说，您可能需要进入规则目录，并确保您要启用的规则已启用。在我的演示机器上，我安装了社区规则和新兴威胁规则：
- en: '[PRE0]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: When you first install IPFire, the only user account that it sets up is for
    the root user. However, the tools are there to create a normal user account and
    give it `sudo` privileges. I haven't yet done that on this machine because I wanted
    to show you the default configuration. But, I definitely would do it on a production
    machine. I would then disable the root account.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 当您首次安装IPFire时，它设置的唯一用户帐户是root用户。但是，有工具可以创建普通用户帐户并赋予其`sudo`权限。我还没有在这台机器上做这个操作，因为我想向您展示默认配置。但是，在生产机器上我肯定会这样做。然后我会禁用root帐户。
- en: 'When you open one of these rules files, you''ll see that a lot of them are
    disabled and relatively few are enabled. The disabled rules have a `#` sign in
    front of them, as do these two rules from the `community.rules` file:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 当您打开这些规则文件时，您会发现其中许多规则是禁用的，而相对较少的是启用的。禁用的规则前面有一个`#`号，就像`community.rules`文件中的这两个规则一样：
- en: '[PRE1]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'You''ve probably also noted that each rule begins with the keyword, `alert`.
    You can use `grep` to do a quick check to see which rules in a file are enabled:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能还注意到每个规则都以关键字`alert`开头。您可以使用`grep`快速检查文件中启用的规则：
- en: '[PRE2]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The `^` character means that I''m searching through the `community.rules` file for
    every line that begins with the word `alert`, without the preceding `#` sign.
    Piping the output into `less` is optional, but it can help you better see all
    of the output data. You can also search through all the files at once using a
    wildcard:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '`^`字符表示我正在`community.rules`文件中搜索以单词`alert`开头的每一行，而不带前面的`#`号。将输出导入`less`是可选的，但它可以帮助您更好地查看所有输出数据。您还可以使用通配符一次搜索所有文件：'
- en: '[PRE3]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You'll want to look through the rules to see which you need and which you don't
    need. Enable the desired rule by removing the `#` sign from in front of it and
    disable an undesired rule by placing a `#` sign in front of it.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要查看规则以确定您需要哪些规则，哪些规则不需要。通过删除规则前面的`#`号来启用所需的规则，并通过在规则前面放置`#`号来禁用不需要的规则。
- en: 'Unfortunately, IPFire doesn''t include a graphical frontend for visualizing
    Snort data, but it does come with an IDS log viewer:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，IPFire不包括用于可视化Snort数据的图形前端，但它确实带有IDS日志查看器：
- en: '![](img/17a98e3e-7965-4498-ba9b-73dfe68fe310.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/17a98e3e-7965-4498-ba9b-73dfe68fe310.png)'
- en: IPFire also has a lot of other cool features that I haven't yet mentioned. These
    include built-in **Virtual Private Network** (**VPN**) capabilities, a built-in
    DHCP server, a built-in dynamic DNS server, and Quality of Service controls. The
    best part is that it's totally free of charge unless you want to buy a subscription
    to always get the most up-to-date Snort rules.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: IPFire还有许多其他很酷的功能，我还没有提到。这些功能包括内置的**虚拟专用网络**（**VPN**）功能，内置的DHCP服务器，内置的动态DNS服务器和服务质量控制。最好的部分是它是完全免费的，除非您想购买订阅以始终获得最新的Snort规则。
- en: You can download IPFire from their website: [https://www.ipfire.org/.](https://www.ipfire.org/)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从他们的网站下载IPFire：[https://www.ipfire.org/.](https://www.ipfire.org/)
- en: Using Security Onion
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Security Onion
- en: Okay, so maybe the firewall appliance with the built-in Snort isn't what you
    need right now.  Maybe what you need instead is a full-blown NIDS. But, you're
    a busy person who needs something quick and easy, and your boss has put you on
    a rather strict budget. So, what do you do?
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，也许带有内置Snort的防火墙设备现在不是您需要的。也许您需要的是一个完整的NIDS。但是，您是一个忙碌的人，需要快速简便的东西，而且您的老板对您的预算要求相当严格。那么，您该怎么办呢？
- en: Security Onion is a free-of-charge specialty Linux distro that's built on top
    of the Xubuntu **Long-term Support** (**LTS**) distro. It includes a full implementation
    of Snort, complete with just about every graphical goody you can imagine to help
    you visualize what's happening on your network. If you can install a Linux distro
    and do some point-and-click configuration after the installation, then you can
    install Security Onion.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: Security Onion是一个免费的专业Linux发行版，构建在Xubuntu **长期支持**（**LTS**）发行版之上。它包括完整的Snort实现，几乎包括您可以想象的所有图形功能，以帮助您可视化网络上发生的情况。如果您可以安装Linux发行版并在安装后进行一些点对点的配置，那么您就可以安装Security
    Onion。
- en: Note that the Xubuntu LTS version on which Security Onion is based is always
    at least one version behind the current LTS version of  Xubuntu. At the time of
    writing, the current Xubuntu LTS version is version 16.04, whereas Security Onion
    is still based on Xubuntu 14.04\. But, that may change by the time you read this
    book.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，Security Onion所基于的Xubuntu LTS版本始终至少落后于当前Xubuntu LTS版本。在撰写本文时，当前的Xubuntu
    LTS版本是版本16.04，而Security Onion仍然基于Xubuntu 14.04。但是，这可能会在您阅读本书时发生变化。
- en: Also, if you want to try out Security Onion, you can set it up in a VirtualBox
    virtual machine.  When you create the virtual machine, set it up with two network
    adapters, both in *Bridged* mode. For best performance, allocate at least 3 GB
    of memory.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，如果您想尝试Security Onion，您可以在VirtualBox虚拟机中设置它。创建虚拟机时，将其设置为两个网络适配器，都处于*Bridged*模式。为了获得最佳性能，至少分配3GB内存。
- en: 'Once you''ve finished installing the operating system, the configuration is
    just a simple matter of double-clicking the Setup icon and then following through
    with the dialog boxes:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完操作系统后，配置只是简单地双击设置图标，然后按照对话框进行操作：
- en: '![](img/bd8cdbf0-8157-4d55-ae8f-cbc2add30f1b.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bd8cdbf0-8157-4d55-ae8f-cbc2add30f1b.jpg)'
- en: 'For setting up a machine with sensor capabilities, you''ll need a machine with
    two interface cards. One interface, which will have an IP address assigned to
    it, will be the management interface:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置具有传感器功能的机器，您需要一台具有两个接口卡的机器。一个接口将分配IP地址，将成为管理接口：
- en: '![](img/61604ee1-7bbd-49a6-988f-df84287ec385.jpg)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/61604ee1-7bbd-49a6-988f-df84287ec385.jpg)'
- en: 'You can set the management interface to automatically get an IP address via
    DHCP, but it''s much better to assign a static IP address:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将管理界面设置为通过DHCP自动获取IP地址，但最好分配一个静态IP地址：
- en: '![](img/ec1ad2ee-0f10-4ee3-9aed-cad2f089aa00.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ec1ad2ee-0f10-4ee3-9aed-cad2f089aa00.jpg)'
- en: 'You''ll use the other network adapter as the sniffing interface. You won''t
    assign an IP address to it because you want that interface to be invisible to
    the bad guys:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 您将使用另一个网络适配器作为嗅探接口。您不会为其分配IP地址，因为您希望该接口对坏人不可见：
- en: '![](img/793d112c-1fbc-4e40-9d48-4f99d4ead81a.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](img/793d112c-1fbc-4e40-9d48-4f99d4ead81a.jpg)'
- en: 'After you confirm the network configuration that you''ve selected, you''ll
    reboot the machine:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 确认您选择的网络配置后，重新启动机器：
- en: '![](img/896c92b3-90aa-4dd4-bc84-d47f13d78311.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/896c92b3-90aa-4dd4-bc84-d47f13d78311.jpg)'
- en: Once the machine has rebooted, double-click on the Setup icon again, but this
    time choose to skip the network configuration. For a first-time user of Security
    Onion, Evaluation Mode is quite helpful because it automatically chooses the most
    correct options for most stuff.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 机器重新启动后，再次双击设置图标，但这次选择跳过网络配置。对于第一次使用Security Onion的用户来说，评估模式非常有帮助，因为它会自动选择大多数东西的最正确选项。
- en: '![](img/f669c960-bbe3-4221-9f3d-ec3984739106.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f669c960-bbe3-4221-9f3d-ec3984739106.jpg)'
- en: From here on out, it's just a matter of confirming which network interface will
    be the sniffer interface and filling in login credentials for the different graphical
    frontends. And then, after waiting a few moments for the setup utility to download
    Snort rules and perform the final configuration steps, you'll have your very own
    operational NIDS. Now I ask, what could be easier?
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，只需确认哪个网络接口将成为嗅探接口，并填写不同图形界面的登录凭据。然后，在等待设置实用程序下载Snort规则并执行最后的配置步骤后，您将拥有自己的操作NIDS。现在我问，还有什么比这更容易的呢？
- en: 'Security Onion comes with several different graphical frontends. My favorite
    is Squert, which is shown here. Even with just the default set of detection rules,
    I''m already seeing some interesting stuff. The following screenshot shows Squert:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Security Onion配备了几种不同的图形界面。我最喜欢的是Squert，如图所示。即使只有默认的检测规则，我已经看到了一些有趣的东西。以下截图显示了Squert：
- en: '![](img/80bc54f7-f1df-40c7-ad84-de2f28b8c732.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](img/80bc54f7-f1df-40c7-ad84-de2f28b8c732.jpg)'
- en: For one thing, I see that somebody on the network is mining some Monero cryptocoin. 
    Well, actually, I'm the one who's doing it, so it's okay. But, that is a good
    thing to be able to detect because bad guys have been known to plant Monero mining
    software on corporate servers for their own benefit. Monero cryptocoin mining
    puts a big load on a server's CPUs, so it's not something that you want on your
    servers. Also, some sneaky website operators have placed JavaScript code on their
    web pages that cause any computer that visits them to start mining Monero. So,
    this rule is also good for protecting desktop systems.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我看到网络上有人在挖掘一些Monero加密货币。好吧，实际上，我就是在挖，所以没关系。但是，能够检测到这一点是件好事，因为众所周知，坏人曾经在企业服务器上种植Monero挖矿软件以谋取私利。Monero加密货币挖矿会给服务器的CPU带来很大负载，所以这不是你想要的服务器上的东西。此外，一些狡猾的网站运营商在其网页上放置了JavaScript代码，导致任何访问它们的计算机都开始挖掘Monero。因此，这条规则也有助于保护桌面系统。
- en: Another thing I see is Dropbox client broadcasting, which again is okay because
    I'm a Dropbox user. But, that's something else that you may not want to have on
    a corporate network.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 我还看到Dropbox客户端正在广播，这也没关系，因为我是Dropbox用户。但是，这也是您可能不希望在企业网络上拥有的东西。
- en: 'To see the Snort rule that''s associated with a particular item, just click
    on it:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看与特定项目相关联的Snort规则，只需单击该项目：
- en: '![](img/aa806acb-0fd3-4099-bf35-8feaed3a9b83.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/aa806acb-0fd3-4099-bf35-8feaed3a9b83.jpg)'
- en: It's just a standard Snort rule that's already been set up for us.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是一个已经为我们设置好的标准Snort规则。
- en: 'Bad guys who want to mine Monero without paying for it have set up botnets
    of machines that have been infected with their mining software. In some of the
    attacks, only Windows servers have been infected. But, here''s a case where both
    Windows and Linux servers have been infected:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 想要挖掘Monero而不付费的坏人已经建立了被感染其挖矿软件的机器的僵尸网络。在一些攻击中，只有Windows服务器被感染。但是，这里有一个情况，Windows和Linux服务器都被感染了：
- en: '[https://www.v3.co.uk/v3-uk/news/3023348/cyber-crooks-conducting-sophisticated-malware-campaign-to-mine-monero](https://www.v3.co.uk/v3-uk/news/3023348/cyber-crooks-conducting-sophisticated-malware-campaign-to-mine-monero)'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://www.v3.co.uk/v3-uk/news/3023348/cyber-crooks-conducting-sophisticated-malware-campaign-to-mine-monero](https://www.v3.co.uk/v3-uk/news/3023348/cyber-crooks-conducting-sophisticated-malware-campaign-to-mine-monero)'
- en: 'Click on Squert''s VIEWS tab, and you''ll see a graphical representation of
    the connections that your machines have established:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 单击Squert的“视图”选项卡，您将看到您的机器建立的连接的图形表示：
- en: '![](img/54090a04-67d2-403b-a088-26bd25236c1e.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/54090a04-67d2-403b-a088-26bd25236c1e.jpg)'
- en: There's still a lot more than I could show you about both Security Onion and
    Snort, but alas, space doesn't permit. I've given you the gist of it, now go try
    it for yourself.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 关于Security Onion和Snort，我还可以向您展示更多，但是，空间不允许。我已经给了您要领，现在去尝试一下吧。
- en: 'I know that I made this Snort/Security Onion thing look rather easy, but there''s
    a lot more to it than what I''ve been able to show you. On a large network, you
    might see a lot of traffic that doesn''t make a lot of sense unless you know how
    to interpret the information that Snort presents to you. You might also need to
    fine-tune your Snort rules in order to see the anomalies that you want to see,
    without generating false positives. Or, you might even find the need to write
    your own custom Snort rules to handle unusual situations. Fortunately, the Security
    Onion folk do provide training, both on-site and online. You can find out more
    about it at the following website:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 我知道我让Snort/Security Onion看起来相当简单，但实际上比我能向您展示的要复杂得多。在大型网络上，您可能会看到很多看起来毫无意义的流量，除非您知道如何解释Snort向您呈现的信息。您可能还需要微调您的Snort规则，以便看到您想要看到的异常情况，而不会产生错误的警报。或者，您甚至可能需要编写自己的自定义Snort规则来处理异常情况。幸运的是，Security
    Onion团队提供培训，包括现场和在线培训。您可以在以下网站了解更多信息：
- en: '[https://securityonionsolutions.com/.](https://securityonionsolutions.com/)'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://securityonionsolutions.com/.](https://securityonionsolutions.com/)'
- en: Scanning and hardening with Lynis
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Lynis进行扫描和加固
- en: Lynis is yet another FOSS tool that you can use to scan your systems for vulnerabilities
    and bad security configurations. It comes as a portable shell script that you
    can use not only on Linux, but also on a variety of different Unix systems and
    Unix-like systems. It's a multipurpose tool, which you can use for compliance
    auditing, vulnerability scanning, or hardening. Unlike most vulnerability scanners,
    you install and run Lynis on the system that you want to scan. According to the
    creator of Lynis, this allows for more in-depth scanning.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Lynis是另一个可以用来扫描系统漏洞和不良安全配置的自由开源软件工具。它是一个便携式shell脚本，不仅可以在Linux上使用，还可以在各种不同的Unix系统和类Unix系统上使用。它是一个多用途工具，您可以用它进行合规性审计、漏洞扫描或加固。与大多数漏洞扫描工具不同，您需要在要扫描的系统上安装和运行Lynis。根据Lynis的创建者，这样可以进行更深入的扫描。
- en: The Lynis scanning tool is available as a free-of-charge version, but its scanning
    capabilities are somewhat limited. If you need all that Lynis has to offer, you'll
    need to purchase an enterprise license.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Lynis扫描工具有免费版本，但其扫描能力有限。如果您需要Lynis提供的所有功能，您需要购买企业许可证。
- en: Installing Lynis on Red Hat/CentOS
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Red Hat/CentOS上安装Lynis
- en: 'Red Hat/CentOS users will find an up-to-date version of Lynis in the EPEL repository.
    So, if you have EPEL installed, as I showed you in [Chapter 1](366f0919-598d-4648-8873-b4dbe636d171.xhtml),
    *Running Linux on a Virtual Environment,* installation is just a simple matter
    of doing:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: Red Hat/CentOS用户将在EPEL存储库中找到最新版本的Lynis。因此，如果您已安装了EPEL，就像我在[第1章](366f0919-598d-4648-8873-b4dbe636d171.xhtml)中向您展示的那样，*在虚拟环境上运行Linux*，安装只是一个简单的事情：
- en: '[PRE4]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Installing Lynis on Ubuntu
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Ubuntu上安装Lynis
- en: 'Ubuntu has Lynis in its own repository, but which version you get depends on
    which version of Ubuntu you have. The Ubuntu 16.04 LTS repository has a version
    that''s fairly far behind what''s current. The version in the Ubuntu 17.10 repository
    is newer, but still not completely up to date. In either case, the command to
    install Lynis is:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: Ubuntu在其自己的存储库中有Lynis，但您获得的版本取决于您使用的Ubuntu版本。Ubuntu 16.04 LTS存储库中的版本相对较旧。Ubuntu
    17.10存储库中的版本更新一些，但仍不完全是最新的。在任何情况下，安装Lynis的命令是：
- en: '[PRE5]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If you want the newest version for Ubuntu or if you want to use Lynis on operating
    systems that don't have it in their repositories, you can download it from the
    author's website.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想要Ubuntu的最新版本，或者想要在没有Lynis的存储库中使用Lynis的操作系统上使用它，您可以从作者的网站上下载。
- en: You can download Lynis from [https://cisofy.com/downloads/lynis/.](https://cisofy.com/downloads/lynis/)
    The cool thing about this is that once you download it, you can use it on any
    Linux, Unix, or Unix-like operating system.  (This even includes MacOS, which
    I just now confirmed by running it on my old Mac Pro that's running with macOS
    High Sierra.) [](https://cisofy.com/downloads/lynis/)
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从[https://cisofy.com/downloads/lynis/.](https://cisofy.com/downloads/lynis/)下载Lynis。这个很酷的地方是，一旦您下载了它，您可以在任何Linux、Unix或类Unix操作系统上使用它。（这甚至包括MacOS，我刚刚通过在运行macOS
    High Sierra的旧Mac Pro上运行它来确认。）[](https://cisofy.com/downloads/lynis/)
- en: 'Since the executable file is nothing but a common shell script, there''s no
    need to perform an actual installation. All you need to do is to extract the archive
    file, `cd` into the resultant directory, and run Lynis from there:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 由于可执行文件只是一个普通的shell脚本，因此无需执行实际安装。您只需要解压缩存档文件，`cd`进入生成的目录，并从那里运行Lynis：
- en: '[PRE6]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The `lynis -h` command shows you the help screen, with all of the Lynis commands
    that you need to know.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '`lynis -h`命令显示帮助屏幕，其中包含您需要了解的所有Lynis命令。'
- en: Scanning with Lynis
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Lynis进行扫描
- en: Lynis commands work the same regardless of which operating system that you want
    to scan. The only difference is that if you're running it from the archive file
    that you downloaded from the website, you would `cd` into the `lynis` directory
    and precede the `lynis` commands with a `./`.  (That's because, for security reasons,
    your own home directory isn't in the path setting that allows the shell to automatically
    find executable files.)
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 无论您要扫描哪个操作系统，Lynis命令都是相同的。唯一的区别是，如果您从网站下载的存档文件中运行它，您将`cd`进入`lynis`目录，并在`lynis`命令之前加上`./`。（这是因为出于安全原因，您自己的主目录不在允许shell自动查找可执行文件的路径设置中。）
- en: 'To scan your system that has Lynis installed, follow this:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 要扫描已安装Lynis的系统，请按照以下步骤进行：
- en: '[PRE7]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To scan a system on which you just downloaded the archive file, follow this:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 要扫描刚刚下载存档文件的系统，请按照以下步骤进行：
- en: '[PRE8]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Running Lynis from the shell script in your home directory presents you with
    this message:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 从您的主目录中的shell脚本运行Lynis会显示以下消息：
- en: '[PRE9]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: That's not hurting anything, so you can just hit *Enter* to continue. Or, if
    seeing this message really bothers you, you can change ownership of the Lynis
    files to the root user, as the message tells you. For now, I'll just press *Enter*.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这不会造成任何损害，所以你可以按*Enter*继续。或者，如果看到这条消息真的让你烦恼，你可以按照消息告诉你的那样，将Lynis文件的所有权更改为root用户。现在，我只是按下*Enter*。
- en: Running a Lynis scan in this manner is similar to running an OpenSCAP scan against
    a generic security profile. The major difference is that OpenSCAP has an automatic
    remediation feature, but Lynis doesn't. Lynis tells you what it finds and suggests
    how to fix what it perceives to be a problem, but it doesn't fix anything for
    you.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 以这种方式运行Lynis扫描类似于运行OpenSCAP扫描以符合通用安全配置文件。主要区别在于OpenSCAP具有自动修复功能，而Lynis没有。Lynis告诉你它发现了什么，并建议如何修复它认为是问题的东西，但它不会为你修复任何东西。
- en: 'Space doesn''t permit me to show the entire scan output, but I can show you
    a couple of example snippets:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 空间不允许我展示整个扫描输出，但我可以给你展示一些示例片段：
- en: '[PRE10]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The warning message shows that I don't have password protection for my `GRUB2`
    bootloader. That may or may not be a big deal because the only way someone can
    exploit that is to gain physical access to the machine. If it's a server that's
    locked away in a room that only a few trusted personnel can access, then I'm not
    going to worry about it, unless rules from an applicable regulatory agency dictate
    that I do. If it's a desktop machine that's out in an open cubicle, then I would
    definitely fix that. (We'll look at GRUB password protection in [Chapter 10](a991e0a0-ef66-417f-811c-c138e940663c.xhtml),
    *Security Tips and Tricks for the Busy Bee*.)
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 警告消息显示我没有为我的“GRUB2”引导加载程序设置密码保护。这可能很重要，也可能不重要，因为有人可以利用这一点来获得对机器的物理访问权限。如果这是一个被锁在只有少数信任人员可以访问的房间里的服务器，那么我不会担心，除非适用的监管机构的规定要求我这样做。如果这是一个放在开放式隔间里的台式机，那么我肯定会修复这个问题。（我们将在[第10章](a991e0a0-ef66-417f-811c-c138e940663c.xhtml)中看到GRUB密码保护，*忙碌蜜蜂的安全提示和技巧*。）
- en: 'In the `File systems` section, we see some items with the `SUGGESTION` flag:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在“文件系统”部分，我们看到一些带有“建议”标志的项目。
- en: '[PRE11]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Exactly what Lynis suggests comes near the end of the output:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 正是Lynis建议的内容出现在输出的最后：
- en: '[PRE12]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The last thing we''ll look at is the scan details section at the end of the
    output:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看看输出的最后一个部分，即扫描详细信息部分：
- en: '[PRE13]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: For `Components`, there's a red `X` by `Malware Scanner`. That's because I don't
    have ClamAV or `maldet` installed on this machine, so Lynis couldn't do a virus
    scan.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 对于“组件”，“恶意软件扫描器”旁边有一个红色的“X”。这是因为我没有在这台机器上安装ClamAV或“maldet”，所以Lynis无法进行病毒扫描。
- en: For `Lynis Modules`, we see a question mark by `Compliance Status`. That's because
    this feature is reserved for the Enterprise version of Lynis, which requires a
    paid subscription. As we saw in the previous chapter, you have OpenSCAP profiles
    to make a system compliant with several different security standards, and it doesn't
    cost you anything. With Lynis, you have to pay for the compliance profiles, but
    you have a wider range from which to choose. In addition to the compliance profiles
    that OpenSCAP offers, Lynis also offers profiles for HIPAA and Sarbanes-Oxley
    compliance.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 对于“Lynis模块”，我们看到“合规状态”旁边有一个问号。这是因为这个功能是为Lynis企业版保留的，需要付费订阅。正如我们在上一章中看到的，你可以使用OpenSCAP配置文件使系统符合几种不同的安全标准，而且这不需要花费任何费用。使用Lynis，你必须为合规配置文件付费，但你可以选择更广泛的范围。除了OpenSCAP提供的合规配置文件外，Lynis还提供了HIPAA和萨班斯-奥克斯合规配置文件。
- en: If you're based here in the United States, you most surely know what HIPAA and
    Sarbanes-Oxley are and whether they apply to you. If you're not in the United
    States, then you probably don't need to worry about them.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在美国，你肯定知道HIPAA和萨班斯-奥克斯是什么，以及它们是否适用于你。如果你不在美国，那么你可能不需要担心它们。
- en: Having said that, if you work in the healthcare industry, even if you're not
    in the United States, the HIPAA profile can give you guidance about how to protect
    private data for patients.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，如果你在医疗行业工作，即使你不在美国，HIPAA配置文件也可以为你提供如何保护患者的私人数据的指导。
- en: 'The last thing I want to say about Lynis is about the Enterprise version. In
    this screenshot from their website, you can see the current pricing and the differences
    between the different subscription plans:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 关于Lynis，我想说的最后一件事是关于企业版。在他们网站上的这张截图中，你可以看到当前的定价和不同订阅计划之间的区别：
- en: '![](img/56958b7d-ddee-4df7-b56b-ad6cfb4b44ee.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/56958b7d-ddee-4df7-b56b-ad6cfb4b44ee.png)'
- en: As you can see, you have choices.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所看到的，你有选择。
- en: 'You''ll find information about pricing at this website:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个网站上你会找到有关定价的信息：
- en: '[https://cisofy.com/pricing/.](https://cisofy.com/pricing/)'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://cisofy.com/pricing/.](https://cisofy.com/pricing/)'
- en: That pretty much wraps it up for our discussion of Lynis. Next, let's look at
    an *external* vulnerability scanner.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上就是我们对Lynis的讨论。接下来，让我们看看一个*外部*漏洞扫描器。
- en: Finding vulnerabilities with OpenVAS
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用OpenVAS查找漏洞
- en: The **Open Vulnerability Assessment Scanner** (**OpenVAS**) is something that
    you would use to perform remote vulnerability scans. You can scan a single machine,
    a group of similar machines, or an entire network. It's not included in the repositories
    of the major Linux distros, so the best way to get it is to install one of the
    specialty security distros.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '**开放漏洞评估扫描器**（**OpenVAS**）是你用来执行远程漏洞扫描的工具。你可以扫描单台机器、一组相似的机器或整个网络。它不包含在主要Linux发行版的软件仓库中，所以最好的方法是安装专门的安全发行版之一来获取它。'
- en: The big three security distros are Kali Linux, Parrot Linux, and Black Arch.
    They're aimed at security researchers and penetration testers, but they contain
    tools that would also be good for just a normal security administrator of either
    the Linux or Windows variety. OpenVAS is one such tool. All three of these three
    security distros have their unique advantages and disadvantages, but as Kali is
    the most popular, we'll go with it for the demos.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 三大安全发行版是Kali Linux、Parrot Linux和Black Arch。它们面向安全研究人员和渗透测试人员，但它们包含的工具也适用于Linux或Windows的普通安全管理员。OpenVAS就是其中之一。这三个安全发行版都有各自独特的优势和劣势，但由于Kali最受欢迎，我们将用它进行演示。
- en: You can download Kali Linux from [https://www.kali.org/downloads/.](https://www.kali.org/downloads/)
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从[https://www.kali.org/downloads/.](https://www.kali.org/downloads/)下载Kali
    Linux
- en: 'When you go to the Kali download page, you''ll see lots of choices. If you''re
    like me and don''t like the default Gnome 3 desktop environment, you can choose
    something else. I''m personally an LXDE guy, so I''ll go with it:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 当您转到Kali下载页面时，您会看到很多选择。如果您像我一样不喜欢默认的Gnome 3桌面环境，您可以选择其他内容。我个人是LXDE的粉丝，所以我会选择它：
- en: '![](img/d8022e70-a058-4517-b4b3-8fd1a9c3399f.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d8022e70-a058-4517-b4b3-8fd1a9c3399f.png)'
- en: Kali is built from Debian Linux, so installing it is pretty much the same as
    installing Debian.  The one exception is that the Kali installer lets you create
    a password for the root user, but it doesn't let you create a normal, non-root
    user account. That's because pretty much everything you do with Kali requires
    you to be logged in as the root user. I know that flies in the face of what I've
    been telling you about not logging in as `root` and about using `sudo` from a
    normal user account instead. However, most of the stuff you need to do with Kali
    doesn't work with `sudo`. Besides, Kali isn't meant to be used as a general-purpose
    distro, and you'll be okay logging in as a root as long as you only use Kali as
    it was intended to be used.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: Kali是基于Debian Linux构建的，因此安装它与安装Debian几乎相同。唯一的例外是Kali安装程序允许您为root用户创建密码，但不允许您创建普通的非root用户帐户。这是因为您在Kali中几乎所有操作都需要以root用户身份登录。我知道这与我一直告诉您的不要以`root`身份登录以及使用`sudo`而不是普通用户帐户登录的建议相悖。但是，您在Kali中需要做的大部分工作都无法使用`sudo`完成。此外，Kali并不是用作通用发行版，只要您按照其预期使用，以root身份登录就可以。
- en: OpenVAS is a rather memory-hungry program, so if you're installing Kali in a
    virtual machine, be sure to allocate at least three GB of memory.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: OpenVAS是一个占用内存较多的程序，因此如果您在虚拟机中安装Kali，请确保至少分配3GB的内存。
- en: 'The first thing you''ll want to do after installing Kali is to update it, which
    is done in the same way that you''d update any Debian/Ubuntu-type of distro. Then,
    install OpenVAS, as follows:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Kali后，您需要做的第一件事是更新它，这与更新任何Debian/Ubuntu类型的发行版的方式相同。然后，按照以下方式安装OpenVAS：
- en: '[PRE14]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'After the OpenVAS installation completes, you''ll need to run a script that
    will create the security certificates and download the vulnerability database:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: OpenVAS安装完成后，您需要运行一个脚本，该脚本将创建安全证书并下载漏洞数据库：
- en: '[PRE15]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'This will take a long time, so you might as well go grab a sandwich and a coffee
    while it''s running. When it''s finally done, you''ll be presented with the password
    that you''ll use to log in to OpenVAS. Write it down and keep it in a safe place:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 这将需要很长时间，所以在运行时您可以去拿一个三明治和一杯咖啡。最终完成后，您将看到用于登录OpenVAS的密码。记下来并保存在安全的地方：
- en: '![](img/876e41e9-8657-4e9c-82b4-c2aa404e2281.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](img/876e41e9-8657-4e9c-82b4-c2aa404e2281.png)'
- en: 'You can control and update OpenVAS from the applications menu:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从应用程序菜单控制和更新OpenVAS：
- en: '![](img/94e3fd1a-6ecb-46ef-b233-246cbfe67655.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](img/94e3fd1a-6ecb-46ef-b233-246cbfe67655.png)'
- en: 'On that menu, click on openvas start. Then, open Firefox and navigate to `https://localhost:9392`.
    You''ll get a security alert because OpenVAS uses a self-signed security certificate,
    but that''s okay. Just click on the Advanced button, then click on Add Exception:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在菜单中，单击openvas start。然后，打开Firefox并导航到`https://localhost:9392`。您会收到一个安全警告，因为OpenVAS使用自签名的安全证书，但没关系。只需单击“高级”按钮，然后单击“添加异常”：
- en: '![](img/c92c5951-0845-4196-b747-e9801c6c1f45.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c92c5951-0845-4196-b747-e9801c6c1f45.png)'
- en: At the login page, enter `admin` as the user and then enter the password that
    got generated by the `openvas-setup` script.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在登录页面，输入`admin`作为用户，然后输入由`openvas-setup`脚本生成的密码。
- en: 'Now, there''s all kinds of fancy stuff that you can do with OpenVAS, but for
    now, we''ll just look at how to do a basic vulnerability scan. To begin, select
    Tasks from the Scans menu on the OpenVAS dashboard:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，OpenVAS有各种花哨的功能，但现在我们只看如何进行基本的漏洞扫描。首先，从OpenVAS仪表板的扫描菜单中选择“任务”：
- en: '![](img/e9e44e34-d33e-4018-b7fd-8144c6ab1dd2.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e9e44e34-d33e-4018-b7fd-8144c6ab1dd2.png)'
- en: 'This makes this dialog box pop up, telling you to use the wizard. (Yes indeed,
    we''re off to see the wizard.):'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这将弹出对话框，告诉您使用向导。（没错，我们要去见向导。）：
- en: '![](img/4f032242-2fd2-48b1-be96-38459018f05c.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4f032242-2fd2-48b1-be96-38459018f05c.png)'
- en: 'After you close the dialog box, you''ll see the purple wizard icon show up
    in the upper left-hand corner. For now, we''ll just select the Task Wizard option,
    which will choose all of the default scan settings for us:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭对话框后，您会看到紫色的向导图标出现在左上角。现在，我们只需选择“任务向导”选项，它将为我们选择所有默认的扫描设置：
- en: '![](img/f10eb08c-d992-4ba7-ba21-c23023f02f14.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f10eb08c-d992-4ba7-ba21-c23023f02f14.png)'
- en: 'The only thing you need to do here is to enter the IP address of the machine
    that you want to scan and then start the scan:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要做的唯一事情是输入要扫描的机器的IP地址，然后开始扫描：
- en: '![](img/010d859c-f0cc-4125-aa11-1790c54a812d.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](img/010d859c-f0cc-4125-aa11-1790c54a812d.png)'
- en: The scan will take some time, so you might as well go grab a sandwich and a
    coffee.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描需要一些时间，所以在运行时您可以去拿一个三明治和一杯咖啡。
- en: '![](img/fe476525-6d56-4b2d-9d63-a253e287d4d2.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fe476525-6d56-4b2d-9d63-a253e287d4d2.png)'
- en: 'The type of scan that you''re doing is named Full and Fast, which isn''t the
    most comprehensive type of scan. To select another type of scan and to configure
    other scan options, use the Advanced Task Wizard as shown in the following screenshot:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 你正在进行的扫描类型被称为全面和快速，这不是最全面的扫描类型。要选择另一种扫描类型并配置其他扫描选项，请使用高级任务向导，如下面的截图所示：
- en: '![](img/7035b467-e60d-4787-9e85-ec9b1d8d3843.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7035b467-e60d-4787-9e85-ec9b1d8d3843.png)'
- en: 'Here, you see the drop-down list of the different scan options:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到不同扫描选项的下拉列表：
- en: '![](img/fdc8c84f-c9f5-4f31-a1c2-623a0a6b5d1d.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fdc8c84f-c9f5-4f31-a1c2-623a0a6b5d1d.png)'
- en: 'When I did the first scan with the default Full and Fast option, I didn''t
    discover many problems. I had one of medium severity and 18 of low severity, and
    that was it. I knew that there had to be more problems than that due to the age
    of the machine that I was scanning, so I tried again with the Full and fast ultimate option.
    This time, I found more, including some high severity stuff:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 当我使用默认的全面和快速选项进行第一次扫描时，我没有发现太多问题。我发现了一个中等严重性和18个低严重性的问题，就这些。由于我扫描的机器的年龄，我知道肯定会有更多问题，所以我尝试了全面和快速终极选项。这一次，我发现了更多问题，包括一些高严重性的问题：
- en: '![](img/90b5493d-aa82-4d16-91fb-e42f1d21bf04.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](img/90b5493d-aa82-4d16-91fb-e42f1d21bf04.png)'
- en: The report shows that my machine is using weak encryption algorithms for Secure
    Shell, which is classified as medium severity. It also has a print server vulnerability
    that's classified as a high-severity problem.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 报告显示，我的机器正在使用弱加密算法进行Secure Shell，这被分类为中等严重性。它还有一个被分类为高严重性问题的打印服务器漏洞。
- en: You also want to pay attention to the items that aren't flagged as vulnerabilities.
    For example, the VNC security types item shows that port `5900` is open. This
    means that the **Virtual Network Computing** (**VNC**) daemon is running, which
    allows users to remotely log in to this machine's desktop. If this machine were
    an internet-facing machine, that would be a real problem because there's no real
    security with VNC, the way there is with Secure Shell.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 你还需要注意那些没有标记为漏洞的项目。例如，VNC安全类型项显示端口`5900`是开放的。这意味着**虚拟网络计算**（VNC）守护程序正在运行，允许用户远程登录到这台机器的桌面。如果这台机器是一个面向互联网的机器，那将是一个真正的问题，因为VNC没有像Secure
    Shell那样的真正安全性。
- en: '![](img/c4a7abda-7d02-41fb-9170-002fceb1b0a9.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c4a7abda-7d02-41fb-9170-002fceb1b0a9.png)'
- en: By clicking on the print server item, I can see an explanation of this vulnerability.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 点击打印服务器项目，我可以看到对这个漏洞的解释。
- en: '![](img/133d19f1-c93a-4aa6-b1eb-9a7970a25ab8.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![](img/133d19f1-c93a-4aa6-b1eb-9a7970a25ab8.png)'
- en: Keep in mind that the target machine, in this case, is a desktop machine. If
    it were a server, there's a good chance that we'd see even more problems.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，目标机器在这种情况下是一台台式机。如果它是一台服务器，很可能会出现更多问题。
- en: And, that pretty much wraps things up for OpenVAS. As I said before, there's
    a lot of awesome stuff that you can do with it. But, what I've shown you here
    should be enough to get you started. Play around with it and try out the different
    scan options to see the difference in results.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 这基本上就是OpenVAS的全部内容了。正如我之前所说，你可以用它做很多很棒的事情。但是，我在这里向你展示的应该足够让你入门了。尝试使用不同的扫描选项来玩耍，看看结果的差异。
- en: If you want to find out more about Kali Linux, you'll find a great selection
    of books about it at the Packt Publishing website.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想了解更多关于Kali Linux的信息，你可以在Packt Publishing网站上找到很多关于它的书籍。
- en: Web server scanning with Nikto
  id: totrans-172
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Nikto进行Web服务器扫描
- en: OpenVAS, which we just looked at, is a general-purpose vulnerability scanner.
    It can find vulnerabilities for any kind of operating system or for any server
    daemon. However, as we've just seen, an OpenVAS scan can take a while to run,
    and it might be more than what you need.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 我们刚刚看到的OpenVAS是一个通用的漏洞扫描器。它可以找到任何操作系统或服务器守护程序的漏洞。然而，正如我们刚刚看到的，OpenVAS扫描可能需要一段时间才能运行，并且可能超出你的需求。
- en: Nikto is a special-purpose tool with only one purpose. That is, it's meant to
    scan web servers and only web servers. It's easy to install, easy to use, and
    capable of doing a comprehensive scan of a web server fairly quickly. And, although
    it's included in Kali Linux, you don't need Kali Linux to run it.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: Nikto是一个专用工具，只有一个目的。也就是说，它的目的是扫描Web服务器，只有Web服务器。它易于安装，易于使用，并且能够相当快速地对Web服务器进行全面扫描。虽然它包含在Kali
    Linux中，但你不需要Kali Linux来运行它。
- en: Nikto in Kali Linux
  id: totrans-175
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kali Linux中的Nikto
- en: 'If you already have Kali Linux, you''ll find that nikto is already installed
    under the Vulnerability Analysis menu:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经有Kali Linux，你会发现nikto已经安装在漏洞分析菜单下：
- en: '![](img/2a672fb6-b8ca-4630-8a4e-0b8f75378588.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2a672fb6-b8ca-4630-8a4e-0b8f75378588.png)'
- en: 'When you click on that menu item, you''ll open a command-line terminal with
    a display of the Nikto help screen:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击菜单项时，你会打开一个带有Nikto帮助屏幕显示的命令行终端：
- en: '![](img/df7af3ce-9d87-4c84-b649-d2edaa72ac91.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/df7af3ce-9d87-4c84-b649-d2edaa72ac91.png)'
- en: Installing and updating Nikto on Linux
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Linux上安装和更新Nikto
- en: Nikto is in the EPEL repository for Red Hat/CentOS, and it's in the normal repository
    for Ubuntu. Along with the Nikto package itself, you'll also want to install a
    package that allows Nikto to scan web servers that are set up with SSL/TLS encryption.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: Nikto在Red Hat/CentOS的EPEL仓库中，而在Ubuntu的正常仓库中。除了Nikto软件包本身，你还需要安装一个允许Nikto扫描设置了SSL/TLS加密的Web服务器的软件包。
- en: 'To install on Red Hat/CentOS:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在Red Hat/CentOS上安装：
- en: '[PRE16]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'To install on Ubuntu:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在Ubuntu上安装：
- en: '[PRE17]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The next thing you''ll want to do is to update the database of vulnerability
    signatures. But, at the time of writing this, there''s a slight bug in the Red
    Hat/CentOS implementation. For some reason, the `docs` directory is missing, which
    means that the update functions won''t be able to download the `CHANGES.txt` file
    to show you what changed with the new database updates. To fix that on your CentOS
    virtual machine, use this:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来你需要做的是更新漏洞签名数据库。但是，在撰写本文时，Red Hat/CentOS实现中存在一个轻微的错误。由于某种原因，`docs`目录丢失，这意味着更新功能将无法下载`CHANGES.txt`文件，以向您展示新数据库更新的变化。要在您的CentOS虚拟机上修复这个问题，请使用以下命令：
- en: '[PRE18]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Keep in mind though that this could be fixed by the time you read this.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 不过请记住，到你读到这篇文章的时候，这些问题可能已经被修复了。
- en: 'From here on out, things will work the same on either of your virtual machines.
    To update the vulnerability database, use this:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，无论你的虚拟机是哪一个，事情都会一样。要更新漏洞数据库，请使用以下命令：
- en: '[PRE19]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Nikto itself doesn't require `sudo` privileges, but updating it does because
    it requires writing to a directory where normal users can't write.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: Nikto本身不需要`sudo`权限，但更新它需要，因为它需要写入普通用户无法写入的目录。
- en: Scanning a web server with Nikto
  id: totrans-192
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Nikto扫描Web服务器
- en: From here on out, you no longer need `sudo` privileges.  So, you get a break
    from always having to type your password.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，你不再需要`sudo`权限。所以，你可以暂时不用输入密码了。
- en: 'To do a simple scan, use the `-h` option to specify the target host:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 要进行简单的扫描，使用`-h`选项指定目标主机：
- en: '[PRE20]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Let''s look at some sample output:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一些示例输出：
- en: '[PRE21]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: At the top, we see that there's an `shtml.exe` file present, that's supposedly
    for the FrontPage web authoring program.  I have no idea why it's there, considering
    that this is a Linux server and that that's a Windows executable. Nikto is telling
    me that by having that file there, someone could possibly do a **Denial-of-Service **(**DOS**)
    attack against me.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在顶部，我们看到`vti_bin`目录中有一个`shtml.exe`文件，据说是用于FrontPage Web编写程序的。我不知道为什么会有这个文件，考虑到这是一个Linux服务器，那是一个Windows可执行文件。Nikto告诉我，通过拥有那个文件，某人可能会对我进行**拒绝服务**（**DOS**）攻击。
- en: Next, we see that there are various scripts in the `/cgi-bin` directory. You
    can see from the explanatory messages that that's not a good thing because it
    could allow attackers to execute commands on my server.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们看到`/cgi-bin`目录中有各种脚本。你可以从解释性消息中看出这不是一件好事，因为这可能允许攻击者在我的服务器上执行命令。
- en: After this, we see that there's an `author.exe` file in the `vti_bin` directory,
    which could theoretically allow someone to have authoring privileges.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在这之后，我们看到`vti_bin`目录中有一个`author.exe`文件，这理论上可能允许某人拥有作者权限。
- en: The final item of interest is the `passwd.txt` file that's in the `wwwboard` directory. 
    Apparently, this password file is browsable, which is definitely not a good thing.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个有趣的项目是`wwwboard`目录中的`passwd.txt`文件。显然，这个密码文件是可浏览的，这绝对不是一件好事。
- en: Now, before you accuse me of making these problems up, I will reveal that this
    is a scan of a real production website on a real hosting service. (And yes, I
    do have permission to scan it.)  So, these problems are real and need to be fixed.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在你指责我捏造这些问题之前，我要透露这是对一个真实托管服务上的真实生产网站的扫描。（是的，我有扫描的许可。）所以，这些问题是真实存在的，需要修复。
- en: 'Here are a couple of other sample messages that I got from scanning a web server
    that''s running WordPress:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我从扫描运行WordPress的Web服务器中得到的另外两个示例消息：
- en: '[PRE22]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: To make a long story short, both of these two problems could potentially allow
    an attacker to steal user credentials. The fix, in this case, would be to see
    if the WordPress folk have issued any updates that would fix the problem.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 长话短说，这两个问题都有可能允许攻击者窃取用户凭据。在这种情况下，解决方法是查看WordPress团队是否发布了任何可以解决问题的更新。
- en: So, how can we protect a web server against these kinds of vulnerabilities?
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们如何保护Web服务器免受这些漏洞的影响呢？
- en: As we saw in the first example, you want to ensure that you don't have any risky
    executable files on your web server. In this case, we found two `.exe` files that
    might not hurt anything on our Linux server, since Windows executable files don't
    run on Linux. However, on the other hand, it could be a Linux executable that's
    disguised as a Windows executable. We also found some `perl` scripts that definitely
    would run on Linux and that could pose a problem.
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正如我们在第一个示例中看到的，你希望确保你的Web服务器上没有任何风险的可执行文件。在这种情况下，我们发现了两个`.exe`文件，可能不会对我们的Linux服务器造成任何伤害，因为Windows可执行文件无法在Linux上运行。然而，另一方面，它可能是一个伪装成Windows可执行文件的Linux可执行文件。我们还发现了一些`perl`脚本，这些脚本肯定会在Linux上运行，并可能会造成问题。
- en: In the event that someone were to plant some malicious script on your web server,
    you would want to have some form of mandatory access control, such as SELinux
    or AppArmor, that would keep the malicious scripts from running. (See [Chapter
    7](39aa4856-4412-4ca1-a2ee-f53a13ee96c9.xhtml), *Implementing Mandatory Access
    Control with SELinux and AppArmor,* for details about that.)
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果有人在你的Web服务器上植入了一些恶意脚本，你会希望有某种强制访问控制，比如SELinux或AppArmor，可以阻止恶意脚本运行。（有关详细信息，请参阅[第7章](39aa4856-4412-4ca1-a2ee-f53a13ee96c9.xhtml)，*使用SELinux和AppArmor实施强制访问控制*。）
- en: You might also consider installing a web application firewall, such as *ModSecurity*.
    Space doesn't permit me to cover the details of ModSecurity, but you'll find a
    book that covers it at the Packt Publishing website.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可能还考虑安装Web应用防火墙，比如*ModSecurity*。空间不允许我详细介绍ModSecurity的细节，但你可以在Packt Publishing网站找到一本介绍它的书。
- en: Keep your systems updated, especially if you're running a PHP-based content
    management system such as WordPress. (If you keep up with the IT security news,
    you'll see stories about WordPress vulnerabilities more often than you'd like
    to.)
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保持系统更新，特别是如果你正在运行基于PHP的内容管理系统，比如WordPress。（如果你关注IT安全新闻，你会发现关于WordPress漏洞的报道比你想象的要频繁。）
- en: There are other scan options, which you can see by just typing `nikto` at the
    command line. For now though, this is enough to get you started with basic web
    server scanning.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他的扫描选项，你可以在命令行中输入`nikto`来查看。不过，现在这些已经足够让你开始进行基本的Web服务器扫描了。
- en: Summary
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: We've reached yet another milestone in our journey, and we saw some cool stuff.
    We started with a discussion about the basics of setting up Snort as a NIDS. I
    then showed you how to seriously cheat by deploying specialty Linux distros that
    already have Snort set up and ready to go.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经在我们的旅程中达到了又一个里程碑，并且看到了一些很酷的东西。我们从讨论设置Snort作为NIDS的基础知识开始。然后我向你展示了如何通过部署已经设置好并准备就绪的专业Linux发行版来严重作弊。
- en: Next, I introduced you to Lynis and how you can use it to scan your system for
    various vulnerabilities and compliance issues. Finally, we wrapped things up with
    working demos of OpenVAS and Nikto.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我向你介绍了Lynis以及如何使用它来扫描系统中的各种漏洞和合规性问题。最后，我们通过OpenVAS和Nikto的实际演示结束了这一切。
- en: In the next chapter, we'll wind up this whole journey with a look at some quick
    tips for busy administrators. I'll see you there.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将以一些忙碌管理员的快速提示来结束整个旅程。我会在那里见到你。
