- en: Chapter 9. Customizing IPCop
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第9章。定制IPCop
- en: IPCop is one of the most full-featured SOHO firewalls on the market and by now
    you should be familiar with most of the features, but you may have noticed some
    shortfalls. There may be areas where IPCop doesn't perform a function in exactly
    the right way or doesn't have a specific function we require. So what can we do?
    We can customize IPCop with some essential addons.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: IPCop是市场上功能最齐全的SOHO防火墙之一，到目前为止，您应该已经熟悉了大部分功能，但您可能已经注意到了一些不足之处。也许有一些地方IPCop没有以恰当的方式执行某个功能，或者没有我们需要的特定功能。那么我们该怎么办呢？我们可以使用一些必要的插件来定制IPCop。
- en: Addons
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 插件
- en: At its core IPCop is a collection of Linux-based tools held together with impressive
    script-based glue. So it's not surprising that we can modify, extend, and improve
    the system to suit our needs. This is where the community part of open-source
    software becomes important as we find that users of the system have developed
    a variety of addons that can be installed and used on IPCop.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在其核心，IPCop是一组基于Linux的工具，通过令人印象深刻的基于脚本的粘合剂粘合在一起。因此，毫不奇怪，我们可以修改、扩展和改进系统以满足我们的需求。这就是开源软件社区部分变得重要的地方，因为我们发现系统的用户已经开发了各种插件，可以安装和使用在IPCop上。
- en: Addons are generally developed by third parties, i.e. people other than the
    IPCop developers. They are usually developed in order to fill some gap that a
    user found with the software, and then released so that other users can benefit
    from the work and solve similar problems.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 插件通常由第三方开发，即IPCop开发人员以外的人。它们通常是为了填补用户在软件中发现的某些空白而开发的，然后发布，以便其他用户可以从这项工作中受益并解决类似的问题。
- en: 'We will take a look at some of the common addons, what they offer, and how
    we can use them. We can find links to the addons on the IPCop website: [http://ipcop.org/modules.php?op=modload&name=phpWiki&file=index&pagename=IPCopAddons](http://ipcop.org/modules.php?op=modload&name=phpWiki&file=index&pagename=IPCopAddons).'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将查看一些常见的插件，它们提供了什么，以及我们如何使用它们。我们可以在IPCop网站上找到插件的链接：[http://ipcop.org/modules.php?op=modload&name=phpWiki&file=index&pagename=IPCopAddons](http://ipcop.org/modules.php?op=modload&name=phpWiki&file=index&pagename=IPCopAddons)。
- en: Firewall Addons Server
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 防火墙插件服务器
- en: Firewall addons server allows us a simple, user-friendly and web-based system
    for managing some addons to IPCop. It is necessary to install this in order to
    use the addons in this chapter.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 防火墙插件服务器允许我们使用简单、用户友好和基于Web的系统来管理一些IPCop的插件。为了在本章中使用插件，有必要安装它。
- en: We can download the firewall addons server package from [http://firewalladdons.sourceforge.net/](http://firewalladdons.sourceforge.net/).
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从[http://firewalladdons.sourceforge.net/](http://firewalladdons.sourceforge.net/)下载防火墙插件服务器包。
- en: 'At the time of writing we shall be using the file: [http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/addons-2.3-CLI-b2.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/addons-2.3-CLI-b2.tar.gz)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本文时，我们将使用文件：[http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/addons-2.3-CLI-b2.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/addons-2.3-CLI-b2.tar.gz)
- en: For later versions this location may change and the following commands relating
    to the filename should be altered to reflect the name of the file downloaded.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对于以后的版本，此位置可能会更改，与文件名相关的以下命令应更改以反映下载文件的名称。
- en: First we copy this file to the server using the `scp` command specifying port
    222, which is the IPCop default for SSH access, and specify the root user.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们使用`scp`命令将此文件复制到服务器，指定端口222，这是IPCop默认的SSH访问端口，并指定root用户。
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We will be prompted for the password for the root account, which is the password
    we set when installing the IPCop machine.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将被提示输入root帐户的密码，这是我们在安装IPCop机器时设置的密码。
- en: Now with the file in place we can log in to the IPCop machine and set it up.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 现在文件已经就位，我们可以登录IPCop机器并对其进行设置。
- en: '[PRE1]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Note
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**P versus p**'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '**P与p**'
- en: Notice that a lowercase `-p` is used for the port with `ssh`, and an uppercase
    `-P` with `scp`. This discrepancy can become quite annoying and can lead to hard-to-spot
    typos. If you can't get a connection, check if you are using the correct case
    for the command.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，使用`ssh`时小写`-p`用于端口，而使用`scp`时大写`-P`用于端口。这种差异可能会变得非常恼人，并且可能导致难以发现的拼写错误。如果无法连接，请检查您是否对命令使用了正确的大小写。
- en: 'After entering the root password we should see the following prompt:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 输入root密码后，我们应该看到以下提示：
- en: '[PRE2]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We now type the following commands to set up the addons server:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们输入以下命令来设置插件服务器：
- en: '[PRE3]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: After the commands complete, we log in to the IPCop web interface and should
    see an addition to the menu along the top of the page.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 命令完成后，我们登录到IPCop Web界面，应该会看到页面顶部的菜单中新增了一个选项。
- en: '![Firewall Addons Server](img/1361_09_01.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![防火墙插件服务器](img/1361_09_01.jpg)'
- en: We will take a look at the few new pages our web interface now has, and the
    added options they offer.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将查看我们的Web界面现在具有的一些新页面，以及它们提供的附加选项。
- en: The **ADDONS-NEWS** page shows updates about the firewall addons server and
    the addons it provides. There are no configuration options here other than how
    much news we would like to see. It serves as a general information page using
    important news downloaded from the addons website.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**ADDONS-NEWS**页面显示有关防火墙插件服务器及其提供的插件的更新。除了我们想要查看多少新闻之外，这里没有配置选项。它作为一个通用信息页面，使用从插件网站下载的重要新闻。'
- en: '![Firewall Addons Server](img/1361_09_02.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![防火墙插件服务器](img/1361_09_02.jpg)'
- en: The **ADDONS** page gives information about the addons installed and current
    addons available, and allows us to install or remove addons.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**ADDONS**页面提供有关已安装的插件和当前可用的插件的信息，并允许我们安装或删除插件。'
- en: '![Firewall Addons Server](img/1361_09_03.jpg)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![防火墙插件服务器](img/1361_09_03.jpg)'
- en: The **ADDONS-UPDATE** page gives us information on updates for addons in much
    the same way as the **ADDONS** page did about the addons themselves, showing what
    is available, and providing us with a method for installing updates.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '**ADDONS-UPDATE**页面向我们提供有关插件更新的信息，方式与**ADDONS**页面提供有关插件本身的信息相似，显示可用内容，并为我们提供了安装更新的方法。'
- en: '![Firewall Addons Server](img/1361_09_04.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![防火墙插件服务器](img/1361_09_04.jpg)'
- en: Installing Addons
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装插件
- en: Now that we are familiar with the interface of the firewall addons server, we
    can start installing and using addons. We will begin with SquidGuard, which as
    you might have noticed was installed in the previous screenshots. To install an
    addon we go to the **ADDONS** page and scroll down until we see the addon we would
    like to install. We then click on the **Info** hyperlink on the right-hand side,
    which takes us to a detailed information and download page for the addon. In the
    case of SquidGuard this page is [http://firewalladdons.sourceforge.net/squidguard.html](http://firewalladdons.sourceforge.net/squidguard.html).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们熟悉了防火墙附加组件服务器的界面，我们可以开始安装和使用附加组件。我们将从SquidGuard开始，你可能已经注意到它在之前的截图中已经安装了。要安装附加组件，我们转到**附加组件**页面，向下滚动直到看到我们想要安装的附加组件。然后点击右侧的**信息**超链接，这将带我们到附加组件的详细信息和下载页面。对于SquidGuard，这个页面是[http://firewalladdons.sourceforge.net/squidguard.html](http://firewalladdons.sourceforge.net/squidguard.html)。
- en: 'On this page we get detailed information on the plug-in and are provided with
    download links to the current version; at the time of writing this was: [http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/SquidGuard-1.2.0-GUI-b11.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/SquidGuard-1.2.0-GUI-b11.tar.gz).
    This may well be updated, and so check the earlier link first!'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个页面上，我们可以获得有关插件的详细信息，并提供当前版本的下载链接；在撰写本文时，当前版本是：[http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/SquidGuard-1.2.0-GUI-b11.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/SquidGuard-1.2.0-GUI-b11.tar.gz)。这可能会更新，因此首先检查之前的链接！
- en: We download the addon, which comes in a GZIPPED TAR archive. We then go back
    to the **ADDONS** page, click the **Browse** button, browse to the file we just
    downloaded, click **Upload**, and the addon is installed on the server.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 我们下载附加组件，它以一个GZIPPED TAR存档的形式提供。然后我们返回到**附加组件**页面，点击**浏览**按钮，浏览到我们刚下载的文件，点击**上传**，附加组件就安装到服务器上了。
- en: Note
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'Caution: Sometimes when uploading an addon, especially those such as SquidGuard
    that restart the web server, we don''t have the page being refreshed automatically
    and/or the connection might time out. Hitting **Refresh**, or **Stop** then **Refresh**
    in the browser should bring us back to the **ADDONS** page.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：有时在上传附加组件时，特别是像SquidGuard这样会重新启动Web服务器的附加组件，我们可能没有页面自动刷新和/或连接可能会超时。点击**刷新**，或者在浏览器中点击**停止**然后**刷新**应该会把我们带回**附加组件**页面。
- en: The process is similar for all other addons that are installed with the firewall
    addons server, and so there is no need for us to repeat the steps later on, when
    we look at other addons and how they work.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 对于使用防火墙附加组件服务器安装的所有其他附加组件，流程是相似的，因此当我们查看其他附加组件及其工作原理时，我们无需重复这些步骤。
- en: Common Addons
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 常见附加组件
- en: We will now have a look at the configuration of some of the more common addons
    and how they are used. Since we have SquidGuard installed already, we can begin
    with this addon. We won't cover all of the addons in this text as they are quite
    numerous. We will, however, cover the most common and substantial ones. It's recommended
    that we at least familiarize ourselves with the other addons available, as they
    may fill a requirement we might later come to recognize.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将查看一些常见附加组件的配置以及它们的使用方式。由于我们已经安装了SquidGuard，我们可以从这个附加组件开始。我们不会在本文中涵盖所有的附加组件，因为它们相当多。但是，我们将涵盖最常见和重要的附加组件。建议我们至少熟悉其他可用的附加组件，因为它们可能满足我们以后可能认识到的需求。
- en: SquidGuard
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SquidGuard
- en: SquidGuard is a content-filtering plug-in, which can be installed with Squid.
    It is used primarily to block unsuitable content from the Web and can be configured
    with a dynamic set of rules, which include blanket bans of various subjects and/or
    black- and white-listing of sites depending on their perceived suitability for
    the audience on our network.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: SquidGuard是一个内容过滤插件，可以与Squid一起安装。它主要用于阻止不适当的网络内容，并可以配置一组动态规则，包括对各种主题的全面禁止和/或根据它们对我们网络上的受众的适用性进行黑名单和白名单设置。
- en: 'The SquidGuard configuration screen looks like this:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: SquidGuard配置屏幕如下：
- en: '![SquidGuard](img/1361_09_05.jpg)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![SquidGuard](img/1361_09_05.jpg)'
- en: As we can see, we can filter on a variety of subjects, which are pre-defined
    in the SquidGuard configuration.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所看到的，我们可以根据SquidGuard配置中预定义的各种主题进行过滤。
- en: In the screenshot above, we have chosen to filter advertisements, porn, violence,
    and gambling related sites from our network.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的截图中，我们选择了过滤广告、色情、暴力和赌博相关网站。
- en: We have also configured a few other options to aid in controlling our network
    usage. We have determined that the machine at IP address **10.0.0.201** is a privileged
    machine (possibly our own or an administrator's machine), which is allowed to
    bypass the filters and access sites indiscriminately. **10.0.0.202** is in the
    **Banned IP range** and is a machine that isn't allowed to access any resources
    on the Internet through this web proxy. The **Network IP Range** denotes all other
    users on the network that will be subjected to the other rules configured earlier.
    Notice that the **Network IP Range** includes machines **200-250**; all the other
    ranges can be specified similarly allowing us to include more than one IP address
    in the rule if necessary.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还配置了一些其他选项来帮助控制我们的网络使用。我们已经确定IP地址为**10.0.0.201**的机器是一个特权机器（可能是我们自己或管理员的机器），允许它绕过过滤器并无差别地访问网站。**10.0.0.202**处于**被禁止的IP范围**，是一台不允许通过这个Web代理访问任何互联网资源的机器。**网络IP范围**表示网络上的所有其他用户将受到之前配置的其他规则的约束。请注意，**网络IP范围**包括机器**200-250**；所有其他范围可以类似地指定，允许我们在必要时在规则中包含多个IP地址。
- en: 'We also have some other important and powerful configuration options here.
    If we allow white-listing and then click on the **Edit** box, we see the following
    screen:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还有一些其他重要和强大的配置选项。如果我们允许白名单，然后点击**编辑**框，我们会看到以下屏幕：
- en: '![SquidGuard](img/1361_09_06.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![SquidGuard](img/1361_09_06.jpg)'
- en: By entering a URL and clicking **Add** we allow access to this domain regardless
    of any other rules in place. In this case the URL [www.reboot-robot.net](http://www.reboot-robot.net)
    has been white-listed.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 通过输入URL并单击**添加**，我们允许访问该域，而不管其他规则如何。在这种情况下，URL [www.reboot-robot.net](http://www.reboot-robot.net)
    已被列入白名单。
- en: The blacklist configuration screen is exactly the same and any domains listed
    there are blocked by SquidGuard except the privileged IP addresses.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 黑名单配置屏幕与之前完全相同，列出的任何域都将被SquidGuard阻止，除了特权IP地址。
- en: Other than the direct configuration of what to block and not to block, we have
    some other options that require some explanation.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 除了直接配置要阻止和不要阻止的内容之外，我们还有一些其他需要解释的选项。
- en: '**Enable Logging:** Allows us to log connections allowed and denied by SquidGuard'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启用日志记录：**允许我们记录SquidGuard允许和拒绝的连接'
- en: '**Enable Ad Logging:** Allows more detailed logging of the advertisements blocked'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启用广告日志记录：**允许更详细地记录被阻止的广告'
- en: '**Mail Logs:** Log information on mail passing through the firewall'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**邮件日志：**记录通过防火墙的邮件信息'
- en: '**Automatic Update:** Download automatic updates of URLs for blocking from
    the SquidGuard website'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动更新：**从SquidGuard网站下载用于阻止的URL的自动更新'
- en: '**Mail Server:** Server to be used when sending mail to the administrator'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**邮件服务器：**发送邮件给管理员时要使用的服务器'
- en: '**Administrator Email:** The email address to send logs to'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理员电子邮件：发送日志的电子邮件地址
- en: '**Mail username:** Username to be used if mail server requires authentication'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**邮件用户名：**如果邮件服务器需要身份验证，则使用的用户名'
- en: '**Mail Password:** Password to be used as earlier'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**邮件密码：**之前使用的密码'
- en: Note
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Mail Settings**'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**邮件设置**'
- en: You will notice these mail settings as part of any addon that offers communication
    with a network administrator. It's worth keeping this information handy and possibly
    creating an email account/address specifically for our IPCop machine.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 您将注意到这些邮件设置作为任何提供与网络管理员通信的插件的一部分。值得随时保留这些信息，并可能专门为我们的IPCop机器创建一个电子邮件帐户/地址。
- en: The only boxes that are required on this page are our **Network IP Range** and
    our **Administrator Email**; everything else can be configured optionally (optional
    fields have a blue star beside them).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 此页面上唯一需要的框是我们的**网络IP范围**和我们的**管理员电子邮件**；其他所有内容都可以选择配置（可选字段旁边有蓝色星号）。
- en: At the bottom of the page we have the **Start/Restart SquidGuard** button, which
    is (admittedly non-intuitively) to be used when we have configured the service
    to our needs, and want the configuration saved and used on the running machine.
    The **Update Blacklists** button allows us to download updated blacklists for
    the content-filtering options.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在页面底部，我们有**启动/重新启动SquidGuard**按钮，当我们已经根据需要配置了服务，并希望保存和在运行的机器上使用配置时，可以使用该按钮（诚然，这并不直观）。**更新黑名单**按钮允许我们下载更新的黑名单以供内容过滤选项使用。
- en: After configuring SquidGuard, we should now have an effective content filtering
    system to help ensure that users on the network don't access websites considered
    undesirable.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完SquidGuard后，我们现在应该有一个有效的内容过滤系统，以确保网络上的用户不会访问被认为是不良的网站。
- en: 'What if we want to monitor as well as control? The attentive reader might have
    realized while we enabled the logging options that there should be access to these
    logs, possibly in the web interface. If we move the mouse above **Logs**, sure
    enough we see **SquidGuard Logs**; clicking on this will give us:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们想要监视并控制怎么办？细心的读者可能已经意识到，当我们启用日志选项时，可能应该有访问这些日志的权限，可能是在Web界面中。如果我们将鼠标移动到**日志**上方，我们确实会看到**SquidGuard日志**；点击这将给我们：
- en: '![SquidGuard](img/1361_09_07.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![SquidGuard](img/1361_09_07.jpg)'
- en: This allows us to view the SquidGuard logs in an interface similar to the default
    logs on the system.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这使我们能够在类似于系统上默认日志的界面中查看SquidGuard日志。
- en: Enhanced Filtering
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 增强过滤
- en: The Enhanced Filtering addon is one of the most useful addons and addresses
    what is one feature that IPCop is sorely lacking by default. A default installation
    of IPCop will allow all traffic outbound from the Green interface to the other
    interfaces without any filtering. It's often desirable to control the ports and
    IP addresses that a user can access from the Green interface. For example, we
    may want to block all outbound connections except those to the ports websites
    run on. This would allow for default blocking of peer-to-peer filesharing programs
    and instant messaging programs. This is the preferred default setup for a firewall,
    which we discussed in[Chapter 3](ch03.html "Chapter 3. Deploying IPCop and Designing
    a Network"). Enhanced Filtering also allows for MAC-based filtering of the wireless
    connection.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 增强过滤插件是最有用的插件之一，它解决了IPCop默认严重缺乏的一个功能。IPCop的默认安装将允许从绿色接口到其他接口的所有流量出站，而没有任何过滤。通常希望控制用户可以从绿色接口访问的端口和IP地址。例如，我们可能希望阻止除网站运行的端口之外的所有出站连接。这将允许默认阻止点对点文件共享程序和即时通讯程序。这是防火墙的首选默认设置，我们在[第3章](ch03.html
    "第3章。部署IPCop和设计网络")中讨论过。增强过滤还允许对无线连接进行基于MAC的过滤。
- en: Note
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Port and IP-Based Blocks Aren''t Completely Effective**'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '**基于端口和IP的阻止并不完全有效**'
- en: Be aware that blocking the port an application is using doesn't prevent users
    using that application on another port or through a proxy server located outside
    the IPCop protected network. Similarly IP-based blocks can be overcome by using
    proxies. Application-layer filtering adds to this protection, but without stringent
    control of the internal resources on the network, most network-level filtering
    mechanisms can be bypassed.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，阻止应用程序使用的端口并不会阻止用户在另一个端口或通过位于IPCop受保护网络之外的代理服务器上使用该应用程序。同样，使用代理可以克服基于IP的阻止。应用层过滤增加了这种保护，但如果没有对网络上的内部资源进行严格控制，大多数网络级别的过滤机制都可以被绕过。
- en: 'For more information refer to the Enhanced Filtering web page: [http://firewalladdons.sourceforge.net/filtering.html](http://firewalladdons.sourceforge.net/filtering.html).'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 有关更多信息，请参阅增强过滤网页：[http://firewalladdons.sourceforge.net/filtering.html](http://firewalladdons.sourceforge.net/filtering.html)。
- en: 'The version used at the time of writing was downloaded from the following URL
    and is installed in a manner similar to SquidGuard:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写时使用的版本是从以下URL下载的，并且安装方式类似于SquidGuard：
- en: '[http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/EnhancedFiltering-1.0-GUI-b2.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/EnhancedFiltering-1.0-GUI-b2.tar.gz)'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/EnhancedFiltering-1.0-GUI-b2.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/EnhancedFiltering-1.0-GUI-b2.tar.gz)'
- en: The following figure shows the Enhanced Filtering configuration screen, which
    can be accessed by clicking on **Firewall | Enhanced Filtering:**
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图显示了增强过滤配置屏幕，可以通过单击**防火墙|增强过滤：**来访问：
- en: '![Enhanced Filtering](img/1361_09_08.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![增强过滤](img/1361_09_08.jpg)'
- en: Here we can **Enable enhanced filtering** or **Disable** it as well as **Set
    default deny on GREEN** network interface. We discussed default deny when we introduced
    firewalls, and why it's an easier-to-manage and more secure setup.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以**启用增强过滤**或**禁用**它，以及**在GREEN网络接口上设置默认拒绝**。当我们介绍防火墙时，我们讨论了默认拒绝以及为什么它是一种更易管理和更安全的设置。
- en: We can also add specific rules to the firewall for connections between networks.
    We have to provide the source and destination IP addresses, source netmask and
    destination netmask, network, and the destination port.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以为网络之间的连接添加特定的防火墙规则。我们必须提供源和目标IP地址，源子网掩码和目标子网掩码，网络和目标端口。
- en: An example would be allowing only our mailserver to connect outwards to our
    ISP's mailserver in order to relay mail for the network. We would specify the
    **Source IP** address as that of our mail server and the **Destination IP** address
    as that of the ISP's mailserver, also setting the port to **25**. This means that
    our mail server can relay mail to the ISP but no other machines on the network
    can. This would help prevent our users using outside mail accounts, and prevent
    machines with malware sending copies of the malware or spam out, without passing
    through our mail server and potentially mail filtering software.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 一个例子是只允许我们的邮件服务器向我们的ISP邮件服务器发出邮件，以便为网络中继邮件。我们将指定**源IP**地址为我们的邮件服务器的IP地址，**目标IP**地址为ISP的邮件服务器的IP地址，并设置端口为**25**。这意味着我们的邮件服务器可以向ISP中继邮件，但网络上的其他机器不能。这将有助于防止我们的用户使用外部邮件帐户，并防止带有恶意软件的机器发送恶意软件或垃圾邮件，而不经过我们的邮件服务器和潜在的邮件过滤软件。
- en: The main advantage as we can now see is that we can control very specifically
    which servers and services on those servers our local network machines can access,
    which is functionality that IPCop itself doesn't provide by default.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们现在所看到的，主要优势是我们可以非常具体地控制本地网络机器可以访问哪些服务器和这些服务器上的服务，这是IPCop本身默认不提供的功能。
- en: Blue Access
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 蓝色访问
- en: Another option provided by the Enhanced Filtering addon is the ability to filter
    the Blue (wireless) interface based on IP address and MAC address. This is a crude
    but fairly effective way of limiting access to the wireless interface to machines
    with a specific MAC address. A MAC address is unique to a Network Interface Card
    and is a fairly useful method for identifying a card. MAC address filtering is
    by no means an alternative to encrypting the wireless connection, but is a useful
    secondary measure.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 增强过滤插件提供的另一个选项是根据IP地址和MAC地址过滤蓝色（无线）接口。这是一种粗糙但相当有效的方法，可以限制对具有特定MAC地址的机器的无线接口的访问。MAC地址是唯一的网络接口卡，并且是识别卡的相当有用的方法。MAC地址过滤绝不是加密无线连接的替代方法，但是是一个有用的辅助措施。
- en: Note
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**MAC Spoofing**'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: MAC欺骗
- en: MAC addresses are easily spoofed with tools existing for most common OSs to
    modify the MAC address of a NIC. The MAC address isn't modified in the device
    itself, but in the operating system. Linux, for example, can do this with its
    default network configuration tool `ifconfig`, and many tools exist for Windows
    to accomplish the same task. There is an addon for IPCop that provides MAC spoofing
    functionality in the GUI for the Red interface.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: MAC地址很容易被欺骗，大多数常见操作系统都有工具来修改网卡的MAC地址。MAC地址并不是在设备本身中修改，而是在操作系统中修改。例如，Linux可以使用其默认网络配置工具`ifconfig`来做到这一点，而Windows存在许多工具来完成相同的任务。IPCop有一个插件，可以在GUI中为红色接口提供MAC欺骗功能。
- en: The **Blue Access** configuration screen can be accessed by clicking **Firewall
    | Blue Access:**
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**蓝色访问**配置屏幕可以通过单击**防火墙|蓝色访问：**来访问。'
- en: '![Blue Access](img/1361_09_09.jpg)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![蓝色访问](img/1361_09_09.jpg)'
- en: The **Source IP** and **Source MAC Address** are filled with the information
    of the machine being allowed to access the network from this interface, and when
    the **Enabled** checkbox is ticked, only the machines that match the list will
    be allowed to access any network resources. The machines in the **Devices on Blue**
    list are those that have been allowed access.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 源IP和源MAC地址填充了被允许从这个接口访问网络的机器的信息，当启用复选框被勾选时，只有匹配列表的机器才能访问任何网络资源。蓝色设备列表中的机器是已被允许访问的机器。
- en: LogSend
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: LogSend
- en: LogSend is an addon that allows us to send logs from the IPCop machine to various
    administrators and/or to the DShield service. This is useful as it allows deeper
    analysis of our logs using external tools, without configuring a syslog server.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: LogSend是一个插件，允许我们将日志从IPCop机器发送到各种管理员和/或DShield服务。这很有用，因为它允许我们使用外部工具更深入地分析我们的日志，而无需配置syslog服务器。
- en: 'The LogSend web page is found at: [http://firewalladdons.sourceforge.net/logsend.html](http://firewalladdons.sourceforge.net/logsend.html).'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: LogSend网页位于：[http://firewalladdons.sourceforge.net/logsend.html](http://firewalladdons.sourceforge.net/logsend.html)。
- en: 'The current version used at time of writing is: [http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/Logsend-1.0-GUI-b3.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/Logsend-1.0-GUI-b3.tar.gz).'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 撰写时使用的当前版本是：[http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/Logsend-1.0-GUI-b3.tar.gz](http://heanet.dl.sourceforge.net/sourceforge/firewalladdons/Logsend-1.0-GUI-b3.tar.gz)。
- en: The **LogSend Configuration** page is accessed by clicking **Logs | LogSend**.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '**LogSend配置**页面通过单击**日志 | LogSend**访问。'
- en: '![LogSend](img/1361_09_10.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![LogSend](img/1361_09_10.jpg)'
- en: The configuration for **LogCheck** is relatively simple; we can choose to enable
    the service, enable mailing of **DansGuardian** (provided by the Cop+ addon) logs,
    **Proxy** logs, and **Snort** logs. Each of these could go to a different administrator
    but it's very common for the same email address to be used in each as shown in
    the figure above.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '**LogCheck**的配置相对简单；我们可以选择启用服务，启用**DansGuardian**（由Cop+插件提供）日志、**代理**日志和**Snort**日志的邮件发送。每个日志都可以发送到不同的管理员，但通常会使用相同的电子邮件地址，如上图所示。'
- en: Note
  id: totrans-99
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**DShield**'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '**DShield**'
- en: 'The **DShield** option may need some explanation. DShield ([http://www.dshield.org](http://www.dshield.org))
    is a service proved by SANS (System Administration, Networking, and Security Institute:
    [http://www.sans.org](http://www.sans.org)). It collates and analyses logs from
    thousands of systems around the world in order to get details on the most commonly
    attacked ports and the worst offending attacking IP addresses. This is in an effort
    to allow system administrators to be aware of the current state of the Internet
    at any point in time. Any logs sent to DShield will be added to this database,
    and if we sign up for a DShield account (not required for sending logs), we can
    also use its online analyzing tools to monitor the data from our own Intrusion
    Protection Systems.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**DShield**选项可能需要一些解释。DShield ([http://www.dshield.org](http://www.dshield.org))
    是由SANS（系统管理、网络和安全研究所：[http://www.sans.org](http://www.sans.org)）提供的服务。它汇总和分析来自世界各地数千个系统的日志，以获取关于最常被攻击的端口和最严重的攻击IP地址的详细信息。这是为了让系统管理员随时了解互联网的当前状态。发送到DShield的任何日志都将添加到该数据库中，如果我们注册了DShield帐户（发送日志不需要），我们还可以使用其在线分析工具来监视来自我们自己的入侵保护系统的数据。'
- en: The DShield configuration function in LogSend enables easy use of the DShield
    service so that we can send our logs. All that is required is we enable DShield,
    and set a time zone and a return email address to use when sending the logs. If
    we also provide our user ID, we can ensure that the logs are attributed to our
    account and available to us on the DShield web interface. The **DShield Administrator**
    is the address to which any log information will be sent.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: LogSend中的DShield配置功能使我们可以轻松使用DShield服务发送我们的日志。所需的只是启用DShield，并设置发送日志时使用的时区和返回电子邮件地址。如果我们还提供我们的用户ID，我们可以确保日志归属于我们的帐户，并在DShield
    Web界面上可用。**DShield管理员**是任何日志信息将被发送到的地址。
- en: We also have the familiar mailserver options where we can provide the mailserver
    to use, the sender, and any authentication credentials required. We have seen
    these options in other areas of IPCop.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还有熟悉的邮件服务器选项，可以提供要使用的邮件服务器、发件人和所需的任何身份验证凭据。我们在IPCop的其他领域也看到了这些选项。
- en: Copfilter
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Copfilter
- en: Copfilter extends IPCop from a firewall into a security appliance similar to
    those provided by Symantec and MacAfee, which attempt to protect our network from
    all manner of malware. Copfilter will monitor web, FTP, and email traffic in order
    to detect and block malware it finds within the data.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: Copfilter将IPCop从防火墙扩展为类似于Symantec和MacAfee提供的安全设备，试图保护我们的网络免受各种恶意软件的侵害。Copfilter将监视Web、FTP和电子邮件流量，以便检测并阻止其中发现的恶意软件。
- en: 'The Copfilter web page is: [http://www.copfilter.org](http://www.copfilter.org).'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: Copfilter网页是：[http://www.copfilter.org](http://www.copfilter.org)。
- en: 'The version used at time of writing was: [http://heanet.dl.sourceforge.net/sourceforge/copfilter/copfilter-0.82.tgz](http://heanet.dl.sourceforge.net/sourceforge/copfilter/copfilter-0.82.tgz).'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 撰写时使用的版本是：[http://heanet.dl.sourceforge.net/sourceforge/copfilter/copfilter-0.82.tgz](http://heanet.dl.sourceforge.net/sourceforge/copfilter/copfilter-0.82.tgz)。
- en: Copfilter installation is done directly and not via the addons interface. It
    is installed in much the same way that the firewall addons server was installed.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: Copfilter安装是直接进行的，而不是通过插件界面。它的安装方式与防火墙插件服务器的安装方式非常相似。
- en: '[PRE4]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'We should then see the following output:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们应该看到以下输出：
- en: '[PRE5]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: It gives us a warning that installing Copfilter reconfigures the firewall and
    may alter some of its functionality, possibly reducing security.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 它警告我们安装Copfilter会重新配置防火墙，并可能改变一些功能，可能会降低安全性。
- en: Note
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Complexity and Security**'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '**复杂性和安全性**'
- en: This brings in an important point we should consider when installing addons.
    The more code and features we add to a firewall, the more scope there is for something
    to go wrong. Software bugs lead to crashes and more importantly security compromises.
    It's important to weigh the value given by a feature against the potential risk
    of having additional code in the system before we fill the system up with a variety
    of addons.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这引入了一个重要的观点，我们在安装插件时应该考虑。我们向防火墙添加的代码和功能越多，出现问题的可能性就越大。软件错误会导致崩溃，更重要的是安全妥协。在我们用各种插件填充系统之前，重要的是要权衡功能带来的价值与系统中额外代码的潜在风险。
- en: 'Copfilter should now install, and we will see a few messages scroll by as it
    sets itself up. We should see the following message when Copfilter is completely
    installed:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: Copfilter现在应该安装，当它设置自身时，我们会看到一些消息滚动。当Copfilter完全安装时，我们应该看到以下消息：
- en: '[PRE6]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: If we now log into the web interface, we should see new menu options added to
    the IPCop configuration site. We will have a look at them in the next few sections.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们现在登录到Web界面，我们应该看到新的菜单选项添加到IPCop配置站点。我们将在接下来的几节中看一下它们。
- en: '![Copfilter](img/1361_09_11.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![Copfilter](img/1361_09_11.jpg)'
- en: Status
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 状态
- en: The **Status** screen gives us information on the tools installed with Copfilter
    (yet another collection of powerful tools in a simple package!). You can start
    and stop all services here. By clicking on the **Virus Quarantine** and **Spam
    Quarantine** buttons, you can see the items that have been held there by the scanning
    software.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '**Status**屏幕为我们提供了有关使用Copfilter安装的工具的信息（又一个简单包中强大工具的集合！）。您可以在此处启动和停止所有服务。通过单击**Virus
    Quarantine**和**Spam Quarantine**按钮，您可以查看扫描软件保存的项目。'
- en: '![Status](img/1361_09_12.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![Status](img/1361_09_12.jpg)'
- en: '**monit:** Allows us to monitor the system in more detail than the basic status
    information provided by IPCop, with management of services as an important addition
    ([http://www.tildeslash.com/monit/](http://www.tildeslash.com/monit/)).'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**monit**：允许我们比IPCop提供的基本状态信息更详细地监视系统，管理服务是一个重要的补充（[http://www.tildeslash.com/monit/](http://www.tildeslash.com/monit/)）。'
- en: '**p3Scan:** Proxy server for email (**POP3**) to scan email for malware ([http://p3scan.sourceforge.net/](http://p3scan.sourceforge.net/)).'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: p3Scan：用于扫描恶意软件的电子邮件代理服务器（**POP3**）（[http://p3scan.sourceforge.net/](http://p3scan.sourceforge.net/)）。
- en: '**ProxySMTP:** Similar to **p3scan** but used for scanning SMTP.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: ProxySMTP：类似于**p3scan**，但用于扫描SMTP。
- en: '**HAVP:** Proxy for HTTP, which allows scanning of websites for malware ([http://www.server-side.de/](http://www.server-side.de/)).'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: HAVP：用于HTTP代理，允许扫描网站上的恶意软件（[http://www.server-side.de/](http://www.server-side.de/)）。
- en: '**Privoxy:** Another HTTP proxy, which focuses more on privacy and advertisements
    ([http://www.privoxy.org](http://www.privoxy.org)).'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: Privoxy：另一个HTTP代理，更专注于隐私和广告（[http://www.privoxy.org](http://www.privoxy.org)）。
- en: '**frox:** Transparent FTP proxy, which allows features similar to **HAVP**
    and **Privoxy** against the FTP protocol ([http://frox.sourceforge.net](http://frox.sourceforge.net)).'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: frox：透明的FTP代理，允许针对FTP协议的功能类似于**HAVP**和**Privoxy**（[http://frox.sourceforge.net](http://frox.sourceforge.net)）。
- en: '**Spamassassin:** Extremely powerful and customizable anti-spam software. This
    is one of the most common anti-spam solutions used by ISPs ([http://spamassassin.apache.org/](http://spamassassin.apache.org/)).'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Spamassassin：非常强大和可定制的反垃圾邮件软件。这是ISP常用的反垃圾邮件解决方案之一（[http://spamassassin.apache.org/](http://spamassassin.apache.org/)）。
- en: '**ClamAV:** Antivirus software, used in conjunction with some of the other
    software to provide a virus scanning engine ([http://www.clamav.net/](http://www.clamav.net/)).'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: ClamAV：用于与其他软件配合提供病毒扫描引擎的防病毒软件（[http://www.clamav.net/](http://www.clamav.net/)）。
- en: '**Renattach:** Script that recognizes and renames dangerous email attachments
    such as `.exe, .bat`, and `.pif` so as to prevent users accidentally or unintentionally
    opening dangerous files ([http://freshmeat.net/projects/renattach/](http://freshmeat.net/projects/renattach/)).'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: Renattach：识别和重命名危险的电子邮件附件，如`.exe，.bat`和`.pif`，以防止用户意外或无意中打开危险文件（[http://freshmeat.net/projects/renattach/](http://freshmeat.net/projects/renattach/)）。
- en: '**Rules Du Jour:** Used to keep the SpamAssassin rules up to date ([http://www.exit0.us/index.php?pagename=RulesDuJour](http://www.exit0.us/index.php?pagename=RulesDuJour)).'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: Rules Du Jour：用于保持SpamAssassin规则的最新状态（[http://www.exit0.us/index.php?pagename=RulesDuJour](http://www.exit0.us/index.php?pagename=RulesDuJour)）。
- en: '**P3PMail:** Acts like p3Scan mentioned earlier; however it detects dangerous
    HTML within emails and removes it ([http://www.exit0.us/index.php?pagename=RulesDuJour](http://www.exit0.us/index.php?pagename=RulesDuJour)).'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: P3PMail：类似于前面提到的p3Scan；但是它检测电子邮件中的危险HTML并将其删除（[http://www.exit0.us/index.php?pagename=RulesDuJour](http://www.exit0.us/index.php?pagename=RulesDuJour)）。
- en: Email
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 电子邮件
- en: We want to enable all services for the purpose of this book, but if we try to
    do so now, many of the services will fail because we haven't configured our email
    settings yet. If we click on **Copfilter | Email**, we will be presented with
    the familiar **Email** options screen, which we can fill accordingly.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望为本书的目的启用所有服务，但如果我们现在尝试这样做，许多服务将失败，因为我们尚未配置我们的电子邮件设置。如果我们点击**Copfilter |
    Email**，将会出现熟悉的**Email**选项屏幕，我们可以相应地填写。
- en: '![EmailCopfilterstatus](img/1361_09_13.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![EmailCopfilterstatus](img/1361_09_13.jpg)'
- en: With this filled in, we can start enabling and configuring services.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 填写完这些内容后，我们可以开始启用和配置服务。
- en: Monitoring
  id: totrans-138
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 监控
- en: '**monit** is very easy to set up (in Copfilter) and quite a powerful and dependable
    tool. As the **Monitoring** screen (click **Copfilter | Monitoring**) shows, **monit**
    will constantly monitor running services and will restart any failed services
    within 60 seconds. Stopping a service manually will cause monitoring for that
    service to be switched off. To switch monitoring back on for all services, a restart
    of **monit** itself is required.'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '**monit**在Copfilter中非常容易设置，并且是一个功能强大且可靠的工具。如**Monitoring**屏幕（点击**Copfilter
    | Monitoring**）所示，**monit**将不断监视运行的服务，并将在60秒内重新启动任何失败的服务。手动停止服务将导致该服务的监视被关闭。要为所有服务重新打开监视，需要重新启动**monit**本身。'
- en: We can switch on **monit** in this configuration window. We should switch it
    on just now so that it is available to monitor the other services, so select **On**
    in the drop-down box and click the **Save** button.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在此配置窗口中打开**monit**。我们现在应该打开它，以便它可以监视其他服务，因此在下拉框中选择**On**，然后单击**Save**按钮。
- en: POP3 Filtering
  id: totrans-141
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: POP3过滤
- en: POP3 is a commonly used mail protocol, for receiving mail. If we have users
    pulling email down from an ISP's mail server, then we can configure this screen
    to filter any mail coming in via POP3 and tune it to our needs.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: POP3是常用的邮件协议，用于接收邮件。如果我们有用户从ISP的邮件服务器下载电子邮件，那么我们可以配置此屏幕以通过POP3过滤任何传入的邮件，并根据我们的需求进行调整。
- en: '![POP3 Filtering](img/1361_09_14.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![POP3 Filtering](img/1361_09_14.jpg)'
- en: We should be careful with quarantining email or attachments as this can very
    quickly start to fill space on our hard drive. If we have provisioned a low specification
    machine to use as the IPCop box, then we may have trouble with hard drive space.
    If this begins to cause problems, simply back up the IPCop configuration and reinstall
    on a bigger hard drive.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在隔离电子邮件或附件时，我们应该小心，因为这很快就会开始占用硬盘空间。如果我们为使用IPCop盒子而配置了低规格的机器，那么我们可能会在硬盘空间上遇到问题。如果这开始引起问题，只需备份IPCop配置并重新安装到更大的硬盘上。
- en: Configure this screen as shown in the previous figure and then push the **Save
    settings (and restart services)** button. This will enable POP3 scanning. Notifications
    will be sent to the email address we configured in the email screen earlier.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 按照上一图所示的方式配置此屏幕，然后点击“保存设置（并重新启动服务）”按钮。这将启用POP3扫描。通知将发送到我们在之前的电子邮件屏幕中配置的电子邮件地址。
- en: SMTP Filtering
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SMTP过滤
- en: 'This page at first glance appears the same as the POP3 page but with an SMTP
    slant (and it should be configured identically for our use here). However, as
    we scroll down we see:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 乍一看，这个页面与POP3页面相同，但具有SMTP倾向（在这里我们应该配置相同）。然而，当我们向下滚动时，我们会看到：
- en: '![SMTP Filtering](img/1361_09_15.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![SMTP过滤](img/1361_09_15.jpg)'
- en: This gives us some additional options mostly relating to the email server on
    our network. We discussed previously the use of a DMZ and IPCop using the Orange
    network for the DMZ. If we had our email server in a DMZ, we could configure port
    25 (or port 25 on a specific IP) to be forwarded to our email server. Since this
    is the SMTP filtering section and not the port forwarding section, we could also
    filter all email as it goes through the system before it gets near our server.
    This allows us to protect machines in our DMZ from attack and subsequently protects
    our users as the malware-ridden emails won't ever touch their inbox!
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 这为我们提供了一些额外的选项，主要与我们网络上的电子邮件服务器有关。我们之前讨论过使用DMZ和IPCop使用橙色网络作为DMZ。如果我们的电子邮件服务器在DMZ中，我们可以将端口25（或特定IP上的端口25）配置为转发到我们的电子邮件服务器。由于这是SMTP过滤部分而不是端口转发部分，因此在电子邮件接近我们的服务器之前，我们也可以过滤所有电子邮件。这使我们能够保护我们DMZ中的机器免受攻击，并随后保护我们的用户，因为带有恶意软件的电子邮件永远不会触及他们的收件箱！
- en: The configuration options shown are fairly reasonable levels, unless we require
    whitelisting or have specific quarantining requirements.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 所示的配置选项是相当合理的水平，除非我们需要白名单或具体的隔离要求。
- en: HTTP Filter (and FTP)
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: HTTP过滤（和FTP）
- en: The HTTP filter is among the most resource-intensive features of Copfilter,
    mainly because HTTP traffic involves large files and quite detailed scanning,
    and because HTTP is one of the most popular protocols in use on most networks.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: Copfilter的最消耗资源的功能之一是HTTP过滤，主要是因为HTTP流量涉及大文件和相当详细的扫描，而且HTTP是大多数网络上使用的最流行的协议之一。
- en: '![HTTP Filter (and FTP)](img/1361_09_16.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![HTTP过滤（和FTP）](img/1361_09_16.jpg)'
- en: It's generally a good idea to configure the HTTP proxy as transparent as this
    won't require reconfiguration of the client machines. As noted on this screen,
    this can adversely affect applications passing through the firewall, if the firewall
    becomes very busy. It may not be a good idea to use HTTP filtering on a busy network
    unless the IPCop machine is quite powerful. If you are experiencing slowness when
    using the Internet, disable HTTP filtering as one of the initial troubleshooting
    steps.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 将HTTP代理配置为透明通常是一个好主意，因为这不需要重新配置客户机器。正如在此屏幕上所指出的，如果防火墙变得非常忙碌，这可能会对通过防火墙的应用程序产生不利影响。在繁忙的网络上使用HTTP过滤可能不是一个好主意，除非IPCop机器非常强大。如果在使用互联网时遇到缓慢的情况，请将HTTP过滤禁用为初始故障排除步骤之一。
- en: The FTP filter is very simple to set up and requires merely a switch from off
    to on. It works in much the same way as the transparent HTTP filter. FTP filter
    is less commonly used as it is a much less popular protocol than HTTP and there
    are many other file transfer methods more popular than FTP now.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: FTP过滤器设置非常简单，只需要从关闭切换到打开。它的工作方式与透明HTTP过滤器大致相同。FTP过滤器使用较少，因为它比HTTP协议不太流行，现在有许多其他比FTP更受欢迎的文件传输方法。
- en: AntiSPAM
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 反垃圾邮件
- en: In addition to fighting malware, we also have a constant battle against the
    deluge of spam landing in our mailbox daily. Luckily the Copfilter options for
    spam are relatively simple.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 除了与恶意软件作斗争，我们还在每天邮箱中不断地与垃圾邮件的泛滥作斗争。幸运的是，Copfilter对垃圾邮件的选项相对简单。
- en: '![AntiSPAM](img/1361_09_17.jpg)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![反垃圾邮件](img/1361_09_17.jpg)'
- en: Once enabled, we can configure the score at which to consider an email as spam.
    Each message is checked for various spam-like traits; the more traits it has,
    the higher the score it gets. If we set this threshold too high, then we will
    allow some spam through, and if we set it too low, we increase the chances of
    false positives. The default works remarkably well and should be used unless a
    large volume of spam is getting through. We can also configure Bayesian filtering
    on this page. However this can be very resource intensive and it's not recommended
    on a box that is also providing many other functions. Turning **on** German rules
    will prevent German language spam coming through the filter; this is provided
    due to a large increase of spam being sent out in German. The option for **Razor,
    DCC, DNSBL** enables blocking based on databases of known spamming sites, these
    can be fairly large and as noted on the configuration screen they may decrease
    performance.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦启用，我们可以配置将电子邮件视为垃圾邮件的分数。每条消息都会被检查是否具有各种类似垃圾邮件的特征；它具有的特征越多，得分就越高。如果我们将此阈值设置得太高，那么我们将允许一些垃圾邮件通过，如果设置得太低，我们增加了误报的机会。默认设置效果非常好，应该使用，除非有大量垃圾邮件通过。我们还可以在此页面上配置贝叶斯过滤。但是这可能会消耗大量资源，不建议在提供许多其他功能的盒子上使用。打开德国规则将阻止德语垃圾邮件通过过滤器；这是因为最近发送的垃圾邮件大量使用德语。启用**Razor,
    DCC, DNSBL**选项将基于已知垃圾邮件站点的数据库进行阻止，这些数据库可能相当大，并且如配置屏幕上所述，它们可能会降低性能。
- en: AntiVirus
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 反病毒
- en: ClamAV is very commonly used on Linux systems as a virus scanner. However, it
    covers viruses from a variety of operating systems and obviously its largest signature
    database relates to the Windows platform. So it is excellent for protecting Windows
    clients on the network from virus attacks. ClamAV is used as the scanning engine
    for the other tools in Copfilter, and so is already enabled by the time we get
    to it because the other services are using it.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: ClamAV在Linux系统上非常常用作病毒扫描器。然而，它涵盖了各种操作系统的病毒，显然其最大的签名数据库与Windows平台相关。因此，它非常适合保护网络上的Windows客户端免受病毒攻击。ClamAV被用作Copfilter中其他工具的扫描引擎，因此当我们使用它时，其他服务已经在使用它了。
- en: '![AntiVirus](img/1361_09_18.jpg)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![防病毒](img/1361_09_18.jpg)'
- en: We may want to tweak when the automatic updates are applied as well as perform
    manual updates of ClamAV, especially shortly after installation. We can also add
    other file extensions to the `renattach` configuration file from this menu such
    as WMF. These files will be renamed so as to have an extension that won't execute
    automatically with a double-click.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能希望调整自动更新的应用时间，以及在安装后不久执行ClamAV的手动更新。我们还可以从这个菜单中向`renattach`配置文件添加其他文件扩展名，比如WMF。这些文件将被重命名，以便不会因为双击而自动执行。
- en: Note
  id: totrans-164
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**WMF and Media File Vulnerabilities**'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '**WMF和媒体文件漏洞**'
- en: Recently there was a very serious and highly publicized vulnerability in Microsoft
    Windows, which could be exploited if the user viewed an image in WMF format. This
    highlighted the often-ignored fact that not just executable files can contain
    executable code.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 最近，微软Windows出现了一个非常严重且备受关注的漏洞，如果用户查看WMF格式的图像，就可以利用这个漏洞。这突显了一个经常被忽视的事实，不仅可执行文件可以包含可执行代码。
- en: Tests and Logs
  id: totrans-167
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测试和日志
- en: The Copfilter addon has its own area for logs, sadly choosing to shy away from
    adding options to the **Logs** menu as other addons do. In this area we can view
    and download a variety of logs in various formats; however, they are too numerous
    to warrant coverage in this text. The logs are relatively easy to read and understand,
    and the documentation on the websites of the projects mentioned earlier will give
    more information on these.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: Copfilter插件有自己的日志区域，遗憾的是选择不像其他插件那样在**日志**菜单中添加选项。在这个区域，我们可以查看和下载各种格式的日志；然而，它们太多了，不值得在这篇文章中进行覆盖。日志相对容易阅读和理解，而前面提到的项目网站上的文档将提供更多关于这些日志的信息。
- en: Three other important functions here are the test buttons.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 这里还有三个重要的功能是测试按钮。
- en: '**Send Test Virus Email:** This button sends an email with the EICAR test virus.'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**发送测试病毒邮件：** 这个按钮发送一封带有EICAR测试病毒的邮件。'
- en: Note
  id: totrans-171
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**EICAR**'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '**EICAR**'
- en: EICAR is a test virus definition that all antivirus software recognizes. It's
    used as a calibration tool to ensure that our anti-virus solution is working without
    having to send a virus through our network.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: EICAR是一个测试病毒定义，所有防病毒软件都能识别。它被用作校准工具，以确保我们的防病毒解决方案在不必通过网络发送病毒的情况下工作。
- en: '[http://www.eicar.org/anti_virus_test_file.htm](http://www.eicar.org/anti_virus_test_file.htm)'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.eicar.org/anti_virus_test_file.htm](http://www.eicar.org/anti_virus_test_file.htm)'
- en: '**Send Test Spam Email:** Sends an email that should be picked up as Spam by
    the Spam filters.'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**发送测试垃圾邮件：** 发送一封应该被垃圾邮件过滤器拦截的邮件。'
- en: '**Send Test Email +dang. Attachment:** Sends a dangerous attachment through
    email to test the functionality of renattach.'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**发送测试邮件+危险附件：** 通过电子邮件发送一个危险的附件，以测试renattach的功能。'
- en: It's important to run each of these tests and maybe a few manual runs at sending
    tests through the filters before trusting the setup with the protection of our
    network resources.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在信任设置保护我们网络资源之前，运行每个测试以及可能进行一些手动运行以通过过滤器发送测试非常重要。
- en: Up and Running!
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 运行中！
- en: If we now have a look at the status screen, we should see that all of the services
    have been started and are being monitored and controlled.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们现在看一下状态屏幕，我们应该看到所有的服务都已经启动，并且正在被监控和控制。
- en: '![Up and Running!](img/1361_09_19.jpg)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![运行中！](img/1361_09_19.jpg)'
- en: Summary
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: We have seen that IPCop can be more than just a simple NAT firewall. It can
    handle multiple network zones and treat each of these independently. We can have
    real control over how these network segments can communicate with each other.
    A firewall can do much more than just filter—it can control, monitor, and report
    on the network's status giving us a good overall view of how our network is functioning,
    and IPCop can fulfill these requirements.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到IPCop不仅仅是一个简单的NAT防火墙。它可以处理多个网络区域，并独立对待每个区域。我们可以真正控制这些网络段如何相互通信。防火墙不仅仅可以进行过滤，它还可以控制、监控并报告网络的状态，为我们提供一个网络功能的全面视图，而IPCop可以满足这些要求。
- en: We have also seen IPCop as a network appliance similar to the expensive commercial
    offerings from many vendors. In this respect IPCop can handle advanced firewalling
    with some application-level or layer-seven filtering. We discussed this earlier
    and IPCop's layer-seven shortcomings. We now see how we can address this and any
    other problems to create a truly useful and powerful perimeter device.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还将IPCop视为类似于许多供应商昂贵商业产品的网络设备。在这方面，IPCop可以处理高级防火墙和一些应用层或第七层过滤。我们之前讨论过这一点以及IPCop的第七层不足之处。现在我们看到了如何解决这个问题以及其他问题，以创建一个真正有用和强大的边界设备。
- en: We looked at the various addons available for IPCop and had a fairly detailed
    look at some of the most commonly used ones and the useful options available.
    We have seen some of the direct benefits of using open source software such as
    IPCop in its simple extensibility or "*hackability*". We covered some advanced
    proxying options with SquidGuard and its use on IPCop. We also looked at Copfilter—one
    of the most popular IPCop addons—with it's filtering of many common protocols
    for malware and other undesirable traffic. We've only scratched the surface of
    IPCop addons, however, as there are many more out there. Everything from an installation
    of Nmap on IPCop to a SETI client! It's worth exploring the options available,
    as those presented here serve only to give an overview of the common applications.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看了一下IPCop可用的各种附加组件，并对一些常用的和有用的选项进行了比较详细的了解。我们已经看到使用IPCop等开源软件的一些直接好处，比如它的简单可扩展性或“*可黑客化*”。我们介绍了一些使用SquidGuard的高级代理选项及其在IPCop上的使用。我们还看了Copfilter——IPCop最受欢迎的附加组件之一，它可以过滤许多常见的恶意软件和其他不良流量的协议。然而，我们只是浅尝辄止IPCop的附加组件，因为还有更多的附件组件。从在IPCop上安装Nmap到SETI客户端，应有尽有！值得探索可用的选项，因为这里介绍的只是常见应用的概述。
