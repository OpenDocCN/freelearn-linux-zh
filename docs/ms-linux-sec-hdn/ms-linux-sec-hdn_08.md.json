["```\ndonnie@ubuntu3:~$ sudo apt install clamav wget\n```", "```\n[donnie@localhost ~]$ sudo yum install clamav clamav-update wget\n```", "```\nsudo su -\nwget http://www.rfxn.com/downloads/maldetect-current.tar.gz\n```", "```\ntar xzvf maldetect-current.tar.gz\ncd maldetect-1.6.2/\n\nroot@ubuntu3:~/maldetect-1.6.2# ./install.sh\nCreated symlink from /etc/systemd/system/multi-user.target.wants/maldet.service to /usr/lib/systemd/system/maldet.service.\nupdate-rc.d: error: initscript does not exist: /etc/init.d/maldet\nLinux Malware Detect v1.6\n (C) 2002-2017, R-fx Networks <proj@r-fx.org>\n (C) 2017, Ryan MacDonald <ryan@r-fx.org>\nThis program may be freely redistributed under the terms of the GNU GPL\n\ninstallation completed to /usr/local/maldetect\nconfig file: /usr/local/maldetect/conf.maldet\nexec file: /usr/local/maldetect/maldet\nexec link: /usr/local/sbin/maldet\nexec link: /usr/local/sbin/lmd\ncron.daily: /etc/cron.daily/maldet\nmaldet(22138): {sigup} performing signature update check...\nmaldet(22138): {sigup} local signature set is version 2017070716978\nmaldet(22138): {sigup} new signature set (201708255569) available\nmaldet(22138): {sigup} downloading https://cdn.rfxn.com/downloads/maldet-sigpack.tgz\nmaldet(22138): {sigup} downloading https://cdn.rfxn.com/downloads/maldet-cleanv2.tgz\nmaldet(22138): {sigup} verified md5sum of maldet-sigpack.tgz\nmaldet(22138): {sigup} unpacked and installed maldet-sigpack.tgz\nmaldet(22138): {sigup} verified md5sum of maldet-clean.tgz\nmaldet(22138): {sigup} unpacked and installed maldet-clean.tgz\nmaldet(22138): {sigup} signature set update completed\nmaldet(22138): {sigup} 15218 signatures (12485 MD5 | 1954 HEX | 779 YARA | 0 USER)\n\nroot@ubuntu3:~/maldetect-1.6.2# cp README /home/donnie\n\nroot@ubuntu3:~/maldetect-1.6.2# exit\nlogout\ndonnie@ubuntu3:~$\n\n```", "```\n/home\n/root\n```", "```\nsudo systemctl start maldet\n```", "```\nemail_alert=\"1\"\nemail_addr=\"donnie\"\n```", "```\nquarantine_hits=\"0\"\n```", "```\nquarantine_hits=\"1\"\n```", "```\nsudo systemctl restart maldet\n```", "```\nDec 8 20:02:09 localhost freshclam[22326]: ClamAV update process started at Fri Dec 8 20:02:09 2017\nDec 8 20:02:29 localhost freshclam[22326]: Can't query current.cvd.clamav.net\nDec 8 20:02:29 localhost freshclam[22326]: Invalid DNS reply. Falling back to HTTP mode.\nDec 8 20:02:29 localhost freshclam[22326]: Reading CVD header (main.cvd):\nDec 8 20:02:35 localhost freshclam[22326]: OK\nDec 8 20:02:47 localhost freshclam[22326]: Downloading main-58.cdiff [100%]\nDec 8 20:03:19 localhost freshclam[22326]: main.cld updated (version: 58, sigs: 4566249, f-level: 60, builder: sigmgr)\n. . .\n. . .\nDec 8 20:04:45 localhost freshclam[22326]: Downloading daily.cvd [100%]\nDec 8 20:04:53 localhost freshclam[22326]: daily.cvd updated (version: 24111, sigs: 1799769, f-level: 63, builder: neo)\nDec 8 20:04:53 localhost freshclam[22326]: Reading CVD header (bytecode.cvd):\nDec 8 20:04:54 localhost freshclam[22326]: OK\nDec 8 20:04:54 localhost freshclam[22326]: Downloading bytecode-279.cdiff [100%]\nDec 8 20:04:55 localhost freshclam[22326]: Downloading bytecode-280.cdiff [100%]\nDec 8 20:04:55 localhost freshclam[22326]: Downloading bytecode-281.cdiff [100%]\nDec 8 20:04:56 localhost freshclam[22326]: Downloading bytecode-282.cdiff [100%]\n. . .\n. . .\n```", "```\n# Check for new database 24 times a day\nChecks 24\nDatabaseMirror db.local.clamav.net\nDatabaseMirror database.clamav.net\n```", "```\n## Adjust this line...\nMAILTO=root\n\n## It is ok to execute it as root; freshclam drops privileges and becomes\n## user 'clamupdate' as soon as possible\n0  */3 * * * root /usr/share/clamav/freshclam-sleep\n```", "```\n# FRESHCLAM_MOD=\n```", "```\nFRESHCLAM_MOD=60\n```", "```\nDec 06 22:06:14 localhost maldet(3728): {sigup} performing signature update check...\nDec 06 22:06:14 localhost maldet(3728): {sigup} local signature set is version 2017070716978\nDec 06 22:07:13 localhost maldet(3728): {sigup} downloaded https://cdn.rfxn.com/downloads/maldet.sigs.ver\nDec 06 22:07:13 localhost maldet(3728): {sigup} new signature set (201708255569) available\nDec 06 22:07:13 localhost maldet(3728): {sigup} downloading https://cdn.rfxn.com/downloads/maldet-sigpack.tgz\n. . .\n. . .\nDec 06 22:07:43 localhost maldet(3728): {sigup} unpacked and installed maldet-clean.tgz\nDec 06 22:07:43 localhost maldet(3728): {sigup} signature set update completed\nDec 06 22:07:43 localhost maldet(3728): {sigup} 15218 signatures (12485 MD5 | 1954 HEX | 779 YARA | 0 USER)\nDec 06 22:14:55 localhost maldet(4070): {scan} signatures loaded: 15218 (12485 MD5 | 1954 HEX | 779 YARA | 0 USER)\n\n```", "```\nautoupdate_signatures=\"1\"\n\nautoupdate_version=\"1\"\n```", "```\nX5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\n```", "```\nDec 09 19:03:43 localhost maldet(7192): {quar} malware quarantined from '/home/donnie/testing.txt' to '/usr/local/maldetect/quarantine/testing.txt.89513558'\n```", "```\n[donnie@localhost ~]$ getsebool -a | grep 'virus'\nantivirus_can_scan_system --> off\nantivirus_use_jit --> off\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo setsebool -P antivirus_can_scan_system on\n[sudo] password for donnie:\n\n[donnie@localhost ~]$ getsebool antivirus_can_scan_system\nantivirus_can_scan_system --> on\n[donnie@localhost ~]$\n```", "```\nsudo apt install rkhunter\n```", "```\nsudo yum install rkhunter\n```", "```\nman rkhunter\n```", "```\n[donnie@localhost ~]$ sudo rkhunter --update\n[ Rootkit Hunter version 1.4.4 ]\n\nChecking rkhunter data files...\n Checking file mirrors.dat [ Updated ]\n Checking file programs_bad.dat [ Updated ]\n Checking file backdoorports.dat [ No update ]\n Checking file suspscan.dat [ Updated ]\n Checking file i18n/cn [ No update ]\n Checking file i18n/de [ Updated ]\n Checking file i18n/en [ Updated ]\n Checking file i18n/tr [ Updated ]\n Checking file i18n/tr.utf8 [ Updated ]\n Checking file i18n/zh [ Updated ]\n Checking file i18n/zh.utf8 [ Updated ]\n Checking file i18n/ja [ Updated ]\n[donnie@localhost ~]$\n```", "```\nsudo rkhunter -c\n```", "```\nsudo rkhunter -c --cronjob --rwo\n```", "```\nsudo crontab -e -u root\n```", "```\n20 22 * * * /usr/bin/rkhunter -c --cronjob --rwo\n```", "```\nsudo apt install auditd\n```", "```\nsudo systemctl restart auditd\n```", "```\nsudo service auditd restart\n```", "```\n[donnie@localhost ~]$ sudo auditctl -l\n[sudo] password for donnie:\nNo rules\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo auditctl -w /etc/passwd -p wa -k passwd_changes\n[sudo] password for donnie:\n\n[donnie@localhost ~]$ sudo auditctl -l\n-w /etc/passwd -p wa -k passwd_changes\n[donnie@localhost ~]$\n```", "```\nsudo less /etc/audit/audit.rules\n```", "```\n## This file is automatically generated from /etc/audit/rules.d\n-D\n-b 8192\n-f 1\n\n```", "```\n[donnie@localhost ~]$ sudo sh -c \"auditctl -l > /etc/audit/rules.d/custom.rules\"\n[donnie@localhost ~]$ sudo service auditd restart\n```", "```\n## This file is automatically generated from /etc/audit/rules.d\n-D\n-b 8192\n-f 1\n\n-w /etc/passwd -p wa -k passwd_changes\n```", "```\n[donnie@localhost ~]$ sudo groupadd secretcats\n[sudo] password for donnie:\n\n[donnie@localhost ~]$ sudo usermod -a -G secretcats vicky\n[donnie@localhost ~]$ sudo usermod -a -G secretcats cleopatra\n\n[donnie@localhost ~]$ sudo mkdir /secretcats\n[donnie@localhost ~]$ sudo chown nobody:secretcats /secretcats/\n[donnie@localhost ~]$ sudo chmod 3770 /secretcats/\n\n[donnie@localhost ~]$ ls -ld /secretcats/\ndrwxrws--T. 2 nobody secretcats 6 Dec 11 14:47 /secretcats/\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo auditctl -w /secretcats/ -k secretcats_watch\n[sudo] password for donnie:\n\n[donnie@localhost ~]$ sudo auditctl -l\n-w /etc/passwd -p wa -k passwd_changes\n-w /secretcats -p rwxa -k secretcats_watch\n[donnie@localhost ~]$\n```", "```\nsudo auditctl -w /secretcats/ -p x -k secretcats_watch\n```", "```\n[donnie@localhost ~]$ sudo auditctl -a always,exit -F arch=b64 -S openat -F auid=1006\n[sudo] password for donnie:\n\n[donnie@localhost ~]$ sudo auditctl -l\n-w /etc/passwd -p wa -k passwd_changes\n-w /secretcats -p rwxa -k secretcats_watch\n-a always,exit -F arch=b64 -S openat -F auid=1006\n[donnie@localhost ~]$\n```", "```\nman auditctl\n```", "```\nsudo auditctl -w /etc/passwd -p wa -k passwd_changes\n```", "```\n[donnie@localhost etc]$ sudo chfn cleopatra\nChanging finger information for cleopatra.\nName []: Cleopatra Tabby Cat\nOffice []: Donnie's back yard\nOffice Phone []: 555-5555\nHome Phone []: 555-5556\n\nFinger information changed.\n[donnie@localhost etc]\n```", "```\n[donnie@localhost ~]$ sudo ausearch -i -k passwd_changes\n----\ntype=CONFIG_CHANGE msg=audit(12/11/2017 13:06:20.665:11393) : auid=donnie ses=842 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 op=add_rule key=passwd_changes li\nst=exit res=yes\n----\ntype=CONFIG_CHANGE msg=audit(12/11/2017 13:49:15.262:11511) : auid=donnie ses=842 op=updated_rules path=/etc/passwd key=passwd_changes list=exit res=yes\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo aureport -i -k | grep 'passwd_changes'\n1\\. 12/11/2017 13:06:20 passwd_changes yes ? donnie 11393\n2\\. 12/11/2017 13:49:15 passwd_changes yes ? donnie 11511\n3\\. 12/11/2017 13:49:15 passwd_changes yes /usr/bin/chfn donnie 11512\n4\\. 12/11/2017 14:54:11 passwd_changes yes /usr/sbin/usermod donnie 11728\n5\\. 12/11/2017 14:54:25 passwd_changes yes /usr/sbin/usermod donnie 11736\n[donnie@localhost ~]$\n```", "```\nDec 11 13:06:20 localhost sudo: donnie : TTY=pts/1 ; PWD=/home/donnie ; USER=root ; COMMAND=/sbin/auditctl -w /etc/passwd -p wa -k passwd_changes\n. . .\n. . .\nDec 11 13:49:24 localhost sudo: donnie : TTY=pts/1 ; PWD=/home/donnie ; USER=root ; COMMAND=/sbin/ausearch -i -k passwd_changes\n\n```", "```\nDec 11 14:54:11 localhost sudo:  donnie : TTY=pts/1 ; PWD=/home/donnie ; USER=root ; COMMAND=/sbin/usermod -a -G secretcats vicky\nDec 11 14:54:11 localhost usermod[14865]: add 'vicky' to group 'secretcats'\nDec 11 14:54:11 localhost usermod[14865]: add 'vicky' to shadow group 'secretcats'\nDec 11 14:54:25 localhost sudo:  donnie : TTY=pts/1 ; PWD=/home/donnie ; USER=root ; COMMAND=/sbin/usermod -a -G secretcats cleopatra\nDec 11 14:54:25 localhost usermod[14871]: add 'cleopatra' to group 'secretcats'\nDec 11 14:54:25 localhost usermod[14871]: add 'cleopatra' to shadow group 'secretcats'\n```", "```\nDec 11 13:48:49 localhost sudo:  donnie : TTY=pts/1 ; PWD=/etc ; USER=root ; COMMAND=/bin/chfn cleopatra\n```", "```\nsudo auditctl -w /secretcats/ -k secretcats_watch\n```", "```\n[vicky@localhost ~]$ cd /secretcats\n[vicky@localhost secretcats]$ ls -l\ntotal 4\n-rw-rw-r--. 1 cleopatra secretcats 31 Dec 12 11:49 cleopatrafile.txt\n[vicky@localhost secretcats]$\n```", "```\nsudo ausearch -i -k secretcats_watch | less\n\ntype=PROCTITLE msg=audit(12/12/2017 12:15:35.447:14077) : proctitle=ls --color=auto -l\ntype=PATH msg=audit(12/12/2017 12:15:35.447:14077) : item=0 name=. inode=33583041 dev=fd:01 mode=dir,sgid,sticky,770 ouid=nobody ogid=secretcats rdev=00:00 obj=unconfined_u:object_r:default_t:s0 objtype=NORMAL\ntype=CWD msg=audit(12/12/2017 12:15:35.447:14077) :  cwd=/secretcats\ntype=SYSCALL msg=audit(12/12/2017 12:15:35.447:14077) : arch=x86_64 syscall=openat success=yes exit=3 a0=0xffffffffffffff9c a1=0x2300330 a2=O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC a3=0x0 items=1 ppid=10805 pid=10952 auid=vicky uid=vicky gid=vicky euid=vicky suid=vicky fsuid=vicky egid=vicky sgid=vicky fsgid=vicky tty=pts0 ses=1789 comm=ls exe=/usr/bin/ls subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=secretcats_watch\n. . .\n. . .\ntype=PROCTITLE msg=audit(12/12/2017 12:15:35.447:14081) : proctitle=ls --color=auto -l\ntype=PATH msg=audit(12/12/2017 12:15:35.447:14081) : item=0 name=cleopatrafile.txt inode=33583071 dev=fd:01 mode=file,664 ouid=cleopatra ogid=secretcats rdev=00:00 obj=unconfined_u:object_r:default_t:s0 objtype=NORMAL\ntype=CWD msg=audit(12/12/2017 12:15:35.447:14081) :  cwd=/secretcats\ntype=SYSCALL msg=audit(12/12/2017 12:15:35.447:14081) : arch=x86_64 syscall=getxattr success=no exit=ENODATA(No data available) a0=0x7fff7c266e60 a1=0x7f0a61cb9db0 a2=0x0 a3=0x0 items=1 ppid=10805 pid=10952 auid=vicky uid=vicky gid=vicky euid=vicky suid=vicky fsuid=vicky egid=vicky sgid=vicky fsgid=vicky tty=pts0 ses=1789 comm=ls exe=/usr/bin/ls subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=secretcats_watch\n```", "```\n[charlie@localhost ~]$ cd /secretcats\n-bash: cd: /secretcats: Permission denied\n[charlie@localhost ~]$ ls -l /secretcats\nls: cannot open directory /secretcats: Permission denied\n[charlie@localhost ~]$\n```", "```\nsudo ausearch -i -k secretcats_watch | less\n\ntype=PROCTITLE msg=audit(12/12/2017 12:32:04.341:14152) : proctitle=ls --color=auto -l /secretcats\ntype=PATH msg=audit(12/12/2017 12:32:04.341:14152) : item=0 name=/secretcats inode=33583041 dev=fd:01 mode=dir,sgid,sticky,770 ouid=nobody ogid=secretcats rdev=00:00 obj=unconfined_u:object_r:default_t:s0 objtype=NORMAL\ntype=CWD msg=audit(12/12/2017 12:32:04.341:14152) :  cwd=/home/charlie\ntype=SYSCALL msg=audit(12/12/2017 12:32:04.341:14152) : arch=x86_64 syscall=lgetxattr success=yes exit=35 a0=0x7ffd8d18f7dd a1=0x7f2496858f8a a2=0x12bca30 a3=0xff items=1 ppid=11637 pid=11663 auid=charlie uid=charlie gid=charlie euid=charlie suid=charlie fsuid=charlie egid=charlie sgid=charlie fsgid=charlie tty=pts0 ses=1794 comm=ls exe=/usr/bin/ls subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=secretcats_watch\n. . .\n. . .\ntype=PROCTITLE msg=audit(12/12/2017 12:32:04.341:14155) : proctitle=ls --color=auto -l /secretcats\ntype=PATH msg=audit(12/12/2017 12:32:04.341:14155) : item=0 name=/secretcats inode=33583041 dev=fd:01 mode=dir,sgid,sticky,770 ouid=nobody ogid=secretcats rdev=00:00 obj=unconfined_u:object_r:default_t:s0 objtype=NORMAL\ntype=CWD msg=audit(12/12/2017 12:32:04.341:14155) :  cwd=/home/charlie\ntype=SYSCALL msg=audit(12/12/2017 12:32:04.341:14155) : arch=x86_64 syscall=openat success=no exit=EACCES(Permission denied) a0=0xffffffffffffff9c a1=0x12be300 a2=O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC a3=0x0 items=1 ppid=11637 pid=11663 auid=charlie uid=charlie gid=charlie euid=charlie suid=charlie fsuid=charlie egid=charlie sgid=charlie fsgid=charlie tty=pts0 ses=1794 comm=ls exe=/usr/bin/ls subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=secretcats_watch\n```", "```\n. . .\n. . .\ntype=PROCTITLE msg=audit(12/12/2017 11:49:37.536:13856) : proctitle=vim cleopatrafile.txt\ntype=PATH msg=audit(12/12/2017 11:49:37.536:13856) : item=0 name=. inode=33583041 dev=fd:01 mode=dir,sgid,sticky,770 ouid=nobody ogid=secretcats rdev=00:00 obj=unconfined_u:o\nbject_r:default_t:s0 objtype=NORMAL\ntype=CWD msg=audit(12/12/2017 11:49:37.536:13856) :  cwd=/secretcats\ntype=SYSCALL msg=audit(12/12/2017 11:49:37.536:13856) : arch=x86_64 syscall=open success=yes exit=4 a0=0x5ab983 a1=O_RDONLY a2=0x0 a3=0x63 items=1 ppid=9572 pid=9593 auid=cle\nopatra uid=cleopatra gid=cleopatra euid=cleopatra suid=cleopatra fsuid=cleopatra egid=cleopatra sgid=cleopatra fsgid=cleopatra tty=pts0 ses=1779 comm=vim exe=/usr/bin/vim sub\nj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=secretcats_watch\n----\ntype=PROCTITLE msg=audit(12/12/2017 11:49:56.001:13858) : proctitle=vim cleopatrafile.txt\ntype=PATH msg=audit(12/12/2017 11:49:56.001:13858) : item=1 name=/secretcats/.cleopatrafile.txt.swp inode=33583065 dev=fd:01 mode=file,600 ouid=cleopatra ogid=secretcats rdev\n=00:00 obj=unconfined_u:object_r:default_t:s0 objtype=DELETE\ntype=PATH msg=audit(12/12/2017 11:49:56.001:13858) : item=0 name=/secretcats/ inode=33583041 dev=fd:01 mode=dir,sgid,sticky,770 ouid=nobody ogid=secretcats rdev=00:00 obj=unc\nonfined_u:object_r:default_t:s0 objtype=PARENT\ntype=CWD msg=audit(12/12/2017 11:49:56.001:13858) :  cwd=/secretcats\ntype=SYSCALL msg=audit(12/12/2017 11:49:56.001:13858) : arch=x86_64 syscall=unlink success=yes exit=0 a0=0x15ee7a0 a1=0x1 a2=0x1 a3=0x7ffc2c82e6b0 items=2 ppid=9572 pid=9593\nauid=cleopatra uid=cleopatra gid=cleopatra euid=cleopatra suid=cleopatra fsuid=cleopatra egid=cleopatra sgid=cleopatra fsgid=cleopatra tty=pts0 ses=1779 comm=vim exe=/usr/bin\n/vim subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=secretcats_watch\n. . .\n. . .\n```", "```\n[donnie@localhost ~]$ sudo aureport -i -k | less\n\nKey Report\n===============================================\n# date time key success exe auid event\n===============================================\n1\\. 12/11/2017 13:06:20 passwd_changes yes ? donnie 11393\n2\\. 12/11/2017 13:49:15 passwd_changes yes ? donnie 11511\n3\\. 12/11/2017 13:49:15 passwd_changes yes /usr/bin/chfn donnie 11512\n4\\. 12/11/2017 14:54:11 passwd_changes yes /usr/sbin/usermod donnie 11728\n5\\. 12/11/2017 14:54:25 passwd_changes yes /usr/sbin/usermod donnie 11736\n. . .\n. . .\n```", "```\nsudo aureport -i -k | grep 'secretcats_watch'\n\n[donnie@localhost ~]$ sudo aureport -i -k | grep 'secretcats_watch'\n6\\. 12/11/2017 15:01:25 secretcats_watch yes ? donnie 11772\n8\\. 12/12/2017 11:49:29 secretcats_watch yes /usr/bin/ls cleopatra 13828\n9\\. 12/12/2017 11:49:37 secretcats_watch yes /usr/bin/vim cleopatra 13830\n10\\. 12/12/2017 11:49:37 secretcats_watch yes /usr/bin/vim cleopatra 13829\n. . .\n. . .\n48\\. 12/12/2017 12:32:04 secretcats_watch yes /usr/bin/ls charlie 14152\n49\\. 12/12/2017 12:32:04 secretcats_watch no /usr/bin/ls charlie 14153\n50\\. 12/12/2017 12:32:04 secretcats_watch no /usr/bin/ls charlie 14154\n51\\. 12/12/2017 12:32:04 secretcats_watch no /usr/bin/ls charlie 14155\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo ausearch -i -k secretcats_watch | less\n\ntype=PROCTITLE msg=audit(12/12/2017 12:32:04.341:14152) : proctitle=ls --color=auto -l /secretcats\n\ntype=PROCTITLE msg=audit(12/12/2017 12:32:04.341:14153) : proctitle=ls --color=auto -l /secretcats\n\ntype=PROCTITLE msg=audit(12/12/2017 12:32:04.341:14154) : proctitle=ls --color=auto -l /secretcats\n\ntype=PROCTITLE msg=audit(12/12/2017 12:32:04.341:14155) : proctitle=ls --color=auto -l /secretcats\n```", "```\nsudo auditctl -a always,exit -F arch=b64 -S openat -F auid=1006\n```", "```\ntime->Tue Dec 12 11:49:29 2017\ntype=PROCTITLE msg=audit(1513097369.952:13828): proctitle=6C73002D2D636F6C6F723D6175746F\ntype=PATH msg=audit(1513097369.952:13828): item=0 name=\".\" inode=33583041 dev=fd:01 mode=043770 ouid=99 ogid=1009 rdev=00:00 obj=unconfined_u:object_r:default_t:s0 objtype=NO\nRMAL\ntype=CWD msg=audit(1513097369.952:13828):  cwd=\"/secretcats\"\ntype=SYSCALL msg=audit(1513097369.952:13828): arch=c000003e syscall=257 success=yes exit=3 a0=ffffffffffffff9c a1=10d1560 a2=90800 a3=0 items=1 ppid=9572 pid=9592 auid=1004 u\nid=1004 gid=1006 euid=1004 suid=1004 fsuid=1004 egid=1006 sgid=1006 fsgid=1006 tty=pts0 ses=1779 comm=\"ls\" exe=\"/usr/bin/ls\" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0\n:c0.c1023 key=\"secretcats_watch\"\n```", "```\ntime->Tue Dec 12 11:50:28 2017\ntype=PROCTITLE msg=audit(1513097428.662:13898): proctitle=737368643A20636861726C6965407074732F30\ntype=PATH msg=audit(1513097428.662:13898): item=0 name=\"/proc/9726/fd\" inode=1308504 dev=00:03 mode=040500 ouid=0 ogid=0 rdev=00:00 obj=unconfined_u:unconfined_r:unconfined_t\n:s0-s0:c0.c1023 objtype=NORMAL\ntype=CWD msg=audit(1513097428.662:13898):  cwd=\"/home/charlie\"\ntype=SYSCALL msg=audit(1513097428.662:13898): arch=c000003e syscall=257 success=yes exit=3 a0=ffffffffffffff9c a1=7ffc7ca1d840 a2=90800 a3=0 items=1 ppid=9725 pid=9726 auid=1\n006 uid=1006 gid=1008 euid=1006 suid=1006 fsuid=1006 egid=1008 sgid=1008 fsgid=1008 tty=pts0 ses=1781 comm=\"sshd\" exe=\"/usr/sbin/sshd\" subj=unconfined_u:unconfined_r:unconfin\ned_t:s0-s0:c0.c1023 key=(null)\n----\ntime->Tue Dec 12 11:50:28 2017\ntype=PROCTITLE msg=audit(1513097428.713:13900): proctitle=737368643A20636861726C6965407074732F30\ntype=PATH msg=audit(1513097428.713:13900): item=0 name=\"/etc/profile.d/\" inode=33593031 dev=fd:01 mode=040755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:bin_t:s0 objtype=\nNORMAL\ntype=CWD msg=audit(1513097428.713:13900):  cwd=\"/home/charlie\"\ntype=SYSCALL msg=audit(1513097428.713:13900): arch=c000003e syscall=257 success=yes exit=3 a0=ffffffffffffff9c a1=1b27930 a2=90800 a3=0 items=1 ppid=9725 pid=9726 auid=1006 u\nid=1006 gid=1008 euid=1006 suid=1006 fsuid=1006 egid=1008 sgid=1008 fsgid=1008 tty=pts0 ses=1781 comm=\"bash\" exe=\"/usr/bin/bash\" subj=unconfined_u:unconfined_r:unconfined_t:s\n0-s0:c0.c1023 key=(null)\n```", "```\n[donnie@localhost ~]$ sudo aureport -s -i | grep 'openat'\n[sudo] password for donnie:\n1068\\. 12/12/2017 11:49:29 openat 9592 ls cleopatra 13828\n1099\\. 12/12/2017 11:50:28 openat 9665 sshd charlie 13887\n1100\\. 12/12/2017 11:50:28 openat 9665 sshd charlie 13889\n1101\\. 12/12/2017 11:50:28 openat 9665 sshd charlie 13890\n1102\\. 12/12/2017 11:50:28 openat 9726 sshd charlie 13898\n1103\\. 12/12/2017 11:50:28 openat 9726 bash charlie 13900\n1104\\. 12/12/2017 11:50:28 openat 9736 grep charlie 13901\n1105\\. 12/12/2017 11:50:28 openat 9742 grep charlie 13902\n1108\\. 12/12/2017 11:50:51 openat 9766 ls charlie 13906\n1110\\. 12/12/2017 12:15:35 openat 10952 ls vicky 14077\n1115\\. 12/12/2017 12:30:54 openat 11632 sshd charlie 14129\n1116\\. 12/12/2017 12:30:54 openat 11632 sshd charlie 14131\n1117\\. 12/12/2017 12:30:54 openat 11632 sshd charlie 14132\n1118\\. 12/12/2017 12:30:54 openat 11637 sshd charlie 14140\n1119\\. 12/12/2017 12:30:54 openat 11637 bash charlie 14142\n1120\\. 12/12/2017 12:30:54 openat 11647 grep charlie 14143\n1121\\. 12/12/2017 12:30:54 openat 11653 grep charlie 14144\n1125\\. 12/12/2017 12:32:04 openat 11663 ls charlie 14155\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo aureport -au\n[sudo] password for donnie:\n\nAuthentication Report\n============================================\n# date time acct host term exe success event\n============================================\n1\\. 10/28/2017 13:38:52 donnie localhost.localdomain tty1 /usr/bin/login yes 94\n2\\. 10/28/2017 13:39:03 donnie localhost.localdomain /dev/tty1 /usr/bin/sudo yes 102\n3\\. 10/28/2017 14:04:51 donnie localhost.localdomain /dev/tty1 /usr/bin/sudo yes 147\n. . .\n. . .\n239\\. 12/12/2017 11:50:20 charlie 192.168.0.222 ssh /usr/sbin/sshd no 13880\n244\\. 12/12/2017 12:10:06 cleopatra 192.168.0.222 ssh /usr/sbin/sshd no 13992\n247\\. 12/12/2017 12:14:28 vicky 192.168.0.222 ssh /usr/sbin/sshd no 14049\n250\\. 12/12/2017 12:30:49 charlie 192.168.0.222 ssh /usr/sbin/sshd no 14122\n265\\. 12/12/2017 19:06:20 charlie 192.168.0.222 ssh /usr/sbin/sshd no 725\n269\\. 12/12/2017 19:23:45 donnie ? /dev/pts/0 /usr/bin/sudo no 779\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo ausearch -a 14122\n----\ntime->Tue Dec 12 12:30:49 2017\ntype=USER_AUTH msg=audit(1513099849.322:14122): pid=11632 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='op=pubkey acct=\"charlie\" exe=\"/usr/sbin/sshd\" hostname=? addr=192.168.0.222 terminal=ssh res=failed'\n```", "```\nDec 12 12:30:53 localhost sshd[11632]: Accepted password for charlie from 192.168.0.222 port 34980 ssh2\nDec 12 12:30:54 localhost sshd[11632]: pam_unix(sshd:session): session opened for user charlie by (uid=0)\n```", "```\n[donnie@localhost rules]$ pwd\n/usr/share/doc/audit-2.7.6/rules\n[donnie@localhost rules]$ ls -l\ntotal 96\n-rw-r--r--. 1 root root  163 Aug  4 17:29 10-base-config.rules\n-rw-r--r--. 1 root root  284 Apr 19  2017 10-no-audit.rules\n-rw-r--r--. 1 root root   93 Apr 19  2017 11-loginuid.rules\n-rw-r--r--. 1 root root  329 Apr 19  2017 12-cont-fail.rules\n-rw-r--r--. 1 root root  323 Apr 19  2017 12-ignore-error.rules\n-rw-r--r--. 1 root root  516 Apr 19  2017 20-dont-audit.rules\n-rw-r--r--. 1 root root  273 Apr 19  2017 21-no32bit.rules\n-rw-r--r--. 1 root root  252 Apr 19  2017 22-ignore-chrony.rules\n-rw-r--r--. 1 root root 4915 Apr 19  2017 30-nispom.rules\n-rw-r--r--. 1 root root 5952 Apr 19  2017 30-pci-dss-v31.rules\n-rw-r--r--. 1 root root 6663 Apr 19  2017 30-stig.rules\n-rw-r--r--. 1 root root 1498 Apr 19  2017 31-privileged.rules\n-rw-r--r--. 1 root root  218 Apr 19  2017 32-power-abuse.rules\n-rw-r--r--. 1 root root  156 Apr 19  2017 40-local.rules\n-rw-r--r--. 1 root root  439 Apr 19  2017 41-containers.rules\n-rw-r--r--. 1 root root  672 Apr 19  2017 42-injection.rules\n-rw-r--r--. 1 root root  424 Apr 19  2017 43-module-load.rules\n-rw-r--r--. 1 root root  326 Apr 19  2017 70-einval.rules\n-rw-r--r--. 1 root root  151 Apr 19  2017 71-networking.rules\n-rw-r--r--. 1 root root   86 Apr 19  2017 99-finalize.rules\n-rw-r--r--. 1 root root 1202 Apr 19  2017 README-rules\n[donnie@localhost rules]$\n```", "```\n[donnie@localhost rules]$ sudo cp 30-pci-dss-v31.rules /etc/audit/rules.d\n[donnie@localhost rules]$\n```", "```\nsudo service auditd restart\n```", "```\nsudo systemctl restart auditd\n```", "```\nsudo yum install openscap-scanner scap-security-guide\n```", "```\nsudo apt install python-openscap\n```", "```\n[donnie@localhost content]$ pwd\n/usr/share/xml/scap/ssg/content\n[donnie@localhost content]$ ls -l\ntotal 50596\n-rw-r--r--. 1 root root  6734643 Oct 19 19:40 ssg-centos6-ds.xml\n-rw-r--r--. 1 root root  1596043 Oct 19 19:40 ssg-centos6-xccdf.xml\n-rw-r--r--. 1 root root 11839886 Oct 19 19:41 ssg-centos7-ds.xml\n-rw-r--r--. 1 root root  2636971 Oct 19 19:40 ssg-centos7-xccdf.xml\n-rw-r--r--. 1 root root      642 Oct 19 19:40 ssg-firefox-cpe-dictionary.xml\n. . .\n. . .\n-rw-r--r--. 1 root root 11961196 Oct 19 19:41 ssg-rhel7-ds.xml\n-rw-r--r--. 1 root root   851069 Oct 19 19:40 ssg-rhel7-ocil.xml\n-rw-r--r--. 1 root root  2096046 Oct 19 19:40 ssg-rhel7-oval.xml\n-rw-r--r--. 1 root root  2863621 Oct 19 19:40 ssg-rhel7-xccdf.xml\n[donnie@localhost content]$\n```", "```\n[donnie@localhost content]$ sudo oscap info ssg-centos7-xccdf.xml\nDocument type: XCCDF Checklist\nChecklist version: 1.1\nImported: 2017-10-19T19:40:43\nStatus: draft\nGenerated: 2017-10-19\nResolved: true\nProfiles:\n standard\n pci-dss\n C2S\n rht-ccp\n common\n stig-rhel7-disa\n stig-rhevh-upstream\n ospp-rhel7\n cjis-rhel7-server\n docker-host\n nist-800-171-cui\nReferenced check files:\n ssg-rhel7-oval.xml\n system: http://oval.mitre.org/XMLSchema/oval-definitions-5\n ssg-rhel7-ocil.xml\n system: http://scap.nist.gov/schema/ocil/2\n https://www.redhat.com/security/data/oval/com.redhat.rhsa-RHEL7.xml.bz2\n system: http://oval.mitre.org/XMLSchema/oval-definitions-5\n[donnie@localhost content]$\n```", "```\nsudo oscap xccdf eval --profile pci-dss --results scan-xccdf-results.xml /usr/share/xml/scap/ssg/content/ssg-centos7-xccdf.xml\n```", "```\n    Ensure Red Hat GPG Key Installed\n    ensure_redhat_gpgkey_installed\n    pass\n\n    Ensure gpgcheck Enabled In Main Yum Configuration\n    ensure_gpgcheck_globally_activated\n    pass\n\n    Ensure gpgcheck Enabled For All Yum Package Repositories\n    ensure_gpgcheck_never_disabled\n    pass\n\n    Ensure Software Patches Installed\n    security_patches_up_to_date\n    notchecked\n\n   . . .\n   . . .\n\n    Install AIDE\n    package_aide_installed\n    fail\n\n    Build and Test AIDE Database\n    aide_build_database\n    fail\n. . .\n. . .\n```", "```\nsudo oscap xccdf generate report scan-xccdf-results.xml > scan-xccdf-results.html\n```", "```\nsudo oscap xccdf eval --remediate --profile pci-dss --results scan-xccdf-remediate-results.xml /usr/share/xml/scap/ssg/content/ssg-centos7-xccdf.xml\n```", "```\n    Disable Prelinking\n    disable_prelink\n    error\n\n    Install AIDE\n    package_aide_installed\n    fixed\n\n    Build and Test AIDE Database\n    aide_build_database\n    fixed\n\n    Configure Periodic Execution of AIDE\n    aide_periodic_cron_checking\n    fixed\n\n    Verify and Correct File Permissions with RPM\n    rpm_verify_permissions\n    error\n\n    Prevent Log In to Accounts With Empty Password\n    no_empty_passwords\n    fixed\n. . .\n. . .\n```", "```\n    Set Password Maximum Age\n    accounts_maximum_age_login_defs\n    fixed\n\n    Set Account Expiration Following Inactivity\n    account_disable_post_pw_expiration\n    fixed\n\n    Set Password Strength Minimum Digit Characters\n    accounts_password_pam_dcredit\n    fixed\n\n    Set Password Minimum Length\n    accounts_password_pam_minlen\n    fixed\n\n    Set Password Strength Minimum Uppercase Characters\n    accounts_password_pam_ucredit\n    fixed\n\n    Set Password Strength Minimum Lowercase Characters\n    accounts_password_pam_lcredit\n    fixed\n\n    Set Deny For Failed Password Attempts\n    accounts_passwords_pam_faillock_deny\n    fixed\n\n    Set Lockout Time For Failed Password Attempts\n    accounts_passwords_pam_faillock_unlock_time\n    fixed\n\n    Limit Password Reuse\n    accounts_password_pam_unix_remember\n    fixed\n```", "```\nsudo yum install scap-workbench\n```"]