["```\n[donnie@localhost ~]$ ls -Z\ndrwxrwxr-x. donnie donnie unconfined_u:object_r:user_home_t:s0 acl_demo_dir\n-rw-rw-r--. donnie donnie unconfined_u:object_r:user_home_t:s0 yum_list.txt\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ ps -Z\nLABEL                             PID TTY          TIME CMD\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 1322 pts/0 00:00:00 bash\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 3978 pts/0 00:00:00 ps\n[donnie@localhost ~]$\n```", "```\nsudo yum install setools policycoreutils policycoreutils-python\n```", "```\nsudo yum install setroubleshoot\nsudo service auditd restart\n```", "```\nsudo yum install httpd\nsudo systemctl enable --now httpd\n```", "```\n[donnie@localhost ~]$ sudo firewall-cmd --permanent --add-service=http\nsuccess\n[donnie@localhost ~]$ sudo firewall-cmd --reload\nsuccess\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ ps ax -Z | grep httpd\nsystem_u:system_r:httpd_t:s0     3689 ?        Ss     0:00 /usr/sbin/httpd -DFOREGROUND\nsystem_u:system_r:httpd_t:s0     3690 ?        S      0:00 /usr/sbin/httpd -DFOREGROUND\nsystem_u:system_r:httpd_t:s0     3691 ?        S      0:00 /usr/sbin/httpd -DFOREGROUND\nsystem_u:system_r:httpd_t:s0     3692 ?        S      0:00 /usr/sbin/httpd -DFOREGROUND\nsystem_u:system_r:httpd_t:s0     3693 ?        S      0:00 /usr/sbin/httpd -DFOREGROUND\nsystem_u:system_r:httpd_t:s0     3694 ?        S      0:00 /usr/sbin/httpd -DFOREGROUND\nunconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 3705 pts/0 R+   0:00 grep --color=auto httpd\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost www]$ pwd\n/var/www\n[donnie@localhost www]$ ls -Zd html/\ndrwxr-xr-x. root root system_u:object_r:httpd_sys_content_t:s0 html/\n[donnie@localhost www]$\n```", "```\n[donnie@localhost www]$ cd html\n[donnie@localhost html]$ pwd\n/var/www/html\n[donnie@localhost html]$ sudo vim index.html\n```", "```\n<html>\n<head>\n<title>\nTest of SELinux\n</title>\n</head>\n<body>\nLet's see if this SELinux stuff really works!\n</body>\n</html>\n```", "```\n[donnie@localhost html]$ ls -Z\n-rw-r--r--. root root unconfined_u:object_r:httpd_sys_content_t:s0 index.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost ~]$ pwd\n/home/donnie\n[donnie@localhost ~]$ ls -Z index.html\n-rw-rw-r--. donnie donnie unconfined_u:object_r:user_home_t:s0 index.html\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo mv index.html /var/www/html/\n[sudo] password for donnie:\n\n[donnie@localhost ~]$ cd /var/www/html\n\n[donnie@localhost html]$ ls -Z\n-rw-rw-r--. donnie donnie unconfined_u:object_r:user_home_t:s0 index.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ sudo chcon -t httpd_sys_content_t index.html\n[sudo] password for donnie:\n\n[donnie@localhost html]$ ls -Z\n-rw-rw-r--. donnie donnie unconfined_u:object_r:httpd_sys_content_t:s0 index.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ ls -Z\n-rw-rw-r--. donnie donnie unconfined_u:object_r:user_home_t:s0 index.html\n-rw-r--r--. root   root   unconfined_u:object_r:httpd_sys_content_t:s0 some_file.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ sudo chcon --reference some_file.html index.html\n[sudo] password for donnie:\n\n[donnie@localhost html]$ ls -Z\n-rw-rw-r--. donnie donnie unconfined_u:object_r:httpd_sys_content_t:s0 index.html\n-rw-r--r--. root   root   unconfined_u:object_r:httpd_sys_content_t:s0 some_file.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ ls -Z\n-rw-rw-r--. donnie donnie unconfined_u:object_r:user_home_t:s0 index.html\n\n[donnie@localhost html]$ sudo restorecon index.html\n\n[donnie@localhost html]$ ls -Z\n-rw-rw-r--. donnie donnie unconfined_u:object_r:httpd_sys_content_t:s0 index.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ sudo chown apache: index.html\n[sudo] password for donnie:\n\n[donnie@localhost html]$ ls -l\ntotal 4\n-rw-rw-r--. 1 apache apache 125 Nov 22 16:14 index.html\n[donnie@localhost html]$\n```", "```\n[donnie@localhost home]$ pwd\n/home\n\n[donnie@localhost home]$ sudo mkdir webdir\n[sudo] password for donnie:\n\n[donnie@localhost home]$ ls -Zd webdir\ndrwxr-xr-x. root root unconfined_u:object_r:home_root_t:s0 webdir\n[donnie@localhost home]$\n```", "```\n[donnie@localhost webdir]$ ls -Z\n-rw-r--r--. root root unconfined_u:object_r:home_root_t:s0 index.html\n[donnie@localhost webdir]$\n```", "```\n[donnie@localhost home]$ sudo semanage fcontext -a -t httpd_sys_content_t \"/home/webdir(/.*)?\"\n\n[donnie@localhost home]$ ls -Zd /home/webdir\ndrwxr-xr-x. root root unconfined_u:object_r:httpd_sys_content_t:s0 /home/web_dir\n[donnie@localhost home]$\n```", "```\n[donnie@localhost home]$ sudo restorecon -R webdir\n\n[donnie@localhost home]$ ls -Zd /home/webdir\ndrwxr-xr-x. root root unconfined_u:object_r:httpd_sys_content_t:s0 /home/webdir\n[donnie@localhost home]$\n```", "```\n sudo yum install httpd setroubleshoot setools \n policycoreutils policycoreutils-python\n```", "```\n        sudo service auditd restart\n```", "```\n sudo systemctl enable --now httpd\n sudo firewall-cmd --permanent --add-service=http\n sudo firewall-cmd --reload\n```", "```\n        <html>\n          <head>\n            <title>SELinux Test Page</title>\n          </head>\n          <body>\n            This is a test of SELinux.\n          </body>\n        </html>\n```", "```\n ls -Z index.html\n```", "```\n sudo chcon -t tmp_t index.html\n ls -Z index.html\n```", "```\n sudo restorecon index.html\n```", "```\nNov 26 21:30:21 localhost python: SELinux is preventing httpd from open access on the file /var/www/html/index.html.#012#012*****  Plugin restorecon (92.2 confidence) suggests   ************************#012#012If you want to fix the label. #012/var/www/html/index.html default label should be httpd_sys_content_t.#012Then you can run restorecon.#012Do#012# /sbin/restorecon -v /var/www/html/index.html#012#012*****  Plugin catchall_boolean (7.83 confidence) suggests   ******************#012#012If you want to allow httpd to read user content#012Then you must tell SELinux about this by enabling the 'httpd_read_user_content' boolean.#012#012Do#012setsebool -P httpd_read_user_content 1#012#012*****  Plugin catchall (1.41 confidence) suggests   **************************#012#012If you believe that httpd should be allowed open access on the index.html file by default.#012Then you should report this as a bug.#012You can generate a local policy module to allow this access.#012Do#012allow this access for now by executing:#012# ausearch -c 'httpd' --raw | audit2allow -M my-httpd#012# semodule -i my-httpd.pp#012\n```", "```\n[donnie@localhost ~]$ sudo getenforce\nEnforcing\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo setenforce 0\n\n[donnie@localhost ~]$ sudo getenforce\nPermissive\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo setenforce 1\n\n[donnie@localhost ~]$ sudo getenforce\nEnforcing\n[donnie@localhost ~]$\n```", "```\n# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=enforcing\n# SELINUXTYPE= can take one of three two values:\n#     targeted - Targeted processes are protected,\n#     minimum - Modification of targeted policy. Only selected processes are protected.\n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n```", "```\n# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=permissive\n# SELINUXTYPE= can take one of three two values:\n#     targeted - Targeted processes are protected,\n#     minimum - Modification of targeted policy. Only selected processes are protected.\n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n```", "```\n[donnie@localhost ~]$ sudo sestatus\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          permissive\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMax kernel policy version:      28\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ getsebool -a\nabrt_anon_write --> off\nabrt_handle_event --> off\nabrt_upload_watch_anon_write --> on\nantivirus_can_scan_system --> off\nantivirus_use_jit --> off\nauditadm_exec_content --> on\n. . .\n. . .\nxserver_object_manager --> off\nzabbix_can_network --> off\nzarafa_setrlimit --> off\nzebra_write_config --> off\nzoneminder_anon_write --> off\nzoneminder_run_sudo --> off\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost html]$ getsebool httpd_enable_homedirs\nhttpd_enable_homedirs --> off\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ getsebool -a | grep 'http'\nhttpd_anon_write --> off\nhttpd_builtin_scripting --> on\nhttpd_can_check_spam --> off\nhttpd_can_connect_ftp --> off\nhttpd_can_connect_ldap --> off\nhttpd_can_connect_mythtv --> off\nhttpd_can_connect_zabbix --> off\nhttpd_can_network_connect --> off\n. . .\n. . .\nhttpd_use_nfs --> off\nhttpd_use_openstack --> off\nhttpd_use_sasl --> off\nhttpd_verify_dns --> off\nnamed_tcp_bind_http_port --> off\nprosody_bind_http_port --> off\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ getsebool -a | grep 'home'\ngit_cgi_enable_homedirs --> off\ngit_system_enable_homedirs --> off\nhttpd_enable_homedirs --> off\nmock_enable_homedirs --> off\nmpd_enable_homedirs --> off\nopenvpn_enable_homedirs --> on\nsamba_create_home_dirs --> off\nsamba_enable_home_dirs --> off\nsanlock_enable_home_dirs --> off\nspamd_enable_home_dirs --> on\nssh_chroot_rw_homedirs --> off\ntftp_home_dir --> off\nuse_ecryptfs_home_dirs --> off\nuse_fusefs_home_dirs --> off\nuse_nfs_home_dirs --> off\nuse_samba_home_dirs --> off\nxdm_write_home --> off\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ sudo setsebool samba_enable_home_dirs on\n\n[sudo] password for donnie:\n[donnie@localhost html]$ getsebool samba_enable_home_dirs\nsamba_enable_home_dirs --> on\n[donnie@localhost html]$\n```", "```\n[donnie@localhost html]$ sudo setsebool -P samba_enable_home_dirs on\n\n[donnie@localhost html]$ getsebool samba_enable_home_dirs\nsamba_enable_home_dirs --> on\n[donnie@localhost html]$\n```", "```\n[donnie@localhost ~]$ getsebool httpd_unified\nhttpd_unified --> off\n\n[donnie@localhost ~]$ sudo setsebool -P httpd_unified on\n[sudo] password for donnie:\n[donnie@localhost ~]$ getsebool httpd_unified\nhttpd_unified --> on\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ getsebool httpd_can_sendmail\nhttpd_can_sendmail --> off\n\n[donnie@localhost ~]$ sudo setsebool -P httpd_can_sendmail on\n\n[donnie@localhost ~]$ getsebool httpd_can_sendmail\nhttpd_can_sendmail --> on\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ getsebool httpd_enable_cgi\nhttpd_enable_cgi --> on\n\n[donnie@localhost ~]$ sudo setsebool -P httpd_enable_cgi off\n\n[donnie@localhost ~]$ getsebool httpd_enable_cgi\nhttpd_enable_cgi --> off\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo semanage port -l\n[sudo] password for donnie:\nSELinux Port Type              Proto    Port Number\n\nafs3_callback_port_t           tcp      7001\nafs3_callback_port_t           udp      7001\nafs_bos_port_t                 udp      7007\nafs_fs_port_t                  tcp      2040\nafs_fs_port_t                  udp      7000, 7005\nafs_ka_port_t                  udp      7004\nafs_pt_port_t                  tcp      7002\nafs_pt_port_t                  udp      7002\nafs_vl_port_t                  udp      7003\n. . .\n. . .\nzebra_port_t                   tcp      2606, 2608-2609, 2600-2604\nzebra_port_t                   udp      2606, 2608-2609, 2600-2604\nzented_port_t                  tcp      1229\nzented_port_t                  udp      1229\nzookeeper_client_port_t        tcp      2181\nzookeeper_election_port_t      tcp      3888\nzookeeper_leader_port_t        tcp      2888\nzope_port_t                    tcp      8021\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo semanage port -l | grep 'http'\n[sudo] password for donnie:\nhttp_cache_port_t              tcp      8080, 8118, 8123, 10001-10010\nhttp_cache_port_t              udp      3130\nhttp_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000\npegasus_http_port_t            tcp      5988\npegasus_https_port_t           tcp      5989\n[donnie@localhost ~]$\n```", "```\nListen 80\n```", "```\nListen 443\n```", "```\nListen 82\n```", "```\n[donnie@localhost ~]$ sudo systemctl restart httpd\nJob for httpd.service failed because the control process exited with error code. See \"systemctl status httpd.service\" and \"journalctl -xe\" for details.\n[donnie@localhost ~]$\n```", "```\nNov 29 16:39:21 localhost python: SELinux is preventing /usr/sbin/httpd from name_bind access on the tcp_socket port 82.#012#012***** Plugin bind_ports (99.5 confidence) suggests ************************#012#012If you want to allow /usr/sbin/httpd to bind to network port 82#012Then you need to modify the port type.#012Do#012# semanage port -a -t PORT_TYPE -p tcp 82#012 where PORT_TYPE is one of the following: http_cache_port_t, http_port_t, jboss_management_port_t, jboss_messaging_port_t, ntop_port_t, puppet_port_t.#012#012***** Plugin catchall (1.49 confidence) suggests **************************#012#012If you believe that httpd should be allowed name_bind access on the port 82 tcp_socket by default.#012Then you should report this as a bug.#012You can generate a local policy module to allow this access.#012Do#012allow this access for now by executing:#012# ausearch -c 'httpd' --raw | audit2allow -M my-httpd#012# semodule -i my-httpd.pp#012\n```", "```\n[donnie@localhost ~]$ sudo semanage port -a 82 -t http_port_t -p tcp\n\n[donnie@localhost ~]$ sudo semanage port -l | grep 'http_port_t'\nhttp_port_t                    tcp      82, 80, 81, 443, 488, 8008, 8009, 8443, 9000\npegasus_http_port_t            tcp      5988\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo systemctl restart httpd\n[sudo] password for donnie:\n[donnie@localhost ~]$ sudo systemctl status httpd\n\u25cf httpd.service - The Apache HTTP Server\n Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; vendor preset: disabled)\n Active: active (running) since Wed 2017-11-29 20:09:51 EST; 7s ago\n Docs: man:httpd(8)\n. . .\n. . .\n```", "```\n[donnie@localhost ~]$ sudo semanage port -d 82 -t http_port_t -p tcp\n\n[donnie@localhost ~]$ sudo semanage port -l | grep 'http_port_t'\nhttp_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000\npegasus_http_port_t            tcp      5988\n[donnie@localhost ~]$\n```", "```\nsudo su -\n```", "```\ngrep dict /var/log/audit/audit.log | audit2allow -M dovecot_dict\n```", "```\nsemodule -i dovecot_dict.pp\n```", "```\nsemodule -R\n```", "```\nJun  8 19:32:17 docker-1 setroubleshoot: SELinux is preventing /usr/bin/docker from getattr access on the file /etc/exports. For complete SELinux messages. run sealert -l b267929a-d3ad-45d5-806e-907449fc2739\nJun  8 19:32:17 docker-1 python: SELinux is preventing /usr/bin/docker from getattr access on the file /etc/exports.#012#012*****  Plugin catchall (100\\. confidence) suggests   **************************#012#012If you believe that docker should be allowed getattr access on the exports file by default.#012Then you should report this as a bug.#012You can generate a local policy module to allow this access.#012Do#012allow this access for now by executing:#012# grep docker /var/log/audit/audit.log | audit2allow -M mypol#012# semodule -i mypol.pp#012\nJun  8 19:32:17 docker-1 setroubleshoot: SELinux is preventing /usr/bin/docker from getattr access on the file /etc/shadow.rpmnew. For complete SELinux messages. run sealert -l bc566655-1fbc-4141-af48-ccd6c76a3d3b\nJun  8 19:32:17 docker-1 python: SELinux is preventing /usr/bin/docker from getattr access on the file /etc/shadow.rpmnew.#012#012*****  Plugin catchall (100\\. confidence) suggests   **************************#012#012If you believe that docker should be allowed getattr access on the shadow.rpmnew file by default.#012Then you should report this as a bug.#012You can generate a local policy module to allow this access.#012Do#012allow this access for now by executing:#012# grep docker /var/log/audit/audit.log | audit2allow -M mypol#012# semodule -i mypol.pp#012\n```", "```\n sudo semanage port -l | grep 'http'\n```", "```\n        sudo systemctl restart httpd\n```", "```\n sudo tail -20 /var/log/messages\n```", "```\n        sudo semanage port -a 82 -t http_port_t -p tcp\n sudo semanage port -l\n sudo systemctl restart httpd\n```", "```\n sudo semanage -d 82 -t http_port_t -p tcp\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d$ ls -l\ntotal 72\ndrwxr-xr-x 5 root root  4096 Oct 29 15:21 abstractions\ndrwxr-xr-x 2 root root  4096 Nov 15 09:34 cache\ndrwxr-xr-x 2 root root  4096 Oct 29 14:43 disable\ndrwxr-xr-x 2 root root  4096 Apr  5  2016 force-complain\ndrwxr-xr-x 2 root root  4096 Oct 29 15:21 local\ndrwxr-xr-x 2 root root  4096 Oct 29 15:02 lxc\n-rw-r--r-- 1 root root   198 Jun 14 16:15 lxc-containers\n-rw-r--r-- 1 root root  3310 Apr 12  2016 sbin.dhclient\ndrwxr-xr-x 5 root root  4096 Oct 29 15:21 tunables\n-rw-r--r-- 1 root root   125 Jun 14 16:15 usr.bin.lxc-start\n-rw-r--r-- 1 root root   281 May 23  2017 usr.lib.lxd.lxd-bridge-proxy\n-rw-r--r-- 1 root root 17667 Oct 18 05:04 usr.lib.snapd.snap-confine.real\n-rw-r--r-- 1 root root  1527 Jan  5  2016 usr.sbin.rsyslogd\n-rw-r--r-- 1 root root  1469 Sep  8 15:27 usr.sbin.tcpdump\ndonnie@ubuntu3:/etc/apparmor.d$\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d/abstractions$ ls -l\ntotal 320\n-rw-r--r-- 1 root root  695 Mar 15  2017 apache2-common\ndrwxr-xr-x 2 root root 4096 Oct 29 15:21 apparmor_api\n-rw-r--r-- 1 root root  308 Mar 15  2017 aspell\n-rw-r--r-- 1 root root 1582 Mar 15  2017 audio\n-rw-r--r-- 1 root root 1544 Mar 15  2017 authentication\n-rw-r--r-- 1 root root 6099 Mar 15  2017 base\n-rw-r--r-- 1 root root 1512 Mar 15  2017 bash\n-rw-r--r-- 1 root root  798 Mar 15  2017 consoles\n-rw-r--r-- 1 root root  714 Mar 15  2017 cups-client\n-rw-r--r-- 1 root root  593 Mar 15  2017 dbus\n. . .\n. . .\n-rw-r--r-- 1 root root  705 Mar 15  2017 web-data\n-rw-r--r-- 1 root root  739 Mar 15  2017 winbind\n-rw-r--r-- 1 root root  585 Mar 15  2017 wutmp\n-rw-r--r-- 1 root root 1819 Mar 15  2017 X\n-rw-r--r-- 1 root root  883 Mar 15  2017 xad\n-rw-r--r-- 1 root root  673 Mar 15  2017 xdg-desktop\ndonnie@ubuntu3:/etc/apparmor.d/abstractions$\n```", "```\n  /srv/www/htdocs/ r,\n  /srv/www/htdocs/** r,\n  # virtual hosting\n  /srv/www/vhosts/ r,\n  /srv/www/vhosts/** r,\n  # mod_userdir\n  @{HOME}/public_html/ r,\n  @{HOME}/public_html/** r,\n\n  /srv/www/rails/*/public/ r,\n  /srv/www/rails/*/public/** r,\n\n  /var/www/html/ r,\n  /var/www/html/** r,\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d/tunables$ ls -l\ntotal 56\n-rw-r--r-- 1 root root  624 Mar 15  2017 alias\n-rw-r--r-- 1 root root  376 Mar 15  2017 apparmorfs\n-rw-r--r-- 1 root root  804 Mar 15  2017 dovecot\n-rw-r--r-- 1 root root  694 Mar 15  2017 global\n-rw-r--r-- 1 root root  983 Mar 15  2017 home\ndrwxr-xr-x 2 root root 4096 Oct 29 15:21 home.d\n-rw-r--r-- 1 root root  792 Mar 15  2017 kernelvars\n-rw-r--r-- 1 root root  631 Mar 15  2017 multiarch\ndrwxr-xr-x 2 root root 4096 Mar 15  2017 multiarch.d\n-rw-r--r-- 1 root root  440 Mar 15  2017 proc\n-rw-r--r-- 1 root root  430 Mar 15  2017 securityfs\n-rw-r--r-- 1 root root  368 Mar 15  2017 sys\n-rw-r--r-- 1 root root  868 Mar 15  2017 xdg-user-dirs\ndrwxr-xr-x 2 root root 4096 Oct 29 15:02 xdg-user-dirs.d\ndonnie@ubuntu3:/etc/apparmor.d/tunables$\n```", "```\nsudo apt install apparmor-utils\n```", "```\ndonnie@ubuntu5:~$ sudo aa-status\n[sudo] password for donnie:\n\napparmor module is loaded.\n13 profiles are loaded.\n13 profiles are in enforce mode.\n /sbin/dhclient\n /usr/bin/lxc-start\n /usr/lib/NetworkManager/nm-dhcp-client.action\n /usr/lib/NetworkManager/nm-dhcp-helper\n /usr/lib/connman/scripts/dhclient-script\n /usr/lib/snapd/snap-confine\n /usr/lib/snapd/snap-confine//mount-namespace-capture-helper\n /usr/sbin/mysqld\n /usr/sbin/tcpdump\n lxc-container-default\n lxc-container-default-cgns\n lxc-container-default-with-mounting\n lxc-container-default-with-nesting\n0 profiles are in complain mode.\n1 processes have profiles defined.\n1 processes are in enforce mode.\n /usr/sbin/mysqld (679)\n0 processes are in complain mode.\n0 processes are unconfined but have a profile defined.\ndonnie@ubuntu5:~$\n```", "```\n# This file is intensionally empty to disable apparmor by default for newer\n# versions of MariaDB, while providing seamless upgrade from older versions\n# and from mysql, where apparmor is used.\n#\n# By default, we do not want to have any apparmor profile for the MariaDB\n# server. It does not provide much useful functionality/security, and causes\n# several problems for users who often are not even aware that apparmor\n# exists and runs on their system.\n#\n# Users can modify and maintain their own profile, and in this case it will\n# be used.\n#\n# When upgrading from previous version, users who modified the profile\n# will be promptet to keep or discard it, while for default installs\n# we will automatically disable the profile.\n```", "```\nsudo apt install apparmor-profiles apparmor-profiles-extras\n```", "```\ndonnie@ubuntu5:/etc/apparmor.d$ ls *mbd\nusr.sbin.nmbd  usr.sbin.smbd\ndonnie@ubuntu5:/etc/apparmor.d$\n```", "```\ndonnie@ubuntu5:/etc/apparmor.d$ sudo aa-enforce /usr/sbin/nmbd usr.sbin.nmbd\nSetting /usr/sbin/nmbd to enforce mode.\nSetting /etc/apparmor.d/usr.sbin.nmbd to enforce mode.\n\ndonnie@ubuntu5:/etc/apparmor.d$ sudo aa-enforce /usr/sbin/smbd usr.sbin.smbd\nSetting /usr/sbin/smbd to enforce mode.\nSetting /etc/apparmor.d/usr.sbin.smbd to enforce mode.\ndonnie@ubuntu5:/etc/apparmor.d$\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d$ sudo systemctl restart smbd\nJob for smbd.service failed because the control process exited with error code. See \"systemctl status smbd.service\" and \"journalctl -xe\" for details.\ndonnie@ubuntu3:/etc/apparmor.d$\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d$ sudo systemctl status smbd\n\u25cf smbd.service - LSB: start Samba SMB/CIFS daemon (smbd)\n Loaded: loaded (/etc/init.d/smbd; bad; vendor preset: enabled)\n Active: failed (Result: exit-code) since Tue 2017-12-05 14:56:35 EST; 13s ago\n Docs: man:systemd-sysv-generator(8)\n Process: 31160 ExecStop=/etc/init.d/smbd stop (code=exited, status=0/SUCCESS)\n Process: 31171 ExecStart=/etc/init.d/smbd start (code=exited, status=1/FAILURE)\n\nDec 05 14:56:35 ubuntu3 systemd[1]: Starting LSB: start Samba SMB/CIFS daemon (smbd)...\nDec 05 14:56:35 ubuntu3 smbd[31171]:  * Starting SMB/CIFS daemon smbd\nDec 05 14:56:35 ubuntu3 smbd[31171]:    ...fail!\nDec 05 14:56:35 ubuntu3 systemd[1]: smbd.service: Control process exited, code=exited status=1\nDec 05 14:56:35 ubuntu3 systemd[1]: Failed to start LSB: start Samba SMB/CIFS daemon (smbd).\nDec 05 14:56:35 ubuntu3 systemd[1]: smbd.service: Unit entered failed state.\nDec 05 14:56:35 ubuntu3 systemd[1]: smbd.service: Failed with result 'exit-code'.\ndonnie@ubuntu3:/etc/apparmor.d$\n```", "```\nDec  5 20:09:10 ubuntu3 smbd[14599]:  * Starting SMB/CIFS daemon smbd\nDec  5 20:09:10 ubuntu3 kernel: [174226.392671] audit: type=1400 audit(1512522550.765:510): apparmor=\"DENIED\" operation=\"mknod\" profile=\"/usr/sbin/smbd\" name=\"/run/samba/msg.\nlock/14612\" pid=14612 comm=\"smbd\" requested_mask=\"c\" denied_mask=\"c\" fsuid=0 ouid=0\nDec  5 20:09:10 ubuntu3 smbd[14599]:    ...fail!\nDec  5 20:09:10 ubuntu3 systemd[1]: smbd.service: Control process exited, code=exited status=1\nDec  5 20:09:10 ubuntu3 systemd[1]: Failed to start LSB: start Samba SMB/CIFS daemon (smbd).\nDec  5 20:09:10 ubuntu3 systemd[1]: smbd.service: Unit entered failed state.\nDec  5 20:09:10 ubuntu3 systemd[1]: smbd.service: Failed with result 'exit-code'.\n```", "```\n/run/samba/** rw,\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d$ sudo apparmor_parser -r usr.sbin.smbd\ndonnie@ubuntu3:/etc/apparmor.d$\n```", "```\ndonnie@ubuntu3:/etc/apparmor.d$ sudo systemctl restart smbd\n\ndonnie@ubuntu3:/etc/apparmor.d$ sudo systemctl status smbd\n\u25cf smbd.service - LSB: start Samba SMB/CIFS daemon (smbd)\n Loaded: loaded (/etc/init.d/smbd; bad; vendor preset: enabled)\n Active: active (running) since Wed 2017-12-06 13:31:32 EST; 3min 6s ago\n Docs: man:systemd-sysv-generator(8)\n Process: 17317 ExecStop=/etc/init.d/smbd stop (code=exited, status=0/SUCCESS)\n Process: 16474 ExecReload=/etc/init.d/smbd reload (code=exited, status=0/SUCCESS)\n Process: 17326 ExecStart=/etc/init.d/smbd start (code=exited, status=0/SUCCESS)\n Tasks: 3\n Memory: 9.3M\n CPU: 594ms\n CGroup: /system.slice/smbd.service\n \u251c\u250017342 /usr/sbin/smbd -D\n \u251c\u250017343 /usr/sbin/smbd -D\n \u2514\u250017345 /usr/sbin/smbd -D\n\nDec 06 13:31:28 ubuntu3 systemd[1]: Stopped LSB: start Samba SMB/CIFS daemon (smbd).\nDec 06 13:31:28 ubuntu3 systemd[1]: Starting LSB: start Samba SMB/CIFS daemon (smbd)...\nDec 06 13:31:32 ubuntu3 smbd[17326]:  * Starting SMB/CIFS daemon smbd\nDec 06 13:31:32 ubuntu3 smbd[17326]:    ...done.\nDec 06 13:31:32 ubuntu3 systemd[1]: Started LSB: start Samba SMB/CIFS daemon (smbd).\ndonnie@ubuntu3:/etc/apparmor.d$\n```"]