# 前言

Shell 脚本允许我们以链式编程命令，并让系统将它们作为脚本事件执行，就像批处理文件一样。这本书将从 Linux 和 Bash shell 脚本的概述开始，然后迅速深入帮助你设置本地环境，然后介绍用于编写 shell 脚本的工具。接下来的一系列章节将重点帮助你了解 Linux 的内部机制以及 Bash 为用户提供的内容。很快，你将开始沿着命令行进行旅程。你现在将开始编写实际的脚本而不是命令，并将介绍脚本的实际应用。最后一系列章节将深入探讨 shell 脚本中的更高级主题。这些高级主题将把你从简单的脚本带到现实世界中存在的可重用的有价值的程序。最后一章将为你提供一些方便的技巧和窍门，以及包含最有趣的标志和选项的备忘单，涉及最常用的命令。

完成这本书后，你应该对开始自己的 shell 脚本项目感到自信，无论之前的任务看起来多么简单或复杂。我们的目标是教会你*如何*编写脚本和*需要考虑什么*，以补充你在日常脚本挑战中可以使用的清晰模式。

# 这本书是为谁写的

这本书面向新的和现有的 Linux 系统管理员，以及对自动化管理任务感兴趣的 Windows 系统管理员或开发人员。不需要先前的 shell 脚本经验，但如果你有一些经验，这本书将迅速让你成为专家。读者应该对命令行有（非常）基本的理解。

# 这本书涵盖了什么

第一章，*介绍*，为你做好了本书的余下部分。在 Linux 和 Bash 的一些背景知识的帮助下，你应该更能够理解为什么以及如何 shell 脚本可以为你提供明显的好处。

第二章，*设置本地环境*，帮助你准备好本地机器，以便在本书的其余部分中进行示例和练习。你将学会如何在本地机器上使用 VirtualBox 设置 Ubuntu 18.04 Linux 虚拟机。这个虚拟机将用于在本书中编写、运行和调试命令和脚本。

第三章，*选择合适的工具*，介绍了用于编写 shell 脚本的工具。将描述两种不同类型的工具：IDE 编辑器（Atom，Notepad++）和基于终端的编辑器（vim 和 nano）。你将被鼓励最初在 IDE 中编写脚本，并在基于终端的编辑器中排除故障，以最接近真实世界的使用。

第四章，*Linux 文件系统*，通过探索前几章创建的虚拟机，介绍了 Linux 文件系统的组织方式。你将通过执行第一个命令行操作（如`cd`、`pwd`和`ls`）来实现这一点。将提供有关不同结构的上下文，以便你在编写脚本时使用这些信息。最重要的是，将解释一切都是文件的概念。

第五章，*理解 Linux 权限方案*，让你熟悉 Linux 下的权限，再次通过探索虚拟机。诸如`sudo`、`chmod`和`chown`之类的命令将被用来交互式地学习文件和目录权限。在本章中获得的技能将在 shell 脚本中大量使用，因此你必须接触到命令的成功执行以及失败消息。

第六章，文件操作，向您介绍了最相关的文件操作命令，包括这些命令的最常用标志和修饰符。这将通过虚拟机内的命令实现。

第七章，Hello World！，在撰写脚本时，教育您提前思考和养成良好习惯。在本章中，您将编写您的第一个实际的 shell 脚本。

第八章，变量和用户输入，向您介绍了变量和用户输入。您将看到 Bash 如何使用参数，以及参数和参数之间的区别。用户输入将被处理并用于在您的脚本中生成新函数。最后，将澄清和讨论交互式和非交互式脚本之间的区别。

第九章，错误检查和处理，使您熟悉（用户）输入，错误检查和处理。将用户输入引入脚本中很可能会导致更多的错误，除非脚本专门处理用户提交的不正确或意外的输入可能性。您将学习如何最好地处理这个问题。

第十章，正则表达式，使您熟悉常用于 shell 脚本的正则表达式。将介绍这些正则表达式的最常见模式和用法。本章还将介绍`sed`的基本用法，以补充正则表达式的解释。

第十一章，条件测试和脚本循环，讨论了在 Bash 中使用的不同类型的循环和相关控制结构。

第十二章，在脚本中使用管道和重定向，向您介绍了 Linux 上的重定向。本章将从基本的输入/输出重定向开始，然后继续流重定向和管道。

第十三章，函数，向您介绍了函数。函数将被呈现为代码块，这些代码块以这样的方式组合在一起，以便它们可以被重复使用，通常使用不同的参数，以产生稍微不同的最终结果。您将学会理解重用代码的好处，并相应地规划脚本。

第十四章，调度和日志记录，教您如何安排脚本，并确保这些计划的脚本执行它们旨在执行的任务，方法是使用 crontab 和`at`命令，以及适当的日志记录。

第十五章，使用 getopts 解析 Bash 脚本参数，帮助您通过添加标志而不是位置参数来改进脚本，从而使脚本更容易使用。

第十六章，Bash 参数替换和扩展，展示了如何通过参数扩展、替换和变量操作来优化先前在早期脚本中使用的模式。

第十七章，Cheat Sheet 中的技巧和技巧，为您提供了一些方便的技巧和技巧，这些技巧和技巧不一定在 Bash 脚本中使用，但在终端上工作时非常方便。对于最常用的命令，将提供包含最有趣的标志和选项的备忘单，以便您在编写脚本时将本章用作参考。

# 为了充分利用本书

您需要一个 Ubuntu 18.04 Linux 虚拟机来跟随本书。我们将在第二章中指导您设置这一点。只有当您**跟随所有代码示例**时，您才能真正学会 shell 脚本编写。整本书都是以此为出发点编写的，所以请务必遵循这些建议！

# 下载示例代码文件

您可以从您在[www.packtpub.com](http://www.packtpub.com)的帐户中下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便文件直接发送到您的邮箱。

您可以按照以下步骤下载代码文件：

1.  在[www.packtpub.com](http://www.packtpub.com/support)登录或注册。

1.  选择“支持”选项卡。

1.  点击“代码下载和勘误”。

1.  在搜索框中输入书名，然后按照屏幕上的说明操作。

一旦文件下载完成，请确保您使用最新版本的解压缩或提取文件夹：

+   WinRAR/7-Zip for Windows

+   Zipeg/iZip/UnRarX for Mac

+   7-Zip/PeaZip for Linux

本书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Learn-Linux-Shell-Scripting-Fundamentals-of-Bash-4.4`](https://github.com/PacktPublishing/Learn-Linux-Shell-Scripting-Fundamentals-of-Bash-4.4)。如果代码有更新，将会在现有的 GitHub 仓库上进行更新。

我们还有其他代码包，来自我们丰富的书籍和视频目录，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)上找到。快去看看吧！

# 下载彩色图片

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图片。您可以在这里下载：[`www.packtpub.com/sites/default/files/downloads/9781788995597_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/9781788995597_ColorImages.pdf)。

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。这是一个例子：“让我们试着将`/tmp/`目录复制到我们的`home`目录中。”

代码块设置如下：

```
#!/bin/bash

echo "Hello World!"
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：

```
reader@ubuntu:~/scripts/chapter_10$ grep 'use' grep-file.txt 
We can use this regular file for testing grep.
but in the USA they use color (and realize)!
```

任何命令行输入或输出都写成如下形式：

```
reader@ubuntu:~/scripts/chapter_10$ grep 'e.e' character-class.txt 
eee
e2e
e e
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词会以这种形式出现在文本中。这是一个例子：“点击`安装`按钮，然后观看安装过程。”

警告或重要说明会出现在这样的形式中。

提示和技巧会以这种形式出现。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：发送电子邮件至`feedback@packtpub.com`，并在主题中提及书名。如果您对本书的任何方面有疑问，请发送电子邮件至`questions@packtpub.com`与我们联系。

**勘误**：尽管我们已经非常注意确保内容的准确性，但错误是难免的。如果您在本书中发现错误，我们将不胜感激。请访问[www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的书，点击勘误提交表格链接，并输入详细信息。

**盗版**：如果您在互联网上发现我们作品的任何形式的非法副本，我们将不胜感激，如果您能向我们提供位置地址或网站名称。请通过`copyright@packtpub.com`与我们联系，并附上材料链接。

**如果您有兴趣成为作者**：如果您在某个专题上有专业知识，并且有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。阅读并使用本书后，为什么不在购买它的网站上留下评论呢？潜在的读者可以看到并使用您的客观意见来做出购买决定，我们在 Packt 可以了解您对我们产品的看法，我们的作者可以看到您对他们书籍的反馈。谢谢！

有关 Packt 的更多信息，请访问 [packtpub.com](https://www.packtpub.com/)。

# 免责声明

本书中的信息仅供以合乎道德的方式使用。如果您没有设备所有者的书面许可，请不要使用本书中的任何信息。如果您进行非法行为，您可能会被逮捕并依法起诉。Packt Publishing 不对您滥用本书中的任何信息承担任何责任。本书中的信息必须在获得适当人员的书面授权的测试环境中使用。
