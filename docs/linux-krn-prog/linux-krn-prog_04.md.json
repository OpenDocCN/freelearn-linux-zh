["```\n$ cd ${LLKD_KSRC}     # the env var LLKD_KSRC holds the 'root' of our \n                      # 5.4 kernel source tree\n$ make help\n[...]\nOther generic targets:\n  all - Build all targets marked with [*]\n* vmlinux - Build the bare kernel\n* modules - Build all modules\n[...]\nArchitecture specific targets (x86):\n* bzImage - Compressed kernel image (arch/x86/boot/bzImage)\n[...]\n$ \n```", "```\nn = num-CPU-cores * factor;\n```", "```\n$ nproc\n2 \n```", "```\n$ time make -j4\nscripts/kconfig/conf --syncconfig Kconfig\n UPD include/config/kernel.release\nwarning: Cannot use CONFIG_STACK_VALIDATION=y, please install libelf-dev, libelf-devel or elfutils-libelf-devel\n[...]\n```", "```\n$ cd ${LLKD_KSRC} $ time make -j4 scripts/kconfig/conf --syncconfig Kconfig SYSHDR arch/x86/include/generated/asm/unistd_32_ia32.h\n SYSTBL arch/x86/include/generated/asm/syscalls_32.h\n[...]\n  DESCEND objtool\n  HOSTCC /home/llkd/kernels/linux-5.4/tools/objtool/fixdep.o\n  HOSTLD /home/llkd/kernels/linux-5.4/tools/objtool/fixdep-in.o\n  LINK /home/llkd/kernels/linux-5.4/tools/objtool/fixdep\n[...]\n\n[...]\n  LD      vmlinux.o\n  MODPOST vmlinux.o\n  MODINFO modules.builtin.modinfo\n  LD      .tmp_vmlinux1\n  KSYM    .tmp_kallsyms1.o\n  LD      .tmp_vmlinux2\n  KSYM    .tmp_kallsyms2.o\n LD      vmlinux\n  SORTEX  vmlinux\n  SYSMAP  System.map\n  Building modules, stage 2.\n MODPOST 59 modules\n  CC      arch/x86/boot/a20.o\n[...]\n  LD      arch/x86/boot/setup.elf\n  OBJCOPY arch/x86/boot/setup.bin\n  BUILD   arch/x86/boot/bzImage\nSetup is 17724 bytes (padded to 17920 bytes).\nSystem is 8385 kB\nCRC 6f010e63\n  CC [M]  drivers/hid/hid.mod.o\nKernel: arch/x86/boot/bzImage is ready  (#1)\n```", "```\n[...]\n  CC [M]  drivers/hid/usbhid/usbhid.mod.o\n  CC [M]  drivers/i2c/algos/i2c-algo-bit.mod.o\n[...]\n  LD [M] sound/pci/snd-intel8x0.ko\n  LD [M] sound/soundcore.ko\n\nreal     17m31.980s\nuser     23m58.451s\nsys      3m22.280s\n$\n```", "```\n$ ls -lh vmlinux System.map\n-rw-rw-r-- 1 llkd llkd 4.1M Jan 17 12:27 System.map\n-rwxrwxr-x 1 llkd llkd 591M Jan 17 12:27 vmlinux\n$ file ./vmlinux\n./vmlinux: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, BuildID[sha1]=<...>, with debug_info, not stripped\n```", "```\n$ ls -l arch/x86/boot/bzImage -rw-rw-r-- 1 llkd llkd 8604032 Jan 17 12:27 arch/x86/boot/bzImage$ file arch/x86/boot/bzImage\narch/x86/boot/bzImage: Linux kernel x86 boot executable bzImage, version 5.4.0-llkd01 (llkd@llkd-vbox) #1 SMP Thu [...], RO-rootFS, swap_dev 0x8, Normal VGA\n```", "```\n$ cd ${LLKD_KSRC}\n$ find . -name \"*.ko\"\n./arch/x86/events/intel/intel-rapl-perf.ko\n./arch/x86/crypto/crc32-pclmul.ko\n./arch/x86/crypto/ghash-clmulni-intel.ko\n[...]\n./net/ipv4/netfilter/ip_tables.ko\n./net/sched/sch_fq_codel.ko\n$ find . -name \"*.ko\" | wc -l\n59 \n```", "```\n$ find . -name \"*.ko\" -ls | egrep -i \"vbox|msdos|uio\" | awk '{printf \"%-40s %9d\\n\", $11, $7}'\n./fs/fat/msdos.ko                           361896\n./drivers/virt/vboxguest/vboxguest.ko       948752\n./drivers/gpu/drm/vboxvideo/vboxvideo.ko   3279528\n./drivers/uio/uio.ko                        408136\n./drivers/uio/uio_pdrv_genirq.ko            324568\n$ \n```", "```\n$ cd ${LLKD_KSRC} $ sudo make modules_install [sudo] password for llkd: \n  INSTALL arch/x86/crypto/aesni-intel.ko\n  INSTALL arch/x86/crypto/crc32-pclmul.ko\n  INSTALL arch/x86/crypto/crct10dif-pclmul.ko\n[...]\n  INSTALL sound/pci/snd-intel8x0.ko\n  INSTALL sound/soundcore.ko\n  DEPMOD 5.4.0-llkd01\n$ \n```", "```\n$ uname -r\n5.0.0-36-generic        # this is the 'distro' kernel (for Ubuntu 18.04.3 LTS) we're running on\n$ ls /lib/modules/\n5.0.0-23-generic 5.0.0-36-generic 5.4.0-llkd01\n$ \n```", "```\n$ ls /lib/modules/5.4.0-llkd01/kernel/\narch/  crypto/  drivers/  fs/  net/  sound/\n```", "```\n$ find /lib/modules/5.4.0-llkd01/kernel/ -name \"*.ko\" | egrep \"vboxguest|msdos|uio\"\n/lib/modules/5.4.0-llkd01/kernel/fs/fat/msdos.ko\n/lib/modules/5.4.0-llkd01/kernel/drivers/virt/vboxguest/vboxguest.ko\n/lib/modules/5.4.0-llkd01/kernel/drivers/uio/uio.ko\n/lib/modules/5.4.0-llkd01/kernel/drivers/uio/uio_pdrv_genirq.ko\n$ \n```", "```\nexport STG_MYKMODS=../staging/rootfs/my_kernel_modules\nmake INSTALL_MOD_PATH=${STG_MYKMODS} modules_install\n```", "```\n$ sudo make install sh ./arch/x86/boot/install.sh 5.4.0-llkd01 arch/x86/boot/bzImage \\\n  System.map \"/boot\"\nrun-parts: executing /etc/kernel/postinst.d/apt-auto-removal 5.4.0-llkd01 /boot/vmlinuz-5.4.0-llkd01\nrun-parts: executing /etc/kernel/postinst.d/initramfs-tools 5.4.0-llkd01 /boot/vmlinuz-5.4.0-llkd01\nupdate-initramfs: Generating /boot/initrd.img-5.4.0-llkd01\n[...]\nrun-parts: executing /etc/kernel/postinst.d/zz-update-grub 5.4.0-llkd01 /boot/vmlinuz-5.4.0-llkd01\nSourcing file `/etc/default/grub'\nGenerating grub configuration file ...\nFound linux image: /boot/vmlinuz-5.4.0-llkd01\nFound initrd image: /boot/initrd.img-5.4.0-llkd01\n[...]\nFound linux image: /boot/vmlinuz-5.0.0-36-generic\nFound initrd image: /boot/initrd.img-5.0.0-36-generic\n[...]\ndone\n$\n```", "```\n$ sudo make ARCH=x86_64 install\nsh ./arch/x86/boot/install.sh 5.4.0-llkd01 arch/x86/boot/bzImage \\\nSystem.map \"/boot\"\nCannot find LILO.\n$\n```", "```\n sudo mkinitrd /boot/initramfs-5.4.0-llkd01.img 5.4.0-llkd01\n```", "```\nsudo dnf install grubby-deprecated-8.40-36.fc31.x86_64\n```", "```\n$ sudo make ARCH=x86_64 install\n sh ./arch/x86/boot/install.sh 5.4.0-llkd01 arch/x86/boot/bzImage \\\n System.map \"/boot\"\n grubby fatal error: unable to find a suitable template\n grubby fatal error: unable to find a suitable template\n grubby: doing this would leave no kernel entries. Not writing out new config.\n $\n```", "```\n $ ls -lht /boot\n total 204M\n -rw-------. 1 root root  44M Mar 26 13:08 initramfs-5.4.0-llkd01.img\n lrwxrwxrwx. 1 root root   29 Mar 26 13:07 System.map -> /boot/System.map-5.4.0-llkd01\n lrwxrwxrwx. 1 root root   26 Mar 26 13:07 vmlinuz -> /boot/vmlinuz-5.4.0-llkd01\n -rw-r--r--. 1 root root 4.1M Mar 26 13:07 System.map-5.4.0-llkd01\n -rw-r--r--. 1 root root 9.0M Mar 26 13:07 vmlinuz-5.4.0-llkd01\n[...]\n```", "```\n$ sudo make install sh ./arch/x86/boot/install.sh 5.4.0-llkd01 arch/x86/boot/bzImage \\\n System.map \"/boot\"\n```", "```\nSystem.map-5.4.0-llkd01, initrd.img-5.4.0-llkd01, vmlinuz-5.4.0-llkd01, config-5.4.0-llkd01\n```", "```\n$ lsinitramfs /boot/initrd.img-5.4.0-llkd01 | wc -l\n334\n$ lsinitramfs /boot/initrd.img-5.4.0-llkd01\n.\nkernel\nkernel/x86\n[...]\nlib\nlib/systemd\nlib/systemd/network\nlib/systemd/network/99-default.link\nlib/systemd/systemd-udevd\n[...]\nlib/modules/5.4.0-llkd01/kernel/drivers/net/ethernet/intel/e1000/e1000.ko\nlib/modules/5.4.0-llkd01/modules.dep\n[...]\nlib/x86_64-linux-gnu/libc-2.27.so\n[...]\nlib/x86_64-linux-gnu/libaudit.so.1\nlib/x86_64-linux-gnu/ld-2.27.so\nlib/x86_64-linux-gnu/libpthread.so.0\n[...]\netc/udev/udev.conf\netc/fstab\netc/modprobe.d\n[...]\nbin/dmesg\nbin/date\nbin/udevadm\nbin/reboot\n[...]\nsbin/fsck.ext4\nsbin/dmsetup\nsbin/blkid\nsbin/modprobe\n[...]\nscripts/local-premount/resume\nscripts/local-premount/ntfs_3g\n$\n```", "```\n$ TMPDIR=$(mktemp -d)\n$ unmkinitramfs /boot/initrd.img-5.4.0-llkd01 ${TMPDIR}\n$ tree ${TMPDIR} | less\n/tmp/tmp.T53zY3gR91\n\u251c\u2500\u2500 early\n\u2502   \u2514\u2500\u2500 kernel\n\u2502       \u2514\u2500\u2500 x86\n\u2502           \u2514\u2500\u2500 microcode\n\u2502               \u2514\u2500\u2500 AuthenticAMD.bin\n\u2514\u2500\u2500 main\n    \u251c\u2500\u2500 bin\n    \u2502   \u251c\u2500\u2500 [\n    \u2502   \u251c\u2500\u2500 [[\n    \u2502   \u251c\u2500\u2500 acpid\n    \u2502   \u251c\u2500\u2500 ash\n    \u2502   \u251c\u2500\u2500 awk\n[...]\n  \u251c\u2500\u2500 etc\n    \u2502   \u251c\u2500\u2500 console-setup\n    \u2502   \u2502   \u251c\u2500\u2500 cached_UTF-8_del.kmap.gz\n[...]\n   \u251c\u2500\u2500 init\n   \u251c\u2500\u2500 lib\n[...]\n    \u2502   \u251c\u2500\u2500 modules\n    \u2502   \u2502   \u2514\u2500\u2500 5.4.0-llkd01\n    \u2502   \u2502   \u251c\u2500\u2500 kernel\n    \u2502   \u2502   \u2502   \u2514\u2500\u2500 drivers\n[...]\n    \u251c\u2500\u2500 scripts\n    \u2502   \u251c\u2500\u2500 functions\n    \u2502   \u251c\u2500\u2500 init-bottom\n[...]\n    \u2514\u2500\u2500 var\n        \u2514\u2500\u2500 lib\n            \u2514\u2500\u2500 dhcp\n$ \n```", "```\nsudo cp /etc/default/grub /etc/default/grub.orig\n\n```", "```\nsudo vi /etc/default/grub \n```", "```\nGRUB_HIDDEN_TIMEOUT_QUIET=false\n```", "```\nGRUB_TIMEOUT=3\n```", "```\n#GRUB_HIDDEN_TIMEOUT=1\n```", "```\nsudo update-grub\n```", "```\nGRUB_DEFAULT=\"Advanced options for Ubuntu>Ubuntu, with Linux 5.0.0-36-generic\"\n```", "```\n$ cat /etc/default/grub\n[...]\n#GRUB_DEFAULT=0\nGRUB_DEFAULT=\"Advanced options for Ubuntu>Ubuntu, with Linux 5.0.0-36-generic\"\n#GRUB_TIMEOUT_STYLE=hidden\nGRUB_HIDDEN_TIMEOUT_QUIET=false\nGRUB_TIMEOUT=3\nGRUB_DISTRIBUTOR=`lsb_release -i -s 2> /dev/null || echo Debian`\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"\nGRUB_CMDLINE_LINUX=\"\"\n[...] \n```", "```\n$ sudo reboot\n[sudo] password for llkd: \n```", "```\n               linux       /boot/vmlinuz-5.0.0-36-generic \\ root=UUID=<...> ro quiet splash single\n```", "```\n$ uname -r\n5.4.0-llkd01\n```", "```\n$ ${LLKD_KSRC}/scripts/extract-ikconfig /boot/vmlinuz-5.4.0-llkd01\n#\n# Automatically generated file; DO NOT EDIT.\n# Linux/x86 5.4.0 Kernel Configuration\n[...]\nCONFIG_IRQ_WORK=y\n[...]\n```", "```\n$ scripts/extract-ikconfig /boot/vmlinuz-5.4.0-llkd01 | egrep \"IKCONFIG|HAMRADIO|PROFILING|VBOXGUEST|UIO|MSDOS_FS|SECURITY|DEBUG_STACK_USAGE\"\nCONFIG_IKCONFIG=y\nCONFIG_IKCONFIG_PROC=y\n# CONFIG_PROFILING is not set\n# CONFIG_HAMRADIO is not set\nCONFIG_UIO=m\n# CONFIG_UIO_CIF is not set\nCONFIG_UIO_PDRV_GENIRQ=m\n# CONFIG_UIO_DMEM_GENIRQ is not set\n[...]\nCONFIG_VBOXGUEST=m\nCONFIG_EXT4_FS_SECURITY=y\nCONFIG_MSDOS_FS=m\n# CONFIG_SECURITY_DMESG_RESTRICT is not set\n# CONFIG_SECURITY is not set\nCONFIG_SECURITYFS=y\nCONFIG_DEFAULT_SECURITY_DAC=y\nCONFIG_DEBUG_STACK_USAGE=y\n$ \n```", "```\ngunzip -c /proc/config.gz | egrep \\ \"IKCONFIG|HAMRADIO|PROFILING|VBOXGUEST|UIO|MSDOS_FS|SECURITY|DEBUG_STACK_USAGE\"\n```", "```\nexport RPI_STG=~/rpi_work\nmkdir -p ${RPI_STG}/kernel_rpi ${RPI_STG}/rpi_tools\n```", "```\ncd ${RPI_STG}/kernel_rpi\ngit clone --depth=1 --branch rpi-5.4.y https://github.com/raspberrypi/linux.git\n```", "```\n$ cd ${RPI_STG}/kernel_rpi/linux ; head -n5 Makefile\n# SPDX-License-Identifier: GPL-2.0\nVERSION = 5\nPATCHLEVEL = 4\nSUBLEVEL = 51\nEXTRAVERSION =\n```", "```\nsudo apt install \u200bcrossbuild-essential-armhf\n```", "```\n$ which arm-linux-gnueabihf-gcc\n/usr/bin/arm-linux-gnueabihf-gcc\n$ arm-linux-gnueabihf-gcc --version |head -n1\narm-linux-gnueabihf-gcc (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0\n```", "```\ncd ${RPI_STG}/rpi_tools\ngit clone https://github.com/raspberrypi/tools\n```", "```\nexport PATH=${PATH}:${RPI_STG}/rpi_tools/tools/arm-bcm2708/arm-linux-gnueabihf/bin/\n\n```", "```\ncd ${RPI_STG}/kernel_rpi/linux\nmake mrproper\nKERNEL=kernel7\nmake ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- bcm2709_defconfig\n```", "```\nmake ARCH=arm menuconfig\n```", "```\nmake -j4 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs\n```", "```\n$ ls -lh vmlinux System.map arch/arm/boot/zImage\n-rwxrwxr-x 1 llkd llkd  5.3M Jul 23 12:58 arch/arm/boot/zImage\n-rw-rw-r-- 1 llkd llkd  2.5M Jul 23 12:58 System.map\n-rwxrwxr-x 1 llkd llkd   16M Jul 23 12:58 vmlinux\n$ \n```", "```\nsudo env PATH=$PATH make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-  INSTALL_MOD_PATH=/media/${USER}/rootfs modules_install\n```", "```\nsudo cp arch/arm/boot/dts/*.dtb /media/${USER}/boot\nsudo cp arch/arm/boot/dts/overlays/*.dtb* arch/arm/boot/dts/overlays/README /media/${USER}/boot/overlays\nsync \n```", "```\n$ make help\n[ ... ]\nKernel packaging:\n rpm-pkg - Build both source and binary RPM kernel packages\n binrpm-pkg - Build only the binary kernel RPM package\n deb-pkg - Build both source and binary deb kernel packages\n bindeb-pkg - Build only the binary kernel deb package\n snap-pkg - Build only the binary kernel snap package (will connect to external hosts)\n tar-pkg - Build the kernel as an uncompressed tarball\n targz-pkg - Build the kernel as a gzip compressed tarball\n tarbz2-pkg - Build the kernel as a bzip2 compressed tarball\n tarxz-pkg - Build the kernel as a xz compressed tarball\n[ ... ]\n```", "```\n$ make -j8 bindeb-pkg\nscripts/kconfig/conf --syncconfig Kconfig\nsh ./scripts/package/mkdebian\ndpkg-buildpackage -r\"fakeroot -u\" -a$(cat debian/arch) -b -nc -uc\ndpkg-buildpackage: info: source package linux-5.4.0-min1\ndpkg-buildpackage: info: source version 5.4.0-min1-1\ndpkg-buildpackage: info: source distribution bionic\n[ ... ]\n```", "```\n$ ls -l ../*.deb\n-rw-r--r-- 1 kaiwan kaiwan 11106860 Feb 19 17:05 ../linux-headers-5.4.0-min1_5.4.0-min1-1_amd64.deb\n-rw-r--r-- 1 kaiwan kaiwan 8206880 Feb 19 17:05 ../linux-image-5.4.0-min1_5.4.0-min1-1_amd64.deb\n-rw-r--r-- 1 kaiwan kaiwan 1066996 Feb 19 17:05 ../linux-libc-dev_5.4.0-min1-1_amd64.deb\n```", "```\n$ make V=1 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs\n[...]\nmake -f ./scripts/Makefile.build obj=kernel/sched\narm-linux-gnueabihf-gcc -Wp,-MD,kernel/sched/.core.o.d \n -nostdinc \n -isystem <...>/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf/bin/../lib/gcc/arm-linux-gnueabihf/7.3.1/include \n -I./arch/arm/include -I./arch/arm/include/generated/uapi \n -I./arch/arm/include/generated -I./include \n -I./arch/arm/include/uapi -I./include/uapi \n -I./include/generated/uapi -include ./include/linux/kconfig.h \n -D__KERNEL__ -mlittle-endian -Wall -Wundef -Wstrict-prototypes \n -Wno-trigraphs -fno-strict-aliasing -fno-common \n -Werror-implicit-function-declaration -Wno-format-security \n -std=gnu89 -fno-PIE -fno-dwarf2-cfi-asm -fno-omit-frame-pointer \n -mapcs -mno-sched-prolog -fno-ipa-sra -mabi=aapcs-linux \n -mno-thumb-interwork -mfpu=vfp -funwind-tables -marm \n -D__LINUX_ARM_ARCH__=7 -march=armv7-a -msoft-float -Uarm \n -fno-delete-null-pointer-checks -Wno-frame-address \n -Wno-format-truncation -Wno-format-overflow \n -Wno-int-in-bool-context -O2 --param=allow-store-data-races=0 \n -DCC_HAVE_ASM_GOTO -Wframe-larger-than=1024 -fno-stack-protector \n -Wno-unused-but-set-variable -Wno-unused-const-variable \n -fno-omit-frame-pointer -fno-optimize-sibling-calls \n -fno-var-tracking-assignments -pg -Wdeclaration-after-statement \n -Wno-pointer-sign -fno-strict-overflow -fno-stack-check \n -fconserve-stack -Werror=implicit-int -Werror=strict-prototypes \n -Werror=date-time -Werror=incompatible-pointer-types \n -fno-omit-frame-pointer -DKBUILD_BASENAME='\"core\"' \n -DKBUILD_MODNAME='\"core\"' -c -o kernel/sched/.tmp_core.o  \n kernel/sched/core.c\n[...]\n```", "```\ntime make -j4 [ARCH=<...> CROSS_COMPILE=<...>] all && sudo make modules_install && sudo make install\n```", "```\n$ make\n[...]\nCC scripts/mod/empty.o\nscripts/mod/empty.c:1:0: error: code model kernel does not support PIC mode\n/* empty file to figure out endianness / word size */\n[...]\n```", "```\n[...] fatal error: openssl/opensslv.h: No such file or directory\n```", "```\nmake -j4\n[...]\nHOSTCC scripts/sign-file\nscripts/sign-file.c:25:10: fatal error: openssl/opensslv.h: No such file or directory\n #include <openssl/opensslv.h>\n ^~~~~~~~~~~~~~~~~~~~\ncompilation terminated.\nmake[1]: *** [scripts/Makefile.host:90: scripts/sign-file] Error 1\nmake[1]: *** Waiting for unfinished jobs....\nmake: *** [Makefile:1067: scripts] Error 2\nmake: *** Waiting for unfinished jobs....\n```", "```\nsudo dnf install openssl-devel-1:1.1.1-3.fc29\n```"]