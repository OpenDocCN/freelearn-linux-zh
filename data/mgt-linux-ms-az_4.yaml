- en: 4\. Performing migration to Azure
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 4. 迁移到Azure
- en: This chapter outlines how to execute a real migration project based on the workload
    assessment done in the previous chapter. We have created two hands-on labs to
    show you how real-life migrations can be implemented.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章概述了如何根据前一章中完成的工作负载评估执行真实的迁移项目。我们创建了两个实践实验室，向您展示现实生活中的迁移如何实施。
- en: The first hands-on lab gives you practical examples of how to migrate Linux
    servers from a Hyper-V host to Azure using Azure Migrate. The second lab guides
    you through migrating a MySQL server to Azure using Azure **Database Migration
    Service** (**DMS**).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个实践实验室为您提供了如何使用Azure Migrate将Linux服务器从Hyper-V主机迁移到Azure的实际示例。第二个实验室将指导您如何使用Azure数据库迁移服务（DMS）将MySQL服务器迁移到Azure。
- en: Executing migrations in real life is not always as easy as it sounds. Most problems
    we have seen are fortunately not actually technology-related, but more about planning
    and project management. If you apply the lessons of this book to your projects,
    you will be able to avoid the same pitfalls.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实生活中执行迁移并不总是像听起来那么容易。我们见过的大多数问题幸运地并不实际上与技术相关，而更多地涉及规划和项目管理。如果您将本书的教训应用到您的项目中，您将能够避免相同的陷阱。
- en: For example, one specific migration project we know of was originally planned
    to take a couple of months and it had about 500 virtual servers to migrate to
    Azure. The project turned out to be a bit more complex than originally planned.
    Some problems on the project started right after the project kickoff. The team
    in charge of the migration had severely underestimated the resources and skills
    required in the project. Eventually, the project scope was shrunk, and external
    cloud specialists were invited to advise on some of the most difficult parts of
    the project. It is no surprise that some of those parts were related to Linux
    patch management, subscription management, and security. Do you remember that
    we talked about these topics earlier in this book? Now you know why.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们知道的一个具体的迁移项目最初计划需要几个月的时间，大约有500台虚拟服务器需要迁移到Azure。项目的复杂程度比最初计划的要高。项目开始后不久就出现了一些问题。负责迁移的团队严重低估了项目所需的资源和技能。最终，项目范围被缩小，并邀请外部云专家就项目中一些最困难的部分提供建议。毫不奇怪，其中一些部分与Linux补丁管理、订阅管理和安全性有关。你还记得我们在本书中早些时候谈到过这些话题吗？现在你知道为什么了。
- en: The project schedule got quite a few extensions and the project took much longer
    than originally planned. During the project, the customer also decided not to
    migrate some of the older applications, and instead decided to start to develop
    new cloud-native versions of those applications. From the migration project's
    point of view, this caused some major challenges in project scheduling. In the
    previous chapter, we talked about the importance of assessments and quality project
    planning for a good reason.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 项目进度表得到了相当多的延期，项目花费的时间比最初计划的要长得多。在项目进行过程中，客户还决定不迁移一些较旧的应用程序，而是决定开始开发这些应用程序的新的云原生版本。从迁移项目的角度来看，这给项目进度安排带来了一些重大挑战。在前一章中，我们谈到了评估和高质量项目规划的重要性，有充分的理由。
- en: Why was the project unsuccessful? The project team didn't use any migration
    assessment tooling and they also lacked a proper migration execution tool. Additionally,
    they had little experience managing projects like this, and they also lacked expertise
    in cloud migrations and some of the workloads to be migrated.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么项目失败了？项目团队没有使用任何迁移评估工具，他们也缺乏适当的迁移执行工具。此外，他们在管理这样的项目方面经验不足，也缺乏云迁移和一些待迁移工作负载的专业知识。
- en: Even after successful migration to Azure, there can be unexpected issues due
    to the wrong configuration or human error. You can reach out to Microsoft Azure
    support in the event of issues like virtual machine booting problems, remote SSH
    access not working, and so on. In *Chapter 6*, *Troubleshooting and problem solving*,
    we will talk more about possible problems and troubleshooting scenarios and also
    about how they can be resolved.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 即使成功迁移到Azure，由于错误的配置或人为错误，仍可能出现意外问题。在出现虚拟机引导问题、远程SSH访问不起作用等问题时，您可以联系Microsoft
    Azure支持。在第6章《故障排除和问题解决》中，我们将更多地讨论可能出现的问题和故障排除场景，以及如何解决这些问题。
- en: 'We have mentioned it already a couple of times in this book, but since it is
    such important advice, let''s say it again: a key element to a successful migration
    project is ensuring that your customer—be they internal or external—is committed
    to the project. The second piece of advice we want to repeat is to use the right
    tools to help you with migration. In the previous chapter, we covered Azure Migrate
    for running successful assessments, so we can be quite sure the project team has
    the correct facts about the workloads to be migrated.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在本书中已经多次提到过，但由于这是如此重要的建议，让我们再说一遍：确保您的客户——无论是内部还是外部客户——对项目有承诺是成功迁移项目的关键因素。我们想要重复的第二条建议是使用正确的工具来帮助您进行迁移。在前一章中，我们介绍了Azure
    Migrate用于进行成功评估，因此我们可以相当肯定项目团队对待迁移的工作负载有正确的了解。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: Hands-on migration lab
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实践迁移实验室
- en: Migrating servers to Azure
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 迁移服务器到Azure
- en: Migrating databases
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 迁移数据库
- en: By the end of the chapter, you will have learned how to use the right tools
    the right way.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章结束时，您将学会如何正确使用正确的工具。
- en: Hands-on migration lab
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实践迁移实验室
- en: In the *Hands-on assess lab* section of *Chapter 3*, *Assessment and migration
    planning*, we saw how the assessment of workloads and dependency analysis are
    done. These are vital steps in the migration framework and we're currently in
    the *Migrate* phase. We have two sections in this lab. The first part deals with
    the migration of servers, where we're going to migrate one of our LAMP servers
    to the cloud and verify that the site is working as expected. In the second scenario,
    we are migrating a MySQL database on Linux to an Azure MySQL managed database.
    In the first, we are migrating from IaaS to IaaS, whereas in the second, we're
    migrating from IaaS to a PaaS solution. Let's get started with the migration of
    the servers.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在第3章的“实践评估实验室”部分，“评估和迁移规划”中，我们看到了工作负载的评估和依赖分析是如何进行的。这些是迁移框架中至关重要的步骤，我们目前处于“迁移”阶段。本实验室有两个部分。第一部分涉及服务器的迁移，我们将把我们的LAMP服务器之一迁移到云端，并验证该站点是否按预期工作。在第二种情况下，我们正在将Linux上的MySQL数据库迁移到Azure
    MySQL托管数据库。在第一种情况下，我们正在从IaaS迁移到IaaS，而在第二种情况下，我们正在从IaaS迁移到PaaS解决方案。让我们开始服务器的迁移。
- en: Migrating servers to Azure
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将服务器迁移到Azure
- en: As explained earlier, the Azure Migrate service is tooling for both the *Assess*
    phase and the *Migrate* phase. In the *Assess* phase, we rely on the Server Assessment
    tools, and in the *Migrate* phase, we focus on the server migration tools. If
    you're following along, you can use the same migration project from the assessment
    hands-on lab from *Chapter 3*, *Assessment and migration planning*. Otherwise,
    you can create a new one.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 正如前面所解释的，Azure Migrate服务既是“评估”阶段的工具，也是“迁移”阶段的工具。在“评估”阶段，我们依赖于服务器评估工具，在“迁移”阶段，我们专注于服务器迁移工具。如果您在跟随，您可以使用来自“第3章”“评估和迁移规划”的评估实践实验室中的相同迁移项目。否则，您可以创建一个新的项目。
- en: In this phase, your **virtual machine** (**VM**) will get replicated to the
    cloud, and later this replicated disk is used to spin up a VM. It is pretty much
    similar to how we set up cross-region failover in Azure Site Recovery. Azure Migrate
    uses Site Recovery in the back end to accomplish the migration process, where
    your servers are constantly replicated to the Site Recovery vault.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段，您的**虚拟机**（**VM**）将被复制到云端，稍后这个复制的磁盘将用于启动一个VM。这与我们在Azure Site Recovery中设置跨区域故障转移的方式非常相似。Azure
    Migrate在后台使用站点恢复来完成迁移过程，其中您的服务器不断地被复制到站点恢复保险库。
- en: '*Figure 4.1* shows the servers we''re going to migrate to Azure:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '*图4.1*显示了我们要迁移到Azure的服务器：'
- en: '![VMs in Hyper-V](img/B17160_04_01.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![Hyper-V中的虚拟机](img/B17160_04_01.jpg)'
- en: 'Figure 4.1: VMs in Hyper-V'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.1：Hyper-V中的虚拟机
- en: The LAMP server will be used to demonstrate server migration using Azure Migrate
    and the MySQL VM will be migrated using DMS. You could deploy a LAMP application
    from GitHub—there are many repos that have files for a simple LAMP server. The
    one used in the demo is cloned from [https://github.com/Anirban2404/phpMySQLapp](https://github.com/Anirban2404/phpMySQLapp).
    The LAMP installation is covered in the GitHub repo.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: LAMP服务器将用于演示使用Azure Migrate进行服务器迁移，而MySQL VM将使用DMS进行迁移。您可以从GitHub部署一个LAMP应用程序——有许多存储库包含简单LAMP服务器的文件。演示中使用的存储库是从[https://github.com/Anirban2404/phpMySQLapp](https://github.com/Anirban2404/phpMySQLapp)克隆的。LAMP安装在GitHub存储库中有所涵盖。
- en: We'll break down the process into various stages, starting with the installation
    of providers, all the way to cutover.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把过程分解为各个阶段，从安装提供商开始，一直到切换。
- en: Installing the providers
  id: totrans-24
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装提供商
- en: 'In the case of assessment, we deployed an Azure Migrate appliance on our on-premises
    Hyper-V server for sending the discovered data to the cloud. Similarly, in the
    *Migrate* phase, we''ll be installing some software providers on our Hyper-V server,
    namely a Site Recovery provider and a Microsoft Azure Recovery Services agent.
    The Migrate appliance that we deployed during the assessment stage has no role
    in server migration—the purpose of that server was to discover the on-premises
    VMs and create an inventory. The following steps can be used to install the providers:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估的情况下，我们在本地Hyper-V服务器上部署了Azure Migrate应用程序，以将发现的数据发送到云端。同样，在“迁移”阶段，我们将在我们的Hyper-V服务器上安装一些软件提供商，即站点恢复提供商和Microsoft
    Azure恢复服务代理。在评估阶段部署的迁移应用程序在服务器迁移中没有任何作用——该服务器的目的是发现本地虚拟机并创建清单。以下步骤可用于安装提供商：
- en: 'Navigate to the Azure Migrate project | Servers, and under Azure Migrate: Server
    Migration click on Discover, as shown in *Figure 4.2*:![Navigating to Migration
    tools and clicking on Discover](img/B17160_04_02.jpg)'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到Azure Migrate项目|服务器，在Azure Migrate:服务器迁移下点击“发现”，如图4.2所示：![导航到迁移工具并点击发现](img/B17160_04_02.jpg)
- en: 'Figure 4.2: Navigating to Migration tools'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.2：导航到迁移工具
- en: In *Figure 4.2*, you can see the server assessment tools, the results from the
    previous lab, and the migration tools that we're going to use in this lab.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在*图4.2*中，您可以看到服务器评估工具，上一个实验室的结果以及我们将在本实验室中使用的迁移工具。
- en: Once we click on Discover, we'll be asked to confirm the platform where our
    servers are deployed. We will select Yes, with Hyper-V as shown in *Figure 4.3*.
    Along with that, we'll set Target region. This is the region where your server
    will be deployed post-migration. One thing to keep in mind here is that once Target
    region is confirmed, it cannot be changed for the project. Azure will show a banner
    with the same content and you have to agree to this condition by checking the
    checkbox. After that, we can click on Create resources and the Site Recovery vault
    gets created behind the scenes:![Confirming target region and creating resources
    by clicking on the Create resources button](img/B17160_04_03.jpg)
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“发现”后，我们将被要求确认我们的服务器部署在哪个平台上。我们将选择是，使用Hyper-V，如图4.3所示。除此之外，我们还将设置目标区域。这是迁移后您的服务器将部署的区域。在这里要记住的一件事是，一旦确认了目标区域，就不能为该项目更改。Azure将显示一个带有相同内容的横幅，并且您必须通过选中复选框同意此条件。之后，我们可以点击“创建资源”，站点恢复保险库将在后台创建：![确认目标区域并点击“创建资源”按钮创建资源](img/B17160_04_03.jpg)
- en: 'Figure 4.3: Confirming the target region and creating resources'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.3：确认目标区域并创建资源
- en: Azure provides very intuitive steps to complete the replication, starting with
    the installation of the replication provider software on our Hyper-V server. Steps
    will be prompted to you as shown in *Figure 4.4*:![Reviewing the migration steps
    in the Discover machines window](img/B17160_04_04.jpg)
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Azure提供了非常直观的步骤来完成复制，从在我们的Hyper-V服务器上安装复制提供程序软件开始。步骤将如*图4.4*所示提示给您：
- en: 'Figure 4.4: Reviewing the migration steps'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.4：审查迁移步骤
- en: We'll follow the steps in *Figure 4.4*. Let's download the Site Recovery provider
    software and install it on our Hyper-V server, and also download the registration
    key. You can copy the installation file and registration key to the Hyper-V server
    over **remote desktop protocol** (**RDP**), or you can use a file share. The installation
    is a two-step process and will take some time to install. Once the installation
    is done, you will get a window similar to the following one and you can proceed
    using the Register button, not the Finish button:![Installing the Site Recovery
    provider and clicking on the Register button](img/B17160_04_05.jpg)
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将按照*图4.4*中的步骤。让我们下载站点恢复提供程序软件并安装在我们的Hyper-V服务器上，并下载注册密钥。您可以通过**远程桌面协议**（**RDP**）将安装文件和注册密钥复制到Hyper-V服务器，或者您可以使用文件共享。安装是一个两步过程，需要一些时间来安装。安装完成后，您将收到一个类似下面的窗口，您可以使用“注册”按钮继续，而不是“完成”按钮：
- en: 'Figure 4.5: Installing the Site Recovery provider'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.5：安装站点恢复提供程序
- en: It's time to use the registration key that we copied earlier. Click on the Register
    button shown in *Figure 4.5*. On the next screen, you will be asked to choose
    the registration key and the rest of the details are auto-filled, as shown in
    *Figure 4.6*. Proceed by clicking on the Next button:![Selecting a registration
    key and proceeding by clicking on the Next button](img/B17160_04_06.jpg)
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在是时候使用之前复制的注册密钥了。点击*图4.5*中显示的“注册”按钮。在下一个屏幕上，您将被要求选择注册密钥，其余的细节将自动填充，如*图4.6*所示。点击“下一步”继续：
- en: 'Figure 4.6: Selecting registration key'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.6：选择注册密钥
- en: You don't have to configure to connect using a proxy—let the server directly
    connect to Site Recovery without a proxy server. Hit Next and continue with the
    registration process.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您不必配置使用代理进行连接——让服务器直接连接到站点恢复而不使用代理服务器。点击下一步并继续注册过程。
- en: The last stage is Registration, which will take some time. Once the registration
    is done, the window will prompt as shown in *Figure 4.7*:![Completing registration](img/B17160_04_07.jpg)
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后阶段是注册，这将需要一些时间。一旦注册完成，窗口将提示如*图4.7*所示：
- en: 'Figure 4.7: Completing registration'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.7：完成注册
- en: Now we need to go back to the Azure portal and reopen the project to finalize
    the registration. If the connection was successful, you will see the registered
    Hyper-V host under 2\. Finalize registration. Click on the Finalize registration
    button as shown in *Figure 4.8*. If you are not able to see the host as registered,
    follow the troubleshooting guide provided by Azure on the same page:![Finalizing
    registration by clicking on the Finalize registration button](img/B17160_04_08.jpg)
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们需要回到Azure门户并重新打开项目以完成注册。如果连接成功，您将在2\.完成注册下看到注册的Hyper-V主机。点击*图4.8*中显示的“完成注册”按钮。如果您看不到已注册的主机，请按照Azure在同一页面上提供的故障排除指南进行操作：
- en: 'Figure 4.8: Finalizing registration'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.8：完成注册
- en: You will get a message on the screen to say that the registration may take around
    15 minutes to complete. We need to wait for this process to complete before we
    replicate our machines to Azure. Once the process is complete, you will get a
    Registration finalized message, as shown in *Figure 4.9*:![Registration completed](img/B17160_04_09.jpg)
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将在屏幕上收到一条消息，说注册可能需要大约15分钟才能完成。在我们将机器复制到Azure之前，我们需要等待此过程完成。一旦过程完成，您将收到一个注册完成的消息，如*图4.9*所示：
- en: 'Figure 4.9: Completed registration'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.9：注册完成
- en: Let's take a look at how to discover the servers that are available to be migrated.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何发现可迁移的服务器。
- en: Discovering servers
  id: totrans-45
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 发现服务器
- en: 'Our Hyper-V server is configured with the providers, and we need to make sure
    that our Azure Migrate project discovered the VMs. Let''s head back to the Azure
    Migrate landing page and refresh the toolset. As shown in *Figure 4.10*, you will
    be able to see that the migration tool discovered two VMs:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的Hyper-V服务器已配置了提供程序，我们需要确保我们的Azure迁移项目发现了虚拟机。让我们返回Azure迁移登陆页面并刷新工具集。如*图4.10*所示，您将看到迁移工具发现了两个虚拟机：
- en: '![The migration tool discovered two VMs](img/B17160_04_10.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![迁移工具发现了两个虚拟机](img/B17160_04_10.jpg)'
- en: 'Figure 4.10: Discovered servers'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.10：发现的服务器
- en: We can see that our VMs were discovered by the Azure Migrate project and we're
    ready to replicate these discovered servers.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到我们的虚拟机被Azure迁移项目发现了，我们已经准备好复制这些发现的服务器。
- en: Replicating servers
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 复制服务器
- en: 'As *Figure 4.10* displays, the next step is to replicate our servers to Azure.
    For that, you need to click on the Replicate option next to Discover. As a side
    note, you need to have certain resources created before we replicate, else you
    may need to restart the replication process. So, it''s better to have your resource
    group, virtual network, and replication storage account created before starting
    the replication:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图4.10*所示，下一步是将我们的服务器复制到Azure。为此，您需要点击“发现”旁边的“复制”选项。值得一提的是，在复制之前，您需要创建某些资源，否则您可能需要重新启动复制过程。因此，在开始复制之前最好先创建资源组、虚拟网络和复制存储帐户：
- en: Replication is a five-step process, and we'll start with Source settings. Here
    you'll select the virtualization platform or your source as Hyper-V.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制是一个五步过程，我们将从源设置开始。在这里，您将选择虚拟化平台或您的源为Hyper-V。
- en: In the second step, you have to select the VMs that you are migrating to the
    cloud. You could use the results of an assessment and migrate, or you can specify
    the migration settings manually. For demonstration purposes and to explain the
    steps, let's go with the manual option. Select the VMs and hit Next as shown in
    *Figure 4.11*:![Selecting virtual machines and clicking on the Next button](img/B17160_04_11.jpg)
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第二步中，您必须选择要迁移到云端的虚拟机。您可以使用评估结果并迁移，或者您可以手动指定迁移设置。为了演示目的和解释步骤，让我们选择手动选项。选择虚拟机，然后点击“下一步”，如*图4.11*所示：![选择虚拟机并点击“下一步”按钮](img/B17160_04_11.jpg)
- en: 'Figure 4.11: Selecting VMs'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.11：选择虚拟机
- en: It's time to configure Target settings as in the configuration on the Azure
    side. You have to set Subscription, Resource group, Replication Storage Account
    (this is where the data will be replicated), Virtual Network, Subnet, and Availability
    options. The target location cannot be changed. As mentioned earlier, if you don't
    have these resources created, feel free to create these resources in your selected
    target region and start from *Step 2* again. Here is how the configuration will
    look if you already have the target resources in place:![Selecting target resources
    in the Target settings tab](img/B17160_04_12.jpg)
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在是配置目标设置的时候，就像在Azure端的配置一样。您必须设置订阅、资源组、复制存储帐户（这是数据将被复制的地方）、虚拟网络、子网和可用性选项。目标位置无法更改。如前所述，如果您还没有创建这些资源，请随时在所选的目标区域创建这些资源，然后从*步骤2*重新开始。如果您已经有了目标资源，配置将如下所示：![在目标设置选项卡中选择目标资源](img/B17160_04_12.jpg)
- en: 'Figure 4.12: Selecting target resources'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.12：选择目标资源
- en: Hitting Next in the Target settings tab will take you to the Compute tab, where
    you can set Azure VM Size, OS Type, and the OS Disk name you are going to migrate.
    You could set Azure VM Size as Automatically select matching configuration, as
    shown in *Figure 4.13*, and Azure will select a size matching your on-premises
    configuration:![Selecting compute size based on our on-premises configuration](img/B17160_04_13.jpg)
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在目标设置选项卡中点击“下一步”将带您到计算选项卡，在那里您可以设置Azure VM大小、操作系统类型和您要迁移的操作系统磁盘名称。您可以将Azure
    VM大小设置为“自动选择匹配的配置”，如*图4.13*所示，Azure将选择与您的本地配置匹配的大小：![根据我们的本地配置选择计算大小](img/B17160_04_13.jpg)
- en: 'Figure 4.13: Selecting compute size'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.13：选择计算大小
- en: After selecting the Compute configuration, you can click on Next and the wizard
    will take you to the Disks tab. Here you will get a chance to select the disks
    that you want to replicate from on-premises. You can also replicate the data disks
    if required; however, in our case, we only have the OS disks. The configuration
    will look like *Figure 4.14*:![Selecting disks to replicate in the Replicate window](img/B17160_04_14.jpg)
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择计算配置后，您可以点击“下一步”，向导将带您到磁盘选项卡。在这里，您将有机会选择要从本地复制的磁盘。如果需要，您还可以复制数据磁盘；但在我们的情况下，我们只有操作系统磁盘。配置将如*图4.14*所示：![在复制窗口中选择要复制的磁盘](img/B17160_04_14.jpg)
- en: 'Figure 4.14: Selecting disks to replicate'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.14：选择要复制的磁盘
- en: Once you have selected the disks, you can click on Next and you will reach the
    last step. In this step, we will review the target configuration and click on
    Replicate to replicate the server to Azure.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您选择了磁盘，您可以点击“下一步”，然后您将到达最后一步。在这一步中，我们将审查目标配置，并点击“复制”将服务器复制到Azure。
- en: We can confirm from the landing page whether the replication has started or
    not. As shown in *Figure 4.15*, the Replicating servers section should show two
    as we selected two servers for replication:![Verifying replication in the Migration
    tools pane](img/B17160_04_15.jpg)
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以从首页确认复制是否已经开始。如*图4.15*所示，正在复制的服务器部分应该显示为两个，因为我们选择了两台服务器进行复制：![在迁移工具窗格中验证复制](img/B17160_04_15.jpg)
- en: 'Figure 4.15: Verifying replication'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.15：验证复制
- en: We could also click on 2, which has a hyperlink to show the status of the replication.
    This is a lengthy process, and you can track it as shown in *Figure 4.16*:![Verifying
    replication process](img/B17160_04_16.jpg)
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还可以点击2，它有一个超链接显示复制的状态。这是一个漫长的过程，您可以像*图4.16*所示跟踪它：![验证复制过程](img/B17160_04_16.jpg)
- en: 'Figure 4.16: Verifying replication process'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.16：验证复制过程
- en: Once the replication is done, you will be able to see the status of both the
    servers change to Protected as demonstrated in *Figure 4.17*:![Replication completed
    as the status changed to Protected](img/B17160_04_17.jpg)
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制完成后，您将能够看到两个服务器的状态都变为“受保护”，如*图4.17*所示：![复制完成，状态变为受保护](img/B17160_04_17.jpg)
- en: 'Figure 4.17: Replication completed'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.17：复制完成
- en: Our servers are successfully replicated to Azure. Before we migrate to production,
    we can perform a test failover. Test failovers are helpful for understanding whether
    an application is working properly before we make the production cutover. Let's
    perform the test failover and finish off the migration process.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的服务器已成功复制到Azure。在迁移到生产环境之前，我们可以执行测试故障转移。测试故障转移有助于了解应用程序在我们进行生产切换之前是否正常工作。让我们执行测试故障转移，完成迁移过程。
- en: Migrating to Azure
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 迁移到Azure
- en: Since the servers are replicated, we can perform the test failover anytime we
    want. Performing a test failover will not interrupt any of the services—this stage
    is to confirm whether an application is functioning as expected. If not, we can
    take measures to remediate this and reattempt the migration without any production
    downtime.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 由于服务器已经复制，我们可以随时执行测试故障转移。执行测试故障转移不会中断任何服务——这个阶段是为了确认应用程序是否按预期运行。如果不是，我们可以采取措施进行纠正，并在没有生产停机的情况下重新尝试迁移。
- en: 'Let''s see how the application looks in our on-premises LAMP application, which
    is a demo LAMP application created from [https://github.com/Anirban2404/phpMySQLapp](https://github.com/Anirban2404/phpMySQLapp):'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看我们在本地LAMP应用程序中的应用程序是什么样子，这是一个从[https://github.com/Anirban2404/phpMySQLapp](https://github.com/Anirban2404/phpMySQLapp)创建的演示LAMP应用程序：
- en: '![An index page of an on-premises application](img/B17160_04_18.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![本地应用程序的索引页面](img/B17160_04_18.jpg)'
- en: 'Figure 4.18: On-premises application index page'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.18：本地应用程序索引页面
- en: 'As mentioned at the beginning of this section, we can perform a test failover
    and see whether our application is working fine. In order to perform a test failover,
    follow these steps:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 正如本节开头所述，我们可以执行测试故障转移，看看我们的应用程序是否正常工作。为了执行测试故障转移，请按照以下步骤操作：
- en: Navigate to Azure Migrate | Servers and choose Replicate from Migration tools
    as shown in *Figure 4.19*:![Viewing the replicated servers in the Migration tools
    pane](img/B17160_04_19.jpg)
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到Azure迁移|服务器，并选择从迁移工具中复制，如*图4.19*所示：![在迁移工具窗格中查看复制的服务器](img/B17160_04_19.jpg)
- en: 'Figure 4.19: Viewing the replicated servers'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.19：查看复制的服务器
- en: From the next screen, select the VM that you want to test failover for and click
    on the three dots on the far-right side. You'll see a Test migration option as
    shown in *Figure 4.20*:![Selecting the Test migration option](img/B17160_04_20.jpg)
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下一个屏幕中，选择要进行测试故障转移的虚拟机，并单击最右侧的三个点。您将看到一个测试迁移选项，如*图4.20*所示：![选择测试迁移选项](img/B17160_04_20.jpg)
- en: Figure 4.20 Selecting Test migration
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.20 选择测试迁移
- en: Select the virtual network where you want to deploy the resources and select
    Test migration as shown in *Figure 4.21*:![Starting test migration by clicking
    on Test migration](img/B17160_04_21.jpg)
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择要部署资源的虚拟网络，并选择*图4.21*中所示的测试迁移：![点击测试迁移开始测试迁移](img/B17160_04_21.jpg)
- en: 'Figure 4.21: Starting test migration'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.21：开始测试迁移
- en: After some time, you will see that the resources have been created. One thing
    to note here is that there won't be a public IP or NSG attached to the resources
    that are created during the test migration. For us to check them using the internet,
    we need a public IP and NSG with SSH and HTTP rules added. If you are not sure
    how to make this change, refer to [https://docs.microsoft.com/azure/virtual-network/manage-network-security-group](https://docs.microsoft.com/azure/virtual-network/manage-network-security-group)
    and [https://docs.microsoft.com/azure/virtual-network/associate-public-ip-address-vm](https://docs.microsoft.com/azure/virtual-network/associate-public-ip-address-vm).
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一段时间后，您会看到资源已经创建。这里需要注意的一点是，在测试迁移期间创建的资源不会附加公共IP或NSG。为了通过互联网检查它们，我们需要添加带有SSH和HTTP规则的公共IP和NSG。如果您不确定如何进行更改，请参考[https://docs.microsoft.com/azure/virtual-network/manage-network-security-group](https://docs.microsoft.com/azure/virtual-network/manage-network-security-group)和[https://docs.microsoft.com/azure/virtual-network/associate-public-ip-address-vm](https://docs.microsoft.com/azure/virtual-network/associate-public-ip-address-vm)。
- en: Once the test migration status shows as completed, you can navigate to the target
    resource group that you selected in the Azure Migrate project during the initial
    configuration. The resources will be deployed, with the test keyword added as
    a suffix to the resource name, as visible in *Figure 4.22*:![Exploring test migration
    resources](img/B17160_04_22.jpg)
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦测试迁移状态显示为完成，您可以导航到在初始配置期间在Azure迁移项目中选择的目标资源组。资源将被部署，并在资源名称后面添加测试关键字作为后缀，如*图4.22*所示：![探索测试迁移资源](img/B17160_04_22.jpg)
- en: 'Figure 4.22: Exploring test migration resources'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.22：探索测试迁移资源
- en: You can attach an NSG and public IP address as mentioned in the aforementioned
    documentation, and then you can test the migration by opening the displayed IP
    address in your browser as shown in *Figure 4.23*:![Verifying application from
    the browser](img/B17160_04_23.jpg)
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以按照上述文档中提到的方法附加NSG和公共IP地址，然后可以通过在浏览器中打开显示的IP地址来测试迁移，如*图4.23*所示：![从浏览器验证应用程序](img/B17160_04_23.jpg)
- en: 'Figure 4.23: Verifying the application from the browser'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.23：从浏览器验证应用程序
- en: Once the test migration is done, you need to clean up the test migration before
    we perform the actual migration. This can be done using the Clean up test migration
    option, which is shown in *Figure 4.20*. You will be asked to add your notes and
    confirm the deletion of the test resources.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦测试迁移完成，您需要清理测试迁移，然后执行实际迁移。可以使用清理测试迁移选项来完成此操作，如*图4.20*所示。您将被要求添加您的备注并确认删除测试资源。
- en: After cleaning up the test resources, we can perform the actual migration of
    resources. To start the migration, navigate to Azure Migrate | Servers and choose
    Migrate from Migration tools as shown in *Figure 4.24*:![Choosing Migrate from
    the Migration tools](img/B17160_04_24.jpg)
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 清理测试资源后，我们可以执行实际资源的迁移。要开始迁移，请导航到Azure迁移|服务器，并选择从迁移工具中迁移，如*图4.24*所示：![从迁移工具中选择迁移](img/B17160_04_24.jpg)
- en: 'Figure 4.24: Migrating servers'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.24：迁移服务器
- en: You will be asked whether you want to shut down the machines to minimize data
    loss. Select Yes to shut down the machines and perform a planned migration with
    zero data loss. If you choose not to shut down the VMs, a final sync will be performed
    before the migration, but any changes that happen on the machine after the final
    sync is started will not be replicated. Let's go with No and select the machines
    we want to migrate, as shown in *Figure 4.25*:![Finalizing migration by clicking
    on the Migrate button](img/B17160_04_25.jpg)
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将被询问是否要关闭机器以最小化数据丢失。选择是以关闭机器并执行计划迁移，数据不会丢失。如果选择不关闭虚拟机，将在迁移之前执行最终同步，但在最终同步开始后发生的任何更改都不会被复制。让我们选择否，并选择要迁移的机器，如*图4.25*所示：![点击迁移按钮完成迁移](img/B17160_04_25.jpg)
- en: 'Figure 4.25: Finalizing migration'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.25：完成迁移
- en: As we saw in the case of the test migration, this process will take some time
    and the resources will be created in the target resource group. The servers will
    have no public IP or NSG attached to them. You need to follow the process outlined
    in the documentation we followed in the test migration to attach the NSG and public
    IP. You can reuse the NSG and public IP from the test migration if you haven't
    deleted them.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正如我们在测试迁移中看到的那样，这个过程需要一些时间，资源将被创建在目标资源组中。服务器将没有公共IP或NSG附加到它们。您需要按照我们在测试迁移中遵循的文档中概述的过程来附加NSG和公共IP。如果您还没有删除它们，您可以重用测试迁移中的NSG和公共IP。
- en: Voilà, we have our resources in our target resource group:![Reviewing migrated
    resources](img/B17160_04_26.jpg)
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 看，我们在目标资源组中有我们的资源：![审查迁移后的资源](img/B17160_04_26.jpg)
- en: 'Figure 4.26: Reviewing migrated resources'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.26：审查迁移后的资源
- en: If we navigate back to Azure Migrate | Servers and refresh the project, we will
    get the summary of the migration we have done as shown in *Figure 4.27*:![Summary
    of the project](img/B17160_04_27.jpg)
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们返回到Azure Migrate | 服务器并刷新项目，我们将得到我们所做迁移的摘要，如*图4.27*所示：![项目摘要](img/B17160_04_27.jpg)
- en: 'Figure 4.27: Summary of the project'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.27：项目摘要
- en: With that, we've seen the end-to-end process of migrating servers from an on-premises
    Hyper-V host to Azure using Azure Migrate. As mentioned in the introduction of
    this section, we are going to see how we can migrate databases to PaaS solutions
    in the next hands-on lab.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这样，我们已经看到了从本地 Hyper-V 主机到 Azure 的服务器迁移的端到端过程。正如本节介绍中提到的，接下来我们将看到如何将数据库迁移到PaaS解决方案。
- en: Migrating databases
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 迁移数据库
- en: 'In the *Migrating servers to Azure* section, we saw how servers can be migrated
    to Azure with the help of Azure Migrate. We can directly migrate databases from
    IaaS to IaaS as we did in the case of the LAMP server. However, in this section,
    we will be migrating the database to a PaaS solution. You can use any on-premises
    MySQL server that can be accessed publicly. If you don''t have one, for demonstration
    purposes, you can create a VM in Azure and install MySQL. In order to work with
    the hands-on data, you need to run the following SQL script in your MySQL server:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在*Migrating servers to Azure*部分，我们看到了如何借助Azure Migrate将服务器迁移到Azure。我们可以像在LAMP服务器的情况下那样直接从IaaS迁移到IaaS。然而，在本节中，我们将把数据库迁移到PaaS解决方案。您可以使用任何可以公开访问的本地MySQL服务器。如果没有，为了演示目的，您可以在Azure中创建一个虚拟机并安装MySQL。为了使用这些实验数据，您需要在MySQL服务器中运行以下SQL脚本：
- en: '[PRE0]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Though IaaS offers a lot of flexibility in terms of control and administration,
    PaaS helps developers or administrators to deploy at ease and be more productive,
    as most of the management tasks are performed by Microsoft. PaaS offers a lot
    of time savings as the underlying hardware, OS patches and updates, and maintenance
    tasks are taken care of by Azure.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管IaaS在控制和管理方面提供了很多灵活性，但PaaS帮助开发人员或管理员轻松部署并提高生产率，因为大部分管理任务都由Microsoft执行。PaaS提供了很多时间节省，因为底层硬件、操作系统补丁和更新以及维护任务都由Azure负责。
- en: To migrate databases to PaaS, we will be using a service called Azure DMS. DMS
    empowers customers to perform online and offline migration from a plethora of
    database sources to Azure data platforms, with minimal service interruption or
    downtime.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 为了将数据库迁移到PaaS，我们将使用一个名为Azure DMS的服务。DMS使客户能够从众多数据库源执行在线和离线迁移到Azure数据平台，最小化服务中断或停机时间。
- en: 'DMS offer two different methods to migrate databases: offline migration or
    online migration. Offline migration requires the server to be shut down at the
    start of the migration, so there is downtime involved in this method. On the other
    hand, online migration follows a continuous replication of the live data, also
    allowing a cutover to Azure at any time with minimal downtime.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: DMS提供两种不同的方法来迁移数据库：离线迁移或在线迁移。离线迁移要求在迁移开始时关闭服务器，因此这种方法涉及停机时间。另一方面，在线迁移遵循实时数据的持续复制，还允许在任何时间切换到Azure，最小化停机时间。
- en: 'Azure DMS offers two pricing tiers:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: Azure DMS提供两种定价层：
- en: '**Standard**: Only offline migrations are supported. This tier has no charge.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准**：仅支持离线迁移。此层不收费。'
- en: '**Premium**: Offline and online migrations are supported. There is no charge
    for the first six months—after that, this tier will incur charges.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高级**：支持离线和在线迁移。前六个月不收费—之后，此层将产生费用。'
- en: Now that we have some idea about DMS, let's go ahead and create an instance.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们对DMS有了一些了解，让我们继续创建一个实例。
- en: Creating a Database Migration Service instance
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建数据库迁移服务实例
- en: 'This process consists of multiple steps:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这个过程包括多个步骤：
- en: Find Azure Database Migration Services in the All Services pane, or simply search
    for it. You can kick off the creation process by clicking New or Create azure
    database migration service as shown in *Figure 4.28*:![Creating Azure Database
    Migration Service instance](img/B17160_04_28.jpg)
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在所有服务窗格中找到Azure数据库迁移服务，或者直接搜索它。您可以通过点击New或Create azure database migration service来启动创建过程，如*图4.28*所示：![创建Azure数据库迁移服务实例](img/B17160_04_28.jpg)
- en: 'Figure 4.28: Creating a Database Migration Service instance'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.28：创建数据库迁移服务实例
- en: 'The creation process is very straightforward—you need to input values for Subscription,
    Resource group, Migration service name, and Location. Additionally, there is an
    option to choose Pricing tier and Service mode. As mentioned previously, there
    are two pricing tiers for this service: Standard (supports only offline migration)
    and Premium (supports both offline and online migration). Also, there are two
    service modes: Azure, where we''ll be choosing one of the aforementioned pricing
    tiers, and Hybrid, where the worker is hosted on-premises. At the time of writing
    this book, Hybrid mode is in preview. The creation process is shown in *Figure
    4.29*:![Adding various details in the Basics pane of the Create Migration Service
    window](img/B17160_04_29.jpg)'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建过程非常简单 - 您需要为订阅、资源组、迁移服务名称和位置输入值。此外，还有选择定价层和服务模式的选项。如前所述，此服务有两个定价层：标准（仅支持离线迁移）和高级（支持离线和在线迁移）。此外，还有两种服务模式：Azure，在这里我们将选择上述定价层之一，以及混合，其中工作程序托管在本地。在撰写本书时，混合模式处于预览状态。创建过程如*图4.29*所示：![在创建迁移服务窗格的基本信息中添加各种细节](img/B17160_04_29.jpg)
- en: 'Figure 4.29: Configuring Basics'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.29：配置基本信息
- en: The next configuration we need is the Networking configuration, where will be
    creating a virtual network. You could choose an existing virtual network or create
    a new one. This virtual network will be used by the service to communicate with
    the source databases over the internet. The configuration is as shown in *Figure
    4.30*:![Providing networking configuration for creating a new virtual network](img/B17160_04_30.jpg)
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要的下一个配置是网络配置，我们将在其中创建一个虚拟网络。您可以选择现有的虚拟网络或创建一个新的虚拟网络。此虚拟网络将被服务用于通过互联网与源数据库通信。配置如*图4.30*所示：![为创建新的虚拟网络提供网络配置](img/B17160_04_30.jpg)
- en: 'Figure 4.30: Creating a new virtual network'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.30：创建新的虚拟网络
- en: Clicking Review + create will initiate the validation process and the service
    will be created.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击“审阅+创建”将启动验证过程，并将创建服务。
- en: Now that we have created a DMS instance, the next step is to configure the migration
    project. Before this, we need to create the target database in Azure. Since we
    are migrating MySQL, we need to create an Azure Database for MySQL server.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经创建了DMS实例，下一步是配置迁移项目。在此之前，我们需要在Azure中创建目标数据库。由于我们正在迁移MySQL，因此需要为MySQL服务器创建Azure数据库。
- en: Creating and configuring the target resource
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建和配置目标资源
- en: 'As mentioned earlier, the service we''re going to create is an Azure Database
    for MySQL server. This is a managed offering by Microsoft Azure that utilizes
    MySQL Community Edition version 5.6, 5.7, and 8.0\. Let''s create the target resource
    to migrate the data:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们要创建的服务是Azure Database for MySQL服务器。这是Microsoft Azure提供的托管服务，利用了MySQL
    Community Edition版本5.6、5.7和8.0。让我们创建目标资源以迁移数据：
- en: Search for MySQL in the search bar and you will be able to see Azure Database
    for MySQL in the Azure portal. Start creating a new database by clicking on the
    New button.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在搜索栏中搜索MySQL，您将能够在Azure门户中看到Azure Database for MySQL。通过单击“新建”按钮开始创建新数据库。
- en: We will go with the single-server model as it is production-ready, cost-optimized,
    and has built-in high availability. You do get an option to choose Flexible server,
    which offers advanced customization and is in preview at the time of writing this
    book.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将选择单服务器模型，因为它已经准备好投入生产，成本优化，并且具有内置的高可用性。您可以选择灵活服务器，该服务器提供高级定制，并且在撰写本书时处于预览状态。
- en: The wizard will take you through the creation process. You need to fill in the
    details and configure the compute, storage, and pricing tier for the server as
    per your requirements. Since we're dealing with a very small database, a Basic
    server with 1 vCPU and 8 GB of storage will suffice. In real-world scenarios,
    you should match the compute and storage of the Azure server with the on-premises
    configuration to avoid performance issues. The configuration is as shown in *Figure
    4.31*:![Creating Azure Database for MySQL](img/B17160_04_31.jpg)
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向导将带您完成创建过程。您需要填写详细信息，并根据您的要求配置服务器的计算、存储和定价层。由于我们处理的是一个非常小的数据库，在实际情况下，您应该将Azure服务器的计算和存储与本地配置匹配，以避免性能问题。配置如*图4.31*所示：![创建Azure
    Database for MySQL](img/B17160_04_31.jpg)
- en: 'Figure 4.31: Creating an Azure Database for MySQL server'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.31：创建Azure Database for MySQL服务器
- en: With that, we can select the Review + create option, then the Create option,
    and the database will be provisioned.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 有了这个，我们可以选择“审阅+创建”选项，然后选择“创建”选项，数据库将被配置。
- en: After provisioning the database, we need to create a target table where the
    data from the on-premises database table should be migrated. We will create an
    empty table and map this to our on-premises database when we create a migration
    project.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在配置完数据库后，我们需要创建一个目标表，将来自本地数据库表的数据迁移到其中。我们将创建一个空表，并在创建迁移项目时将其映射到我们的本地数据库。
- en: The server admin login name can be obtained from the Overview pane of the database
    that we created in *Step 3*.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 服务器管理员登录名可以从我们在*步骤3*中创建的数据库的概述窗格中获得。
- en: You can use any Linux or Windows computer with MySQL tools installed or Azure
    Cloud Shell to work with the server we deployed in Azure. Here, let's connect
    from the Bash shell as shown in *Figure 4.32*:![Connecting to Azure MySQL using
    Bash shell](img/B17160_04_32.jpg)
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以使用安装了MySQL工具的任何Linux或Windows计算机或Azure Cloud Shell来使用我们在Azure中部署的服务器。在这里，让我们像*图4.32*中所示那样从Bash
    shell连接：![使用Bash shell连接到Azure MySQL](img/B17160_04_32.jpg)
- en: 'Figure 4.32: Connecting to Azure MySQL using Bash'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.32：使用Bash连接到Azure MySQL
- en: Here the connection will fail, as the IP address of the machine from which we
    are connecting is not in the allowed list of IP addresses and the firewall will
    stop us from connecting.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，连接将失败，因为我们连接的计算机的IP地址不在允许的IP地址列表中，防火墙将阻止我们连接。
- en: To add your IP address to the allowed list of IP addresses, you can navigate
    to the server we created and click on Connection security. If you are using Azure
    Cloud Shell, you have to enable Allow access to Azure services. Since we are using
    a local machine, we will add our IP address as shown in *Figure 4.33* and save
    the configuration:![Configuring the firewall in the Connection security window](img/B17160_04_33.jpg)
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将您的IP地址添加到允许的IP地址列表中，您可以转到我们创建的服务器并单击“连接安全性”。如果您使用Azure Cloud Shell，您必须启用“允许访问Azure服务”。由于我们使用的是本地机器，我们将像*图4.33*中所示添加我们的IP地址并保存配置：![在连接安全性窗口中配置防火墙](img/B17160_04_33.jpg)
- en: 'Figure 4.33: Configuring firewall'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.33：配置防火墙
- en: Now that we've added our IP address to the firewall, let's try to reconnect
    from Bash and see if the connection succeeds. You can see in *Figure 4.34* that
    the login was successful:![Logging into MySQL](img/B17160_04_34.jpg)
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们已经将我们的IP地址添加到防火墙中，让我们尝试从Bash重新连接并查看连接是否成功。您可以在*图4.34*中看到登录成功：![登录到MySQL](img/B17160_04_34.jpg)
- en: 'Figure 4.34: Logging in to MySQL'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.34：登录到MySQL
- en: 'Our on-premises server consists of a database and has a table named `horror_tbl`.
    Basically, this table stores the names of horror movies and the years they were
    released. We need to create a similar table in the MySQL server as we created
    in Azure so that the data can be migrated. Let''s create a new database and table
    using the following commands:'
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们的本地服务器包含一个名为“horror_tbl”的数据库和一个表。基本上，这个表存储了恐怖电影的名称和它们上映的年份。我们需要在MySQL服务器中创建一个类似的表，以便数据可以迁移。使用以下命令创建一个新的数据库和表：
- en: '[PRE1]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Here is how the databases look in on-premises infrastructure and in Azure:![Comparing
    a dataset in on-premises and Azure](img/B17160_04_35.jpg)
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这是在本地基础设施和Azure中数据库的外观：![比较本地和Azure中的数据集](img/B17160_04_35.jpg)
- en: 'Figure 4.35: Comparing dataset in on-premises and Azure'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.35：比较本地和Azure中的数据集
- en: It's evident from the preceding figure that the on-premises database contains
    data, and the Azure database is empty. Now we need to extract the schema from
    the source database and apply it to the destination.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的图中可以看出，本地数据库包含数据，而Azure数据库为空。现在我们需要从源数据库提取模式并将其应用到目标数据库。
- en: Migrating the sample schema
  id: totrans-138
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 迁移示例模式
- en: 'In order to extract the schema, you can use the `mysqldump` command with the
    `--no-data` parameter. The syntax is as follows:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提取模式，您可以使用带有“--no-data”参数的“mysqldump”命令。语法如下：
- en: '[PRE2]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'In our scenario, we need to extract the schema of the `MOVIES` database. Since
    we are executing the command from the MySQL server itself, we don''t need to use
    the `-h` parameter. However, if you''re doing this on a remote server, consider
    using the `-h` parameter. The following command will suffice in our scenario:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的场景中，我们需要提取“MOVIES”数据库的模式。由于我们是从MySQL服务器本身执行命令，所以不需要使用“-h”参数。但是，如果您在远程服务器上执行此操作，请考虑使用“-h”参数。在我们的情况下，以下命令就足够了：
- en: '[PRE3]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'You can also use the `--all-databases` parameter if you have multiple databases
    and would like to extract the schema of all of them in a single shot. If you look
    at the schema file, it will be similar to the following SQL script:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有多个数据库并希望一次提取所有数据库的模式，还可以使用“--all-databases”参数。如果查看模式文件，它将类似于以下SQL脚本：
- en: '![Checking the schema file](img/B17160_04_36.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![检查模式文件](img/B17160_04_36.jpg)'
- en: 'Figure 4.36: Checking the schema file'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.36：检查模式文件
- en: 'Now we need to import this data to Azure Database for MySQL using the following
    syntax. This can be run directly from the VM hosting the on-premises database
    if the networking allows the connection. Otherwise, the schema needs to be imported
    on a machine that has the option to connect to the Azure database or into Cloud
    Shell directly:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们需要使用以下语法将这些数据导入到Azure数据库的MySQL中。如果网络允许连接，可以直接从托管本地数据库的VM运行此命令。否则，需要在可以连接到Azure数据库或直接进入Cloud
    Shell的机器上导入模式。
- en: '[PRE4]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'In our scenario, you need to replace the server name and login name with your
    Azure Database for MySQL credentials:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的情况下，您需要使用您的Azure数据库的MySQL凭据替换服务器名称和登录名：
- en: '[PRE5]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: After the import process, we need to switch back to DMS and create a migration
    project.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 导入过程后，我们需要切换回DMS并创建迁移项目。
- en: Creating a migration project and migrating a database
  id: totrans-151
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建迁移项目并迁移数据库
- en: 'To create a migration project for databases, we need to head back to DMS. The
    project can be created using the following steps:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 要为数据库创建迁移项目，我们需要返回到DMS。可以使用以下步骤创建项目：
- en: Navigate to Azure Database Migration Service and select New Migration Project
    as shown in *Figure 4.37*:![Creating a migration project by clicking on New Migration
    Project](img/B17160_04_37.jpg)
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到Azure数据库迁移服务，并选择“新迁移项目”，如*图4.37*所示：![通过单击“新迁移项目”创建迁移项目](img/B17160_04_37.jpg)
- en: 'Figure 4.37: Creating a migration project'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.37：创建迁移项目
- en: The creation is a very simple process. We need to input a name for the project,
    set Source server type (in our case MySQL), and set Target server type, which
    is Azure Database for MySQL. Finally, set the type of activity as Online data
    migration, as we are planning to migrate without any downtime. The offline option
    is not currently available for MySQL. The configuration is as shown in *Figure
    4.38*:![Configuring the project by adding various details and clicking on Create
    and run activity](img/B17160_04_38.jpg)
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建是一个非常简单的过程。我们需要为项目输入一个名称，设置源服务器类型（在我们的情况下是MySQL），设置目标服务器类型，即Azure数据库的MySQL。最后，将活动类型设置为在线数据迁移，因为我们计划在没有任何停机时间的情况下进行迁移。目前MySQL不支持离线选项。配置如*图4.38*所示：![通过添加各种细节并点击“创建并运行活动”来配置项目](img/B17160_04_38.jpg)
- en: 'Figure 4.38: Configuring the project'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.38：配置项目
- en: Once the project is configured, click on Create and run activity. This will
    take you to MySQL to Azure Database for MySQL Online Migration Wizard.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 项目配置完成后，点击“创建并运行活动”。这将带您到MySQL到Azure数据库的MySQL在线迁移向导。
- en: The first step in the wizard is to configure the source. Here we need to set
    Source server name, Server port, User Name, and Password for our publicly available
    on-premises server as shown in *Figure 4.39*:![Connecting to the source database
    by adding various details in the Select source pane](img/B17160_04_39.jpg)
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向导中的第一步是配置源。在这里，我们需要为我们的公共可用本地服务器设置源服务器名称、服务器端口、用户名和密码，如*图4.39*所示：![通过在选择源窗格中添加各种细节连接到源数据库](img/B17160_04_39.jpg)
- en: 'Figure 4.39: Connecting to the source database'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.39：连接到源数据库
- en: Note
  id: totrans-160
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: You might encounter errors if the MySQL server is not configured properly. Configuration
    of the bind-address, bin-logs in `mysqld.cnf`, and the creation of a new user
    with admin privileges might be required for a successful connection. Refer to
    [https://docs.microsoft.com/azure/dms/tutorial-mysql-azure-mysql-online#prerequisites](https://docs.microsoft.com/azure/dms/tutorial-mysql-azure-mysql-online#prerequisites).
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 如果MySQL服务器没有正确配置，您可能会遇到错误。可能需要在`mysqld.cnf`中配置bind-address、bin-logs，并创建一个具有管理员权限的新用户才能成功连接。请参阅[https://docs.microsoft.com/azure/dms/tutorial-mysql-azure-mysql-online#prerequisites](https://docs.microsoft.com/azure/dms/tutorial-mysql-azure-mysql-online#prerequisites)。
- en: Now we need to configure the target, which includes setting Target server name,
    User Name, and Password. Target server name and User Name can be found from the
    Overview pane of our MySQL server in Azure. The password is the one you entered
    during the service creation—if forgotten, you can use the Reset Password option.
    The target server details should be configured as follows:![Configuring the target
    by adding various details in the Select target pane](img/B17160_04_40.jpg)
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们需要配置目标，包括设置目标服务器名称、用户名和密码。目标服务器名称和用户名可以从Azure中我们的MySQL服务器的概述窗格中找到。密码是您在服务创建时输入的密码，如果忘记了，可以使用重置密码选项。目标服务器的详细信息应配置如下：![通过在选择目标窗格中添加各种细节来配置目标](img/B17160_04_40.jpg)
- en: 'Figure 4.40: Configuring the target server'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.40：配置目标服务器
- en: Note
  id: totrans-164
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: You may get an error message stating that the IP address is not allowed to connect
    to the MySQL server. From the error message, you can get the public IP of DMS
    and add this IP to the Connection Security pane of MySQL for successful connection,
    or enable Allow access to Azure Services. However, this would give all Azure services
    in your subscription access to the database.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能会收到一个错误消息，指出IP地址不允许连接到MySQL服务器。从错误消息中，您可以获取DMS的公共IP并将此IP添加到MySQL的连接安全窗格以实现成功连接，或者启用允许Azure服务访问。但是，这将允许订阅中的所有Azure服务访问数据库。
- en: The next step is to select the source databases that need to be migrated to
    the cloud. The tool will show you the databases that are available on the on-premises
    server. Select the source database and corresponding database as the target. In
    our case, we will map the `MOVIES` database, which is on-premises, to the `movies`
    database that we created earlier. *Figure 4.41* shows how the mapping is done
    from source to target:![Mapping databases in the Select databases pane](img/B17160_04_41.jpg)
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是选择需要迁移到云端的源数据库。该工具将显示本地服务器上可用的数据库。选择源数据库和相应的目标数据库。在我们的情况下，我们将`MOVIES`数据库（位于本地）映射到我们之前创建的`movies`数据库。*图4.41*显示了如何从源到目标进行映射：![在选择数据库窗格中映射数据库](img/B17160_04_41.jpg)
- en: 'Figure 4.41: Mapping databases'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.41：映射数据库
- en: We're approaching the last step, where we can configure the migration settings.
    At this stage, you can specify which tables need to be migrated and settings for
    `horror_tbl` table has been selected:![Configuring database migration settings](img/B17160_04_42.jpg)
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们正在接近最后一步，可以在那里配置迁移设置。在这个阶段，您可以指定需要迁移的表以及已选择`horror_tbl`表的设置：![配置数据库迁移设置](img/B17160_04_42.jpg)
- en: 'Figure 4.42: Configuring database migration settings'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.42：配置数据库迁移设置
- en: With that, we proceed to the Summary tab, where we need to add a name for this
    activity and review the configuration we have done so far. Clicking on Start Migration
    will initiate the migration from the on-premises server to the Azure server.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们继续到摘要选项卡，在那里我们需要为此活动添加一个名称并审查我们迄今为止所做的配置。点击开始迁移将启动从本地服务器到Azure服务器的迁移。
- en: Soon we will be redirected to a page with the migration status and details of
    the source and destination servers, as shown in *Figure 4.43*:![Checking the migration
    status and details of the source and destination servers](img/B17160_04_43.jpg)
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 很快我们将被重定向到一个页面，显示迁移状态和源服务器和目标服务器的详细信息，如*图4.43*所示：![检查迁移状态和源服务器和目标服务器的详细信息](img/B17160_04_43.jpg)
- en: 'Figure 4.43: Checking migration status'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.43：检查迁移状态
- en: Since our dataset was 10 rows, it took less than 5 seconds to complete the migration
    and notify us that we are ready to cut over. If you choose Start Cutover, Azure
    will provide the steps to commit any pending transactions, as shown in *Figure
    4.44*, and after that you are ready to point your applications to this database:![Starting
    cutover by clicking on Start Cutover](img/B17160_04_44.jpg)
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们的数据集有10行，完成迁移并通知我们准备切换的时间不到5秒。如果选择开始切换，Azure将提供提交任何未决事务的步骤，如*图4.44*所示，之后您就可以将应用程序指向这个数据库：![点击开始切换开始切换](img/B17160_04_44.jpg)
- en: 'Figure 4.44: Starting cutover'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.44：开始切换
- en: 'Even without initiating the cutover, you can check the Azure MySQL instance
    and verify that our records are there. The following shows verification done with
    Bash by connecting to the instance:'
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 即使没有启动切换，您也可以检查Azure MySQL实例并验证我们的记录是否存在。以下是使用Bash连接到实例进行的验证：
- en: '![Verifying data in Azure MySQL Database after migration](img/B17160_04_45.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![在迁移后验证Azure MySQL数据库中的数据](img/B17160_04_45.jpg)'
- en: 'Figure 4.45: Verifying data in the Azure Database for MySQL server after migration'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 图4.45：在迁移后验证Azure Database for MySQL服务器中的数据
- en: From *Figure 4.45*, it's evident that we are indeed connecting to the Azure
    MySQL instance.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 从*图4.45*可以明显看出，我们确实连接到了Azure MySQL实例。
- en: 'Though we performed the migration from Hyper-V for demonstration, Azure Migrate
    supports other platforms and DMS supports other database types as well. *Table
    4.1* shows links to the official Microsoft content for other platforms including
    Hyper-V:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们进行了来自Hyper-V的迁移以进行演示，但Azure迁移支持其他平台，DMS也支持其他数据库类型。*表4.1*显示了包括Hyper-V在内的其他平台的官方Microsoft内容的链接：
- en: '| **Platform** | **Link** |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| **平台** | **链接** |'
- en: '| --- | --- |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| **VMware** | [https://docs.microsoft.com/azure/migrate/server-migrate-overview](https://docs.microsoft.com/azure/migrate/server-migrate-overview)
    |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| **VMware** | [https://docs.microsoft.com/azure/migrate/server-migrate-overview](https://docs.microsoft.com/azure/migrate/server-migrate-overview)
    |'
- en: '| **Physical servers** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-physical-virtual-machines](https://docs.microsoft.com/azure/migrate/tutorial-migrate-physical-virtual-machines)
    |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: 物理服务器 | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-physical-virtual-machines](https://docs.microsoft.com/azure/migrate/tutorial-migrate-physical-virtual-machines)
- en: '| **AWS instances** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-aws-virtual-machines](https://docs.microsoft.com/azure/migrate/tutorial-migrate-aws-virtual-machines)
    |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| **AWS实例** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-aws-virtual-machines](https://docs.microsoft.com/azure/migrate/tutorial-migrate-aws-virtual-machines)'
- en: '| **GCP instances** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-gcp-virtual-machines](https://docs.microsoft.com/azure/migrate/tutorial-migrate-gcp-virtual-machines)
    |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| **GCP实例** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-gcp-virtual-machines](https://docs.microsoft.com/azure/migrate/tutorial-migrate-gcp-virtual-machines)'
- en: '| **Hyper-V** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-hyper-v](https://docs.microsoft.com/azure/migrate/tutorial-migrate-hyper-v)
    |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| **Hyper-V** | [https://docs.microsoft.com/azure/migrate/tutorial-migrate-hyper-v](https://docs.microsoft.com/azure/migrate/tutorial-migrate-hyper-v)
    |'
- en: '| **Database Migration** | [https://datamigration.microsoft.com/](https://datamigration.microsoft.com/)
    |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| **数据库迁移** | [https://datamigration.microsoft.com/](https://datamigration.microsoft.com/)
    |'
- en: 'Table 4.1: Migration documentation for other platforms'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 表4.1：其他平台的迁移文档
- en: With that, we have reached the end of the hands-on lab. To conclude, this hands-on
    was divided into sections where you were migrating servers using Azure Migrate
    and migrating databases using DMS.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 到此，我们已经完成了实践实验。总之，这个实践实验分为几个部分，您将使用Azure迁移迁移服务器，并使用DMS迁移数据库。
- en: Summary
  id: totrans-190
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: This chapter focused on practical learning via hands-on labs. First, we went
    through how to install providers in VMs, then we ran discovery and replication
    procedures. The first hands-on lab concluded with the migration of a VM to Azure
    using Azure Migrate.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 本章重点是通过实践实验进行实际学习。首先，我们学习了如何在虚拟机中安装提供程序，然后运行了发现和复制过程。第一个实践实验以使用Azure迁移将虚拟机迁移到Azure为结论。
- en: Our second hands-on lab focused on MySQL database migration to the Azure Database
    for MySQL service using DMS. In this lab, we first created the migration service
    and configured it with our target resources. Then we migrated a sample schema.
    Finally, we created a migration project and migrated the database to Azure.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二个实践实验重点是使用DMS将MySQL数据库迁移到Azure数据库的MySQL服务。在这个实验中，我们首先创建了迁移服务，并将其配置为目标资源。然后我们迁移了一个示例架构。最后，我们创建了一个迁移项目，并将数据库迁移到Azure。
- en: Migrating operating systems and databases to Azure is just one step on our cloud
    journey. Naturally, the next step is to operate the migrated Linux workloads on
    Azure. *Chapter 5*, *Operating Linux on Azure*, will give you some practical guidance
    on this topic.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 将操作系统和数据库迁移到Azure只是我们云旅程的一步。自然而然的，下一步是在Azure上操作迁移的Linux工作负载。*第5章*，*在Azure上操作Linux*，将为您提供有关此主题的一些实际指导。
