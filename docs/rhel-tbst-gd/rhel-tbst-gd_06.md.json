["```\n[db]# ip route show\ndefault via 10.0.2.2 dev enp0s3  proto static  metric 1024\n10.0.2.0/24 dev enp0s3  proto kernel  scope link  src 10.0.2.15\n169.254.0.0/16 dev enp0s8  scope link  metric 1003\n192.168.33.0/24 dev enp0s8  proto kernel  scope link  src 192.168.33.12\n\n```", "```\n[blog]$ ping db.example.com\nPING db.example.com (192.168.33.12) 56(84) bytes of data.\n64 bytes from db.example.com (192.168.33.12): icmp_seq=1 ttl=64 time=0.420 ms\n64 bytes from db.example.com (192.168.33.12): icmp_seq=2 ttl=64 time=0.564 ms\n64 bytes from db.example.com (192.168.33.12): icmp_seq=3 ttl=64 time=0.562 ms\n64 bytes from db.example.com (192.168.33.12): icmp_seq=4 ttl=64 time=0.479 ms\n^C\n--- db.example.com ping statistics ---\n4 packets transmitted, 4 received, 0% packet loss, time 3006ms\nrtt min/avg/max/mdev = 0.420/0.506/0.564/0.062 ms\n\n```", "```\n[blog]$ telnet db.example.com 3306\nTrying 192.168.33.12...\ntelnet: connect to address 192.168.33.12: No route to host\n\n```", "```\n[db]$ ps -elf | grep maria\n0 S mysql     1529  1123  0  80   0 - 226863 poll_s 12:21 ? 00:00:04 /usr/libexec/mysqld --basedir=/usr --datadir=/var/lib/mysql --plugin-dir=/usr/lib64/mysql/plugin --log-error=/var/log/mariadb/mariadb.log --pid-file=/var/run/mariadb/mariadb.pid --socket=/var/lib/mysql/mysql.sock\n\n```", "```\n[db]$ netstat -na | grep LISTEN\ntcp      0     0 127.0.0.1:25          0.0.0.0:*             LISTEN\ntcp      0     0 0.0.0.0:46788         0.0.0.0:*             LISTEN\ntcp      0     0 0.0.0.0:3306          0.0.0.0:*             LISTEN\ntcp      0     0 0.0.0.0:111           0.0.0.0:*             LISTEN\ntcp      0     0 0.0.0.0:22            0.0.0.0:*             LISTEN\ntcp6     0     0 ::1:25                     :::*             LISTEN\ntcp6     0     0 :::111                     :::*             LISTEN\ntcp6     0     0 :::22                      :::*             LISTEN\ntcp6     0     0 :::49464                   :::*             LISTEN\n\n```", "```\n[blog]$ curl -v telnet://localhost:3306\n* About to connect() to localhost port 3306 (#0)\n*   Trying 127.0.0.1...\n* Connected to localhost (127.0.0.1) port 3306 (#0)\nR\n* RCVD IAC EC\n\n```", "```\n[laptop]$ telnet 192.168.33.12 3306\nTrying 192.168.33.12...\ntelnet: connect to address 192.168.33.12: Connection refused\ntelnet: Unable to connect to remote host\n\n```", "```\n[laptop]$ telnet 192.168.33.12 22\nTrying 192.168.33.12...\nConnected to 192.168.33.12.\nEscape character is '^]'.\nSSH-2.0-OpenSSH_6.4\n^]\ntelnet>\n\n```", "```\n[blog]$ telnet db.example.com 22\nTrying 192.168.33.12...\nConnected to db.example.com.\nEscape character is '^]'.\nSSH-2.0-OpenSSH_6.4\n^]\n\n```", "```\n[db]# tcpdump -nnnvvv -i any port 22\ntcpdump: listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes\n\n```", "```\n03:03:15.670771 IP (tos 0x10, ttl 64, id 17278, offset 0, flags [DF], proto TCP (6), length 60)\n 192.168.33.11.34133 > 192.168.33.12.22: Flags [S], cksum 0x977b (correct), seq 2193487479, win 14600, options [mss 1460,sackOK,TS val 7058697 ecr 0,nop,wscale 6], length 0\n03:03:15.670847 IP (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 60)\n 192.168.33.12.22 > 192.168.33.11.34133: Flags [S.], cksum 0xc396 (correct), seq 3659372781, ack 2193487480, win 14480, options [mss 1460,sackOK,TS val 7018839 ecr 7058697,nop,wscale 6], length 0\n03:03:15.671295 IP (tos 0x10, ttl 64, id 17279, offset 0, flags [DF], proto TCP (6), length 52)\n 192.168.33.11.34133 > 192.168.33.12.22: Flags [.], cksum 0x718b (correct), seq 1, ack 1, win 229, options [nop,nop,TS val 7058697 ecr 7018839], length 0\n\n```", "```\n192.168.33.11.34133 > 192.168.33.12.22: Flags [S], cksum 0x977b (correct), seq 2193487479, win 14600, options [mss 1460,sackOK,TS val 7058697 ecr 0,nop,wscale 6], length 0\n\n```", "```\n 192.168.33.12.22 > 192.168.33.11.34133: Flags [S.], cksum 0x0b15 (correct), seq 3659372781, ack 2193487480, win 14480, options [mss 1460,sackOK,TS val 7018839 ecr 7058697,nop,wscale 6], length 0\n\n```", "```\n 192.168.33.11.34133 > 192.168.33.12.22: Flags [.], cksum 0x718b (correct), seq 1, ack 1, win 229, options [nop,nop,TS val 7058697 ecr 7018839], length 0\n\n```", "```\n[db]# tcpdump -nnnvvv -i any port 3306\ntcpdump: listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes\n\n```", "```\n[blog]$ telnet db.example.com 3306\nTrying 192.168.33.12...\ntelnet: connect to address 192.168.33.12: No route to host\n\n```", "```\n06:04:25.488396 IP (tos 0x10, ttl 64, id 44350, offset 0, flags [DF], proto TCP (6), length 60)\n 192.168.33.11.55002 > 192.168.33.12.3306: Flags [S], cksum 0x7699 (correct), seq 3266396266, win 14600, options [mss 1460,sackOK,TS val 12774740 ecr 0,nop,wscale 6], length 0\n\n```", "```\n[db]# tcpdump -nnnvvv -i any host 192.168.33.11\ntcpdump: listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes\n\n```", "```\n[blog]$ telnet db.example.com 3306\nTrying 192.168.33.12...\ntelnet: connect to address 192.168.33.12: No route to host\n\n```", "```\n06:16:49.729134 IP (tos 0x10, ttl 64, id 23760, offset 0, flags [DF], proto TCP (6), length 60)\n 192.168.33.11.55003 > 192.168.33.12.3306: Flags [S], cksum 0x9be6 (correct), seq 1849431125, win 14600, options [mss 1460,sackOK,TS val 13518981 ecr 0,nop,wscale 6], length 0\n06:16:49.729199 IP (tos 0xd0, ttl 64, id 40207, offset 0, flags [none], proto ICMP (1), length 88)\n 192.168.33.12 > 192.168.33.11: ICMP host 192.168.33.12 unreachable - admin prohibited, length 68\n\n```", "```\n06:16:49.729134 IP (tos 0x10, ttl 64, id 23760, offset 0, flags [DF], proto TCP (6), length 60)\n 192.168.33.11.55003 > 192.168.33.12.3306: Flags [S], cksum 0x9be6 (correct), seq 1849431125, win 14600, options [mss 1460,sackOK,TS val 13518981 ecr 0,nop,wscale 6], length 0\n\n```", "```\n06:16:49.729199 IP (tos 0xd0, ttl 64, id 40207, offset 0, flags [none], proto ICMP (1), length 88)\n 192.168.33.12 > 192.168.33.11: ICMP host 192.168.33.12 unreachable - admin prohibited, length 68\n\n```", "```\nproto ICMP (1), length 88)\n 192.168.33.12 > 192.168.33.11: ICMP host 192.168.33.12 unreachable - admin prohibited, length 68\n\n```", "```\n[blog]# tcpdump -vvvnnn -i any port 5000\ntcpdump: listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes\n\n```", "```\n[laptop]$ telnet 192.168.33.11 5000\nTrying 192.168.33.11...\ntelnet: connect to address 192.168.33.11: Connection refused\ntelnet: Unable to connect to remote host\n\n```", "```\ntelnet: connect to address 192.168.33.12: No route to host\n\n```", "```\n06:57:42.954091 IP (tos 0x10, ttl 64, id 47368, offset 0, flags [DF], proto TCP (6), length 64)\n 192.168.33.1.53198 > 192.168.33.11.5000: Flags [S], cksum 0xca34 (correct), seq 1134882056, win 65535, options [mss 1460,nop,wscale 5,nop,nop,TS val 511014642 ecr 0,sackOK,eol], length 0\n06:57:42.954121 IP (tos 0x10, ttl 64, id 0, offset 0, flags [DF], proto TCP (6), length 40)\n 192.168.33.11.5000 > 192.168.33.1.53198: Flags [R.], cksum 0xd86e (correct), seq 0, ack 1134882057, win 0, length 0\n\n```", "```\n192.168.33.11.5000 > 192.168.33.1.53198: Flags [R.],\n\n```", "```\n[db]# ps -elf | grep iptables\n0 R root      4189  3220  0  80   0 - 28160 -      16:31 pts/0 00:00:00 grep --color=auto iptables\n\n```", "```\n[db]# service iptables status\nRedirecting to /bin/systemctl status  iptables.service\niptables.service - IPv4 firewall with iptables\n Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled)\n Active: active (exited) since Wed 2015-04-01 16:36:16 UTC; 4min 56s ago\n Process: 4202 ExecStop=/usr/libexec/iptables/iptables.init stop (code=exited, status=0/SUCCESS)\n Process: 4332 ExecStart=/usr/libexec/iptables/iptables.init start (code=exited, status=0/SUCCESS)\n Main PID: 4332 (code=exited, status=0/SUCCESS)\n\nApr 01 16:36:16 db.example.com systemd[1]: Starting IPv4 firewall with iptables...\nApr 01 16:36:16 db.example.com iptables.init[4332]: iptables: Applying firewall rules: [  OK  ]\nApr 01 16:36:16 db.example.com systemd[1]: Started IPv4 firewall with iptables.\n\n```", "```\n[db]# systemctl status iptables.service\niptables.service - IPv4 firewall with iptables\n Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled)\n Active: active (exited) since Wed 2015-04-01 16:36:16 UTC; 26min ago\n Process: 4202 ExecStop=/usr/libexec/iptables/iptables.init stop (code=exited, status=0/SUCCESS)\n Process: 4332 ExecStart=/usr/libexec/iptables/iptables.init start (code=exited, status=0/SUCCESS)\n Main PID: 4332 (code=exited, status=0/SUCCESS)\n\nApr 01 16:36:16 db.example.com systemd[1]: Starting IPv4 firewall with iptables...\nApr 01 16:36:16 db.example.com iptables.init[4332]: iptables: Applying firewall rules: [  OK  ]\nApr 01 16:36:16 db.example.com systemd[1]: Started IPv4 firewall with iptables.\n\n```", "```\n Active: active (exited) since Wed 2015-04-01 16:36:16 UTC; 26min ago\n\n```", "```\n[db]# systemctl status iptables.service\niptables.service - IPv4 firewall with iptables\n Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled)\n Active: inactive (dead) since Thu 2015-04-02 02:55:26 UTC; 1s ago\n Process: 4489 ExecStop=/usr/libexec/iptables/iptables.init stop (code=exited, status=0/SUCCESS)\n Process: 4332 ExecStart=/usr/libexec/iptables/iptables.init start (code=exited, status=0/SUCCESS)\n Main PID: 4332 (code=exited, status=0/SUCCESS)\n\nApr 01 16:36:16 db.example.com systemd[1]: Starting IPv4 firewall with iptables...\nApr 01 16:36:16 db.example.com iptables.init[4332]: iptables: Applying firewall rules: [  OK  ]\nApr 01 16:36:16 db.example.com systemd[1]: Started IPv4 firewall with iptables.\nApr 02 02:55:26 db.example.com systemd[1]: Stopping IPv4 firewall with iptables...\nApr 02 02:55:26 db.example.com iptables.init[4489]: iptables: Setting chains to policy ACCEPT: nat filter [  OK  ]\nApr 02 02:55:26 db.example.com iptables.init[4489]: iptables: Flushing firewall rules: [  OK  ]\nApr 02 02:55:26 db.example.com iptables.init[4489]: iptables: Unloading modules: [  OK  ]\nApr 02 02:55:26 db.example.com systemd[1]: Stopped IPv4 firewall with iptables.\n\n```", "```\n Active: inactive (dead) since Thu 2015-04-02 02:55:26 UTC; 1s ago\n\n```", "```\nApr 02 02:55:26 db.example.com systemd[1]: Stopping IPv4 firewall with iptables...\nApr 02 02:55:26 db.example.com iptables.init[4489]: iptables: Setting chains to policy ACCEPT: nat filter [  OK  ]\nApr 02 02:55:26 db.example.com iptables.init[4489]: iptables: Flushing firewall rules: [  OK  ]\nApr 02 02:55:26 db.example.com iptables.init[4489]: iptables: Unloading modules: [  OK  ]\nApr 02 02:55:26 db.example.com systemd[1]: Stopped IPv4 firewall with iptables.\n\n```", "```\n[db]# iptables -L -n\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination\nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED\nACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0\nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:22\nREJECT     all  --  0.0.0.0/0            0.0.0.0/0            reject- with icmp-host-prohibited\nACCEPT     tcp  --  192.168.0.0/16       0.0.0.0/0            state NEW tcp dpt:3306\n\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination\nREJECT     all  --  0.0.0.0/0            0.0.0.0/0            reject- with icmp-host-prohibited\n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination\n\n```", "```\n[db]# iptables -L -nv\n\n```", "```\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination\nREJECT     all  --  0.0.0.0/0            0.0.0.0/0            reject- with icmp-host-prohibited\n\n```", "```\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination\nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED\nACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0\nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:22\nREJECT     all  --  0.0.0.0/0            0.0.0.0/0            reject- with icmp-host-prohibited\nACCEPT     tcp  --  192.168.0.0/16       0.0.0.0/0            state NEW tcp dpt:3306\n\n```", "```\nACCEPT     tcp  --  192.168.0.0/16       0.0.0.0/0            state NEW tcp dpt:3306\n\n```", "```\nREJECT     all  --  0.0.0.0/0            0.0.0.0/0            reject- with icmp-host-prohibited\n\n```", "```\nChain INPUT (policy ACCEPT)\n\n```", "```\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            state NEW tcp dpt:22\n\n```", "```\nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0\n\n```", "```\n[db]# iptables -L -nv\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source destination\n 36  2016 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n 0     0 ACCEPT     icmp --  *      *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     all  --  lo     *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0 0.0.0.0/0            state NEW tcp dpt:22\n 394 52363 REJECT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            reject-with icmp-host-prohibited\n 0     0 ACCEPT     tcp  --  *      *       192.168.0.0/16 0.0.0.0/0            state NEW tcp dpt:3306\n\n```", "```\n 0     0 ACCEPT     all  --  lo     *       0.0.0.0/0 0.0.0.0/0\n\n```", "```\n 0     0 ACCEPT     icmp --  *      *       0.0.0.0/0 0.0.0.0/0\n\n```", "```\n 36  2016 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n\n```", "```\n 0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0 0.0.0.0/0            state NEW tcp dpt:22\n\n```", "```\n 36  2016 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n\n```", "```\n 394 52363 REJECT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            reject-with icmp-host-prohibited\n 0     0 ACCEPT     tcp  --  *      *       192.168.0.0/16 0.0.0.0/0            state NEW tcp dpt:3306\n\n```", "```\n 36  2016 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n\n```", "```\n[db]# iptables -L -nv\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source destination\n 41  2360 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n\n```", "```\n[db]# iptables \u2013Z\n\n```", "```\n[db]# iptables -L -nv\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source destination\n 7   388 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n 0     0 ACCEPT     icmp --  *      *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     all  --  lo     *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0 0.0.0.0/0            state NEW tcp dpt:22\n 0     0 REJECT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            reject-with icmp-host-prohibited\n 0     0 ACCEPT     tcp  --  *      *       192.168.0.0/16 0.0.0.0/0            state NEW tcp dpt:3306\n\n```", "```\n[db]# iptables -L -nv\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source destination\n 53  3056 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n 0     0 ACCEPT     icmp --  *      *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     all  --  lo     *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0 0.0.0.0/0            state NEW tcp dpt:22\n 45  4467 REJECT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            reject-with icmp-host-prohibited\n 0     0 ACCEPT     tcp  --  *      *       192.168.0.0/16 0.0.0.0/0            state NEW tcp dpt:3306\n\n```", "```\n[db]# vi /etc/sysconfig/iptables\n# Generated by iptables-save v1.4.21 on Mon Mar 30 02:27:35 2015\n*nat\n:PREROUTING ACCEPT [10:994]\n:INPUT ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n:POSTROUTING ACCEPT [0:0]\nCOMMIT\n# Completed on Mon Mar 30 02:27:35 2015\n# Generated by iptables-save v1.4.21 on Mon Mar 30 02:27:35 2015\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [140:11432]\n-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n-A INPUT -p icmp -j ACCEPT\n-A INPUT -i lo -j ACCEPT\n-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A INPUT -p tcp -m state --state NEW -m tcp --src 192.168.0.0/16 -- dport 3306 -j ACCEPT\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n# Completed on Mon Mar 30 02:27:35 2015\n\n```", "```\niptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT\n\n```", "```\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A INPUT -p tcp -m state --state NEW -m tcp --src 192.168.0.0/16 -- dport 3306 -j ACCEPT\n\n```", "```\n-A INPUT -p tcp -m state --state NEW -m tcp --src 192.168.0.0/16 -- dport 3306 -j ACCEPT\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n\n```", "```\n[db]# screen\n\n```", "```\n[db]# systemctl restart iptables; echo \"still here?\"; sleep 120; systemctl stop iptables\n\n```", "```\n[db]# systemctl restart iptables.service; echo \"still here?\"; sleep 120; systemctl stop iptables.service\nstill here?\n\n```", "```\n# systemctl restart iptables.service\n# iptables -L -nv\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source destination\n 15   852 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n 0     0 ACCEPT     icmp --  *      *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     all  --  lo     *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0 0.0.0.0/0            state NEW tcp dpt:22\n 0     0 ACCEPT     tcp  --  *      *       192.168.0.0/16 0.0.0.0/0            state NEW tcp dpt:3306\n 0     0 REJECT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            reject-with icmp-host-prohibited\n\n```", "```\n# iptables -L -nv\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source destination\n 119 19352 ACCEPT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            state RELATED,ESTABLISHED\n 0     0 ACCEPT     icmp --  *      *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     all  --  lo     *       0.0.0.0/0 0.0.0.0/0\n 0     0 ACCEPT     tcp  --  *      *       0.0.0.0/0 0.0.0.0/0            state NEW tcp dpt:22\n 2   120 ACCEPT     tcp  --  *      *       192.168.0.0/16 0.0.0.0/0            state NEW tcp dpt:3306\n 39  4254 REJECT     all  --  *      *       0.0.0.0/0 0.0.0.0/0            reject-with icmp-host-prohibited\n\n```"]